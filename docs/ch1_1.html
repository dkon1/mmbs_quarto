<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.38">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Mathematical Methods for Biology, Part 1 - 1&nbsp; One variable in discrete time</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./ch1_2.html" rel="next">
<link href="./index.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">One variable in discrete time</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Mathematical Methods for Biology, Part 1</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch1_1.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">One variable in discrete time</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch1_2.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Plotting in Python</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#building-dynamic-models" id="toc-building-dynamic-models" class="nav-link active" data-scroll-target="#building-dynamic-models"> <span class="header-section-number">1.1</span> Building dynamic models</a>
  <ul class="collapse">
  <li><a href="#static-population" id="toc-static-population" class="nav-link" data-scroll-target="#static-population"> <span class="header-section-number">1.1.1</span> static population</a></li>
  <li><a href="#exponential-population-growth" id="toc-exponential-population-growth" class="nav-link" data-scroll-target="#exponential-population-growth"> <span class="header-section-number">1.1.2</span> exponential population growth</a></li>
  <li><a href="#example-with-birth-and-death" id="toc-example-with-birth-and-death" class="nav-link" data-scroll-target="#example-with-birth-and-death"> <span class="header-section-number">1.1.3</span> example with birth and death</a></li>
  <li><a href="#dimensions-of-birth-and-death-rates" id="toc-dimensions-of-birth-and-death-rates" class="nav-link" data-scroll-target="#dimensions-of-birth-and-death-rates"> <span class="header-section-number">1.1.4</span> dimensions of birth and death rates</a></li>
  <li><a href="#general-demographic-model" id="toc-general-demographic-model" class="nav-link" data-scroll-target="#general-demographic-model"> <span class="header-section-number">1.1.5</span> general demographic model</a></li>
  </ul></li>
  <li><a href="#solutions-of-linear-difference-models" id="toc-solutions-of-linear-difference-models" class="nav-link" data-scroll-target="#solutions-of-linear-difference-models"> <span class="header-section-number">1.2</span> Solutions of linear difference models</a>
  <ul class="collapse">
  <li><a href="#linear-difference-models-with-a-constant-term" id="toc-linear-difference-models-with-a-constant-term" class="nav-link" data-scroll-target="#linear-difference-models-with-a-constant-term"> <span class="header-section-number">1.2.1</span> linear difference models with a constant term</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">One variable in discrete time</span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<p>All living things change over time, and this evolution can be quantitatively measured and analyzed. Mathematics makes use of equations to define models that change with time, known as <em>dynamical systems</em>. In this unit we will learn how to construct models that describe the time-dependent behavior of some measurable quantity in life sciences. Numerous fields of biology use such models, and in particular we will consider changes in population size, the progress of biochemical reactions, the spread of infectious disease, and the spikes of membrane potentials in neurons, as some of the main examples of biological dynamical systems.</p>
<p>Many processes in living things happen regularly, repeating with a fairly constant time period. One common example is the reproductive cycle in species that reproduce periodically, whether once a year, or once an hour, like certain bacteria that divide at a relatively constant rate under favorable conditions. Other periodic phenomena include circadian (daily) cycles in physiology, contractions of the heart muscle, and waves of neural activity. For these processes, theoretical biologists use models with <em>discrete time</em>, in which the time variable is restricted to the integers. For instance, it is natural to count the generations in whole numbers when modeling population growth.</p>
<p>This chapter is devoted to analyzing dynamical systems in which time is measured in discrete steps. We will build dynamic models, find their mathematical solutions, and then use Python to compute the solutions and plot them. In this chapter you will learn to:</p>
<ul>
<li>build discrete-time models of populations using rate paramaters</li>
<li>define and verify mathematical solutions of these models</li>
<li>use Python to compute and plot solutions</li>
</ul>
<section id="building-dynamic-models" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="building-dynamic-models"><span class="header-section-number">1.1</span> Building dynamic models</h2>
<p>Let us construct our first models of biological systems! We will start by considering a population of some species, with the goal of tracking its growth or decay over time. The variable of interest is the number of individuals in the population, which we will call <span class="math inline">\(N\)</span>. This is called the dependent variable, since its value changes depending on time; it would make no sense to say that time changes depending on the population size. Throughout the study of dynamical systems, we will denote the independent variable of time by <span class="math inline">\(t\)</span>. To denote the population size at time <span class="math inline">\(t\)</span>, we can write <span class="math inline">\(N(t)\)</span> but sometimes use <span class="math inline">\(N_t\)</span>.</p>
<section id="static-population" class="level3" data-number="1.1.1">
<h3 data-number="1.1.1" class="anchored" data-anchor-id="static-population"><span class="header-section-number">1.1.1</span> static population</h3>
<p>In order to describe the dynamics, we need to write down a rule for how the population changes. Consider the simplest case, in which the population stays the same for all time. (Maybe it is a pile of rocks?) Then the following equation describes this situation:</p>
<p><span class="math display">\[
N(t+1) = N(t)
\]</span></p>
<p>This equation mandates that the population at the next time step be the same as at the present time <span class="math inline">\(t\)</span>. This type of equation is generally called a <em>difference equation</em>, because it can be written as a difference between the values at the two different times:</p>
<p><span class="math display">\[
N(t+1) - N(t) = 0
\]</span></p>
<p>This version of the model illustrates that a difference equation at its core describes the <em>increments</em> of <span class="math inline">\(N\)</span> from one time step to the next. In this case, the increments are always 0, which makes it plain that the population does not change from one time step to the next.</p>
</section>
<section id="exponential-population-growth" class="level3" data-number="1.1.2">
<h3 data-number="1.1.2" class="anchored" data-anchor-id="exponential-population-growth"><span class="header-section-number">1.1.2</span> exponential population growth</h3>
<p>Let us consider a more interesting situation: as a colony of dividing bacteria. such as <em>E. coli</em>, shown in {numref}<code>fig-cell-div</code>. We assume that each bacterial cell divides and produces two daughter cells at fixed intervals of time, and let us further suppose that bacteria never die. Essentially, we are assuming a population of immortal bacteria with clocks. This means that after each cell division the population size doubles. As before, we denote the number of cells in each generation by <span class="math inline">\(N(t)\)</span>, and obtain the equation describing each successive generation:</p>
<p><span class="math display">\[
N(t+1) = 2N(t)
\]</span></p>
<p>It can also be written in the difference form, as above:</p>
<p><span class="math display">\[
N(t+1) - N(t) = N(t)
\]</span></p>
<p>The increment in population size is determined by the current population size, so the population in this model is forever growing. This type of behavior is termed <em>exponential growth</em> and we will see how to express the solution algebraically in the next section.</p>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="images/Ecoli_dividing.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Scanning electron micrograph of a dividing <em>Escherichia coli</em> bacteria (image by Evangeline Sowers, Janice Haney Carr (CDC) in public domain via Wikimedia Commons)</figcaption><p></p>
</figure>
</div>
</section>
<section id="example-with-birth-and-death" class="level3" data-number="1.1.3">
<h3 data-number="1.1.3" class="anchored" data-anchor-id="example-with-birth-and-death"><span class="header-section-number">1.1.3</span> example with birth and death</h3>
<p>Suppose that a type of fish lives to reproduce only once after a period of maturation, after which the adults die. In this simple scenario, half of the population is female, a female always lays 1000 eggs, and of those, 1% survive to maturity and reproduce. Let us set up the model for the population growth of this idealized fish population. The general idea, as before, is to relate the population size at the next time step <span class="math inline">\(N(t+1)\)</span> to the population at the present time <span class="math inline">\(N(t)\)</span>.</p>
<p>Let us tabulate both the increases and the decreases in the population size. We have <span class="math inline">\(N(t)\)</span> fish at the present time, but we know they all die after reproducing, so there is a decrease of <span class="math inline">\(N(t)\)</span> in the population. Since half of the population is female, the number of new offspring produced by <span class="math inline">\(N(t)\)</span> fish is <span class="math inline">\(500N(t)\)</span>. Of those, only 1% survive to maturity (the next time step), and the other 99% (<span class="math inline">\(495N(t)\)</span>) die. We can add all the terms together to obtain the following difference equation:</p>
<p><span class="math display">\[
N(t+1) = N(t) - N(t) + 500N(t) - 495 N(t)  = 5N(t)
\]</span></p>
<p>The number 500 in the expression is the <em>birth rate</em> of the population per individual, and the negative terms add up to the <em>death rate</em> of 496 per individual. We can re-write the equation in difference form:</p>
<p><span class="math display">\[
N(t+1) - N(t) = 4N(t)
\]</span></p>
<p>This expression again generates growth in the population, because the birth rate outweighs the death rate. <span class="citation" data-cites="allman_mathematical_2003">(<a href="references.html#ref-allman_mathematical_2003" role="doc-biblioref"><strong>allman_mathematical_2003?</strong></a>)</span></p>
</section>
<section id="dimensions-of-birth-and-death-rates" class="level3" data-number="1.1.4">
<h3 data-number="1.1.4" class="anchored" data-anchor-id="dimensions-of-birth-and-death-rates"><span class="header-section-number">1.1.4</span> dimensions of birth and death rates</h3>
<p>What distinguishes a mathematical model from a mathematical equation is that the quantities involved have a real-world meaning. Each quantity represents a measurement, and associated with each one are the <em>units</em> of measurement, which are familiar from science courses. In addition to units, each variable and parameter has a meaning, which is called the <em>dimension</em> of the quantity. For example, any measurement of length or distance has the same dimension, although the units may vary. The value of a quantity depends on the units of measurement, but its essential dimensionality does not. One can convert a measurement in meters to that in light-years or cubits, but one cannot convert a measurement in number of sheep to seconds - that conversion has no meaning.</p>
<p>Thus leads us to the fundamental rule of mathematical modeling: <strong>terms that are added or subtracted must have the same dimension</strong>. This gives mathematical modelers a useful tool called <em>dimensional analysis</em>, which involves replacing the quantities in an equation with their dimensions. This serves as a check that all dimensions match, as well as allowing to deduce the dimensions of any parameters for which the dimension was not specified.</p>
<p>In the case of population models, the birth and death rates measure the number of individuals that are born (or die) within a reproductive cycle for every individual at the present time. Their dimensions must be such that the terms in the equation all match:</p>
<p><span class="math display">\[
[N(t+1) - N(t)] = [population] = [r] [N(t)] = [r] *[population]
\]</span></p>
<p>This implies that <span class="math inline">\([r]\)</span> is algebraically dimensionless. However, the meaning of <span class="math inline">\(r\)</span> is the rate of change of population over one (generation) time step. <span class="math inline">\(r\)</span> is the birth or death rate of the population <em>per generation</em>, which is what makes is dimensionless. If the length of the generation were to change, but the reproduction and death per generation remain the same, then the paramter <span class="math inline">\(r\)</span> would be the same, because it had been <em>rescaled</em> by the length of the generation. If they were to be reported in <em>absolute</em> units (e.g.&nbsp;individuals per year) then the rate would be different.</p>
</section>
<section id="general-demographic-model" class="level3" data-number="1.1.5">
<h3 data-number="1.1.5" class="anchored" data-anchor-id="general-demographic-model"><span class="header-section-number">1.1.5</span> general demographic model</h3>
<p>We will now write a general difference equation for any population with constant birth and death rates. This will allow us to substitute arbitrary values of the birth and death rates to model different biological situations. Suppose that a population has the birth rate of <span class="math inline">\(b\)</span> per individual, and the death rate <span class="math inline">\(d\)</span> per individual. Then the general model of the population size is:</p>
<p><span class="math display">\[
N(t+1) = (1 + b - d)N(t)
\]</span> (lin-pop)</p>
<p>The general equation also allows us to check the dimensions of birth and death rates, especially as written in the incremental form: <span class="math inline">\(N(t+1) - N(t) = (b - d)N(t)\)</span>. The change in population rate over one reproductive cycle is given by the current population size multiplied by the difference of birth and death rates, which as we saw are algebraically dimensionless. The right hand side of the equation has the dimensions of population size, matching the difference on the left hand side. <span class="citation" data-cites="edelstein-keshet_mathematical_2005">(<a href="references.html#ref-edelstein-keshet_mathematical_2005" role="doc-biblioref"><strong>edelstein-keshet_mathematical_2005?</strong></a>)</span></p>
</section>
</section>
<section id="solutions-of-linear-difference-models" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="solutions-of-linear-difference-models"><span class="header-section-number">1.2</span> Solutions of linear difference models</h2>
<p>We saw in the last section that we can write down equations to describe, step by step, how a variable changes over time. Let us define what the terminology of these equations:</p>
<p>```{admonition} Definition An equation to describe a variable (e.g.&nbsp;N) that changes over discrete time steps described by the integer variable <span class="math inline">\(t\)</span> is called a <em>difference equation</em> or a <em>discrete-time dynamic model</em>. These equations can be written in two ways, either in <em>recurrent form</em>:</p>
<p><span class="math display">\[
N(t+1) = f(N(t))
\]</span> (recur-eq)</p>
<p>or in <em>increment form</em>:</p>
<p><span class="math display">\[
N(t+1) - N(t) = g(N(t))
\]</span> (recur-eq)</p>
<pre><code>
### simple linear difference models

Having set up the difference equation models, we would naturally like to solve them to find out how the dependent variable, such as population size, varies over time. A solution may be *analytic*, meaning that it can be written as a formula, or *numeric*, in which case it is generated by a computer in the form of a sequence of values of the dependent variable over a period of time. In this section, we will find some simple analytic solutions and learn to analyze the behavior of difference equations which we cannot solve exactly.

```{admonition} Definition
A function $N(t)$ is a *solution* of a difference equation $N(t+1) = f(N(t))$ if it satisfies that equation for all values of time $t$.</code></pre>
<p>For instance, let us take our first model of the static population, <span class="math inline">\(N(t+1) = N(t)\)</span>. Any constant function is a solution, for example, <span class="math inline">\(N(t) = 0\)</span>, or <span class="math inline">\(N(t) = 10\)</span>. There are actually as many solutions as there are numbers, that is, infinitely many! In order to specify exactly what happens in the model, we need to specify the size of the population at some point, usually, at the “beginning of time”, <span class="math inline">\(t = 0\)</span>. This is called the <em>initial condition</em> for the model, and for a well-behaved difference equation it is enough to determine a unique solution. For the static model, specifying the initial condition is the same as specifying the population size for all time.</p>
<p>Now let us look at the general model of population growth with constant birth and death rates. We saw in equation {eq}<code>lin-pop</code> above that these can be written in the form <span class="math inline">\(N(t+1) = (1 + b - d) N(t)\)</span>. To simplify, let us combine the numbers into one growth parameter <span class="math inline">\(r = 1 + b - d\)</span>, and write down the general equation for population growth with constant growth rate:</p>
<p><span class="math display">\[
N(t+1) =  rN(t)
\]</span> (lin-pop-r)</p>
<p>To find the solution, consider a specific example, where we start with the initial population size <span class="math inline">\(N_0 = 1\)</span>, and the growth rate <span class="math inline">\(r=2\)</span>. The sequence of population sizes is: 1, 2, 4, 8, 16, etc. This is described by the formula <span class="math inline">\(N(t) = 2^t\)</span>.</p>
<p>In the general case, each time step the solution is multiplied by <span class="math inline">\(r\)</span>, so the solution has the same exponential form. The initial condition <span class="math inline">\(N_0\)</span> is a multiplicative constant in the solution, and one can verify that when <span class="math inline">\(t=0\)</span>, the solution matches the initial value:</p>
<p><span class="math display">\[
N(t)  = r^t N_0
\]</span> (lin-pop-sol)</p>
<p>I would like the reader to pause and consider this remarkable formula. No matter what the birth and death parameters are selected, this solution predicts the population size at any point in time <span class="math inline">\(t\)</span>.</p>
<p>In order to verify that the formula for <span class="math inline">\(N(t)\)</span> is actually a solution in the meaning of definition, we need to check that it actually satisfies the difference equation for all <span class="math inline">\(t\)</span>, not just a few time steps. This can be done algebraically by plugging in <span class="math inline">\(N(t+1)\)</span> into the left side of the dynamic model and <span class="math inline">\(N(t)\)</span> into the right side and checking whether they match. For <span class="math inline">\(N(t)\)</span> given by equation {eq}<code>lin-pop-sol</code>, <span class="math inline">\(N(t+1) = r^{t+1} N_0\)</span>, and thus the dynamic model becomes:</p>
<p><span class="math display">\[
r^{t+1} N_0 = r \times r^t N_0
\]</span></p>
<p>Since the two sides match, this means the solution is correct.</p>
<p>The solutions in equation {eq}<code>lin-pop-sol</code> are exponential functions, which have a limited menu of behaviors, depending on the value of <span class="math inline">\(r\)</span>. If <span class="math inline">\(r &gt; 1\)</span>, multiplication by <span class="math inline">\(r\)</span> increases the size of the population, so the solution <span class="math inline">\(N(t)\)</span> will grow (see {numref}<code>fig-exp-growth</code>. If <span class="math inline">\(r &lt; 1\)</span>, multiplication by <span class="math inline">\(r\)</span> decreases the size of the population, so the solution <span class="math inline">\(N(t)\)</span> will decay (see {numref}<code>fig-exp-decay</code>). Finally, if <span class="math inline">\(r=1\)</span>, multiplication by <span class="math inline">\(r\)</span> leaves the population size unchanged, like in the pile of rocks model. Here is the complete classification of the behavior of population models with constant birth and death rates (assuming <span class="math inline">\(r&gt;0\)</span>):</p>
<p>```{admonition} Classification of solutions of linear dynamic models :class: tip</p>
<p>For a difference equation <span class="math inline">\(N(t+1) = rN(t)\)</span>, solutions can behave in one of three ways:</p>
<ul>
<li><p><span class="math inline">\(|r| &gt; 1\)</span>: <span class="math inline">\(N(t)\)</span> grows without bound</p></li>
<li><p><span class="math inline">\(|r| &lt; 1\)</span>: <span class="math inline">\(N(t)\)</span> decays to 0</p></li>
<li><p>$|r| = 1 $: the absolute value of <span class="math inline">\(N(t)\)</span> remains constant</p></li>
</ul>
<pre><code>
Se examples of graphs of solutions of such equations with $r$ greater than 1 in {numref}`fig-exp-growth` and solutions for $r$ less than 1 in {numref}`fig-exp-decay`.

```{figure} images/ch1_exp_growth.png
---
name: fig-exp-growth
---
Growth of a population that doubles every generation over 6 generations.</code></pre>
<table class="table">
<thead>
<tr class="header">
<th>```{figure} images/ch1_exp_decay.png</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>name: fig-exp-decay</td>
</tr>
</tbody>
</table>
<p>Decay of a population in which half the individuals die every time step over 6 generations ```</p>
<section id="linear-difference-models-with-a-constant-term" class="level3" data-number="1.2.1">
<h3 data-number="1.2.1" class="anchored" data-anchor-id="linear-difference-models-with-a-constant-term"><span class="header-section-number">1.2.1</span> linear difference models with a constant term</h3>
<p>Now let us consider a dynamic model that combines two different rates: a proportional rate (<span class="math inline">\(rN\)</span>) and a constant rate which does not depend on the value of the variable <span class="math inline">\(N\)</span>. We can write such a generic model as follows:</p>
<p><span class="math display">\[
N(t+1) =  rN(t) + a
\]</span></p>
<p>The right-hand-side of this equation is a linear function of <span class="math inline">\(N\)</span>, so this is a linear difference equation with a constant term. What function <span class="math inline">\(N(t)\)</span> satisfies it? One can quickly check that that the same solution <span class="math inline">\(N(t) = r^t N_0\)</span> does not work because of the pesky constant term <span class="math inline">\(a\)</span>:</p>
<p><span class="math display">\[
r^{t+1} N_0 \neq r \times r^t N_0 + a
\]</span></p>
<p>To solve it, we need to try a different form: specifically, an exponential with an added constant. The exponential can be reasonably surmised to have base <span class="math inline">\(r\)</span> as before, and then leave the two constants as unknown: <span class="math inline">\(N(t) = c_1 r^t + c_2\)</span>. To figure out whether this is a solution, plug it into the linear difference equation above and check whether a choice of constants can make the two sides agree:</p>
<p><span class="math display">\[
N(t+1) =  c_1 r^{t +1} + c_2 = rN(t) + a  = rc_1 r^t + rc_2+ a
\]</span></p>
<p>This equation has the same term <span class="math inline">\(c_1 r^{t +1}\)</span> on both sides, so they can be subtracted out. The remaining equation involves only <span class="math inline">\(c_2\)</span>, and its solution is <span class="math inline">\(c_2 = a/(1-r)\)</span>. Therefore, the general solution of this linear difference equation is the following expreis which is determined from the initial value by plugging <span class="math inline">\(t=0\)</span> and solving for <span class="math inline">\(c\)</span>.</p>
<p><span class="math display">\[
N(t) = c r^t  + \frac{a}{1-r}
\label{eq:ch14_sol_wconst}
\]</span></p>
<p><strong>Example.</strong> Take the difference equation <span class="math inline">\(N(t+1) = 0.5 N(t) + 40\)</span> with initial value <span class="math inline">\(N(0)= 100\)</span>. The solution, according to our formula is <span class="math inline">\(N(t) = c 0.5^t + 80\)</span>. At <span class="math inline">\(N(0) = 100 = c+80\)</span>, so <span class="math inline">\(c=20\)</span>. Then the compete solution is <span class="math inline">\(N(t) = 20*0.5^t + 80\)</span>. To check that this actually works, plug this solution back into the difference equation:</p>
<p><span class="math display">\[
N(t+1) = 20 \times 0.5^{t+1} + 80 = 0.5 \times (20 \times 0.5^t + 80) + 40 =  20 \times 0.5^{t+1} + 80
\]</span></p>
<p>The equation is satisfied and therefore the solution is correct.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./index.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Preface</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./ch1_2.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Plotting in Python</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>