<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.24">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>3&nbsp; Nonlinear discrete-time dynamic models – Mathematical Methods for Biology, Part 1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./ch4_cobweb_plots.html" rel="next">
<link href="./ch2_plotting_python.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dc55a5b9e770e841cd82e46aadbfb9b0.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-27c261d06b905028a18691de25d09dde.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ch3_discrete_chaos.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Nonlinear discrete-time dynamic models</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Mathematical Methods for Biology, Part 1</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch1_discrete1var.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">One variable in discrete time</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch2_plotting_python.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Plotting in Python</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch3_discrete_chaos.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Nonlinear discrete-time dynamic models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch4_cobweb_plots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Graphical analysis of difference equations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch5_discrete_higher.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Discrete models of higher order</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch6_matrix_mult.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Matrix multiplication and population models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch7_linear_reg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Linear regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch8_LinReg_python.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Linear regression in Python</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch9_1var_ode.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Models with one variable in continuous time</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch10_numeric_ode.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Numeric solutions of ODEs</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch11_graph_ode.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Graphical analysis of ordinary differential equations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch12_linear_pplane.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Linear ODEs with two variables</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch13_phase_portraits.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Phase portraits in Python</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch14_lin_oscillations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Forces and potentials in biological modeling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch15_fourier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Fourier series: decomposition by frequency</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch16_linearization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Linearization of ODEs</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch17_nonlinear_oscillations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Nonlinear oscillations in biology</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#logistic-population-model" id="toc-logistic-population-model" class="nav-link active" data-scroll-target="#logistic-population-model"><span class="header-section-number">3.1</span> Logistic population model</a></li>
  <li><a href="#qualitative-analysis-of-difference-equations" id="toc-qualitative-analysis-of-difference-equations" class="nav-link" data-scroll-target="#qualitative-analysis-of-difference-equations"><span class="header-section-number">3.2</span> Qualitative analysis of difference equations</a>
  <ul class="collapse">
  <li><a href="#fixed-points-or-equilibria" id="toc-fixed-points-or-equilibria" class="nav-link" data-scroll-target="#fixed-points-or-equilibria"><span class="header-section-number">3.2.1</span> fixed points or equilibria</a></li>
  <li><a href="#stability-criteria-for-fixed-points" id="toc-stability-criteria-for-fixed-points" class="nav-link" data-scroll-target="#stability-criteria-for-fixed-points"><span class="header-section-number">3.2.2</span> stability criteria for fixed points</a></li>
  </ul></li>
  <li><a href="#analysis-of-logistic-population-model" id="toc-analysis-of-logistic-population-model" class="nav-link" data-scroll-target="#analysis-of-logistic-population-model"><span class="header-section-number">3.3</span> Analysis of logistic population model</a>
  <ul class="collapse">
  <li><a href="#rescaling-the-logistic-model" id="toc-rescaling-the-logistic-model" class="nav-link" data-scroll-target="#rescaling-the-logistic-model"><span class="header-section-number">3.3.1</span> rescaling the logistic model</a></li>
  <li><a href="#fixed-point-analysis" id="toc-fixed-point-analysis" class="nav-link" data-scroll-target="#fixed-point-analysis"><span class="header-section-number">3.3.2</span> fixed point analysis</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Nonlinear discrete-time dynamic models</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In this chapter we will analyze nonlinear discrete dynamical systems. Their solutions, as those of nonlinear ODEs, exhibit much more interesting behaviors than the exponential solutions of linear equations, and are typically not solvable analytically. There may be multiple fixed points, some stable and others unstable, and even crazier behaviors are possible that are not permitted in smooth-flowing ODEs. Specifically, we will see solutions that oscillate, and those that behave without any pattern at all, that are called chaotic. You will learn to do the following in this chapter:</p>
<ul>
<li><p>build the logistic population model</p></li>
<li><p>find equilibrium values of nonlinear discrete-time models</p></li>
<li><p>analyze the stability of equilibria based on the graph of the updating function</p></li>
<li><p>write down stability conditions analytically</p></li>
<li><p>use Python to make cobweb plots</p></li>
<li><p>understand the term chaos</p></li>
</ul>
<section id="logistic-population-model" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="logistic-population-model"><span class="header-section-number">3.1</span> Logistic population model</h2>
<p>Linear population growth models assume that the per capita birth and death rates are constant, that is, they stay the same regardless of population size. The solutions for these models either grow or decay exponentially, but in reality, populations cannot grow without bounds. It is generally true that the larger a population grows, the more scarce the resources, and survival becomes more difficult. For larger populations, this could lead to higher death rates, or lower birth rates, or both.</p>
<p>To incorporate this effect into a quantitative model we will assume there are separate birth and death rates, and that the birth rate declines as the population grows, while the death rate increases:</p>
<p><span class="math display">\[
b =  b_1 - b_2 N(t) ; \;   d = d_1 + d_2 N(t)
\]</span></p>
<p>To model the rate of change of the population, we need to multiply the rates <span class="math inline">\(b\)</span> and <span class="math inline">\(d\)</span> by the population size <span class="math inline">\(N\)</span>, since each individual can reproduce or die. Also, since the death rate <span class="math inline">\(d\)</span> decreases the population, we need to put a negative sign on it. The resulting model is:</p>
<p><span class="math display">\[
N(t+1) - N(t) = (b -d)N(t) = [(b_1 - d_1) - (b_2 + d_2)N(t)] N(t)
\]</span></p>
<p>A simpler way of writing this equation is to let <span class="math inline">\(r = 1 + b_1 - d_1\)</span> and <span class="math inline">\(K = b_2 + d_2\)</span>, leading to the following iterated map:</p>
<p><span class="math display">\[
N(t+1) = (r - K N(t)) N(t)
\]</span> (discr-log)</p>
<p>This is called the <em>logistic model</em> of population growth. As you see, it has two different parameters, <span class="math inline">\(r\)</span> and <span class="math inline">\(K\)</span>. If <span class="math inline">\(K = 0\)</span>, the equation reduces to the old linear population model. Intuitively, <span class="math inline">\(K\)</span> is the parameter describing the effect of increasing population on the population growth rate. Let us analyze the dimensions of the two parameters, by writing down the dimensions of the variables of the difference equation. The dimensional equation is:</p>
<p><span class="math display">\[
N(t+1) = [population]= [r- K N(t)] N(t) =
= ([r]  - [K] \times [population]) \times [population]
\]</span></p>
<p>Matching the dimensions on the two sides of the equation leads us to conclude that the dimensions of <span class="math inline">\(r\)</span> and <span class="math inline">\(k\)</span> are different:</p>
<p><span class="math display">\[
[r] = 1 ; \; [K] =  \frac{1}{[population]}
\]</span></p>
<p>The difference equation for the logistic model is <em>nonlinear</em>, because it includes a second power of the dependent variable. In general, it is difficult to solve nonlinear equations, but we can still say a lot about this model’s behavior without knowing its explicit solution.</p>
</section>
<section id="qualitative-analysis-of-difference-equations" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="qualitative-analysis-of-difference-equations"><span class="header-section-number">3.2</span> Qualitative analysis of difference equations</h2>
<section id="fixed-points-or-equilibria" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="fixed-points-or-equilibria"><span class="header-section-number">3.2.1</span> fixed points or equilibria</h3>
<p>We have seen that the solutions of difference equations depend on the initial value of the dependent variable. In the examples we have seen so far, the long-term behavior of the solution does not depend dramatically on the initial condition. In more complex systems that we will encounter, there are special values of the dependent variable for which the dynamical system is constant, like in the pile of rocks model.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Definition
</div>
</div>
<div class="callout-body-container callout-body">
<p>For a difference equation in recurrent form <span class="math inline">\(x(t+1) = f(X(t))\)</span>, a point <span class="math inline">\(x^*\)</span> which satisfies <span class="math inline">\(f(x^*)=x^*\)</span> is called a <em>fixed point</em> or <em>equilibrium</em>. If the initial condition is a fixed point, <span class="math inline">\(x_0=x^*\)</span>, the solution will stay at the same value for all time, <span class="math inline">\(x(t)=x^*\)</span>.</p>
</div>
</div>
<p>The reason these special points are also known as equilibria is due to the precise balance between growth and decay that is mandated at a fixed point. In terms of population modeling, at an equilibrium the birth rates and the death rates are equal. Speaking analytically, in order to find the fixed points of a difference equation, one must solve the equation <span class="math inline">\(f(x^*) = x^*\)</span>. It may have none, or one, or many solutions.</p>
<p><strong>Example.</strong> The linear population models which we analyzed in the previous sections have the mathematical form <span class="math inline">\(N(t+1)= r N(t)\)</span> (where <span class="math inline">\(r\)</span> can be any real number). Then the only fixed point of those models is <span class="math inline">\(N^* = 0\)</span>, that is, a population with no individuals. If there are any individuals present, we know that the population will grow to infinity if <span class="math inline">\(|r| &gt; 1\)</span>, and decay to 0 if <span class="math inline">\(|r| &lt; 1\)</span>. This is true even for the smallest population size, as long as it is not exactly zero.</p>
<p><strong>Example.</strong> Let us go back to the example of a linear difference equation with a constant term. The equation is $ N(t+1) = -0.5N(t) +10$, and we saw that the numerical solutions all converged to the same value, regardless of the initial value. Let us find the equilibrium value of this model using the definition:</p>
<p><span class="math display">\[
N^* = -0.5N^* +10 \Rightarrow 1.5 N^* = 10  \Rightarrow N^* = 10/1.5 = 20/3
\]</span></p>
<p>If the initial value is equal to the equilibrium, <span class="math inline">\(N(0)= 20/3\)</span>, then the solution will remain constant for all time, since the next value <span class="math inline">\(N(t+1) = -0.5*20/3+10 = 20/3\)</span> remains the same.</p>
<p><strong>Example: discrete logistic model.</strong> Let us use the simplified version of the logistic equation <span class="math inline">\(N(t+1) = r(1 - N(t)) N(t)\)</span> and set the right-hand side function equal to the variable <span class="math inline">\(N\)</span> to find the fixed points <span class="math inline">\(N^*\)</span>: <span class="math display">\[r(1 - N^*) N^* = N^*\]</span> There are two solutions to this equation, <span class="math inline">\(N^* = 0\)</span> and <span class="math inline">\(N^* = (r-1)/r\)</span>. These are the fixed points or the equilibrium population sizes for the model, the first being the obvious case when the population is extinct. The second equilibrium is more interesting, as it describes the <em>carrying capacity</em> of a population in a particular environment. If the initial value is equal to either of the two fixed points, the solution will remain at that same value for all time. But what happens to solutions which do not start a fixed point? Do they converge to a fixed point, and if so, to which one?</p>
</section>
<section id="stability-criteria-for-fixed-points" class="level3" data-number="3.2.2">
<h3 data-number="3.2.2" class="anchored" data-anchor-id="stability-criteria-for-fixed-points"><span class="header-section-number">3.2.2</span> stability criteria for fixed points</h3>
<<<<<<< Updated upstream
<p>What happens to the solution of a dynamical system if the initial condition is very close to an equilibrium, but not precisely at it? Put another way, what happens if the equilibrium is <em>perturbed</em>? To answer the question, we will no longer confine ourselves to the integers, to be interpreted as population sizes. We will instead consider, abstractly, what happens if the smallest perturbation is added to a fixed point. Will the solution tend to return to the fixed point or tend to move away from it? The answer to this question is formalized in the following definition <span class="citation" data-cites="strogatz_nonlinear_2001">(<a href="references.html#ref-strogatz_nonlinear_2001" role="doc-biblioref">Strogatz 2001</a>)</span>:</p>
=======
<p>What happens to the solution of a dynamical system if the initial condition is very close to an equilibrium, but not precisely at it? Put another way, what happens if the equilibrium is <em>perturbed</em>? To answer the question, we will no longer confine ourselves to the integers, to be interpreted as population sizes. We will instead consider, abstractly, what happens if the smallest perturbation is added to a fixed point. Will the solution tend to return to the fixed point or tend to move away from it? The answer to this question is formalized in the following definition <span class="citation" data-cites="strogatz_nonlinear_2001">(<a href="references.html#ref-strogatz_nonlinear_2001" role="doc-biblioref"><strong>strogatz_nonlinear_2001?</strong></a>)</span>:</p>
>>>>>>> Stashed changes
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Definition
</div>
</div>
<div class="callout-body-container callout-body">
<p>For a difference equation <span class="math inline">\(x(t+1) = f(x(t))\)</span>, a fixed point <span class="math inline">\(x^*\)</span> is <em>stable</em> if for a sufficiently small number <span class="math inline">\(\epsilon\)</span>, the solution <span class="math inline">\(x(t)\)</span> with the initial condition <span class="math inline">\(x_0 = x^* + \epsilon\)</span> approaches the fixed point <span class="math inline">\(x^*\)</span> as <span class="math inline">\(t \rightarrow \infty\)</span>. If the solution <span class="math inline">\(x(t)\)</span> does not approach <span class="math inline">\(x^*\)</span> for any nonzero <span class="math inline">\(\epsilon\)</span>, the fixed point is called <em>unstable</em>.</p>
</div>
</div>
<p>The notion of stability is central to the study of dynamical systems. Typically, models more complex than those we have seen cannot be solved analytically. Finding the fixed points and determining their stability can help us understand the general behavior of solutions without writing them down. For instance, we know that solutions never approach an unstable fixed point, whereas for a stable fixed point the solutions will tend to it, from some range of initial conditions.</p>
<p>There is a mathematical test to determine the stability of a fixed point. From standard calculus comes the Taylor expansion, which approximates the value of a function near a given point. Take a general difference equation written in terms of some function <span class="math inline">\(x(t+1) = f(x(t))\)</span>. Let us define the <em>deviation</em> from the fixed point <span class="math inline">\(x^*\)</span> at time <span class="math inline">\(t\)</span> to be <span class="math inline">\(\epsilon(t) = x_{t} - x^*\)</span>. Then we can use the linear (first-order) Taylor approximation at the fixed point and write down the following expression:</p>
<p><span class="math display">\[
x(t+1) = f(x^*) + \epsilon(t) f'(x^*) + ...
\]</span></p>
<p>The ellipsis means that the expression is approximate, with terms of order <span class="math inline">\(\epsilon(t)^2\)</span> and higher swept under the rug. Since we take <span class="math inline">\(\epsilon(t)\)</span> to be small, those terms are very small and can be neglected. Since <span class="math inline">\(x^*\)</span> is a fixed point, <span class="math inline">\(f(x^*) = x^*\)</span>. Thus, we can write the following difference equation to describe the behavior of the deviation from the fixed point <span class="math inline">\(X^*\)</span>:</p>
<p><span class="math display">\[
x(t+1) -  x^* =  \epsilon(t+1)= \epsilon(t) f'(x^*)
\]</span></p>
<p>We see that we started out with a general function defining the difference equation and transformed it into a linear equation for the deviation <span class="math inline">\(\epsilon(t)\)</span>. Note that the multiplicative constant here is the derivative of the function at the fixed point: <span class="math inline">\(f'(x^*)\)</span>. This is called the <em>linearization</em> approach, which is an approximation of a dynamical system near a fixed point with a linear equation for the small perturbation.</p>
<p>We found the solution to simple linear equations, which we can use describe the behavior of the perturbation to the fixed point. The behavior <strong>depends on the value of the derivative of the updating function</strong> <span class="math inline">\(f'(X^*)\)</span>:</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Important Fact
</div>
</div>
<div class="callout-body-container callout-body">
<p>For a difference equation <span class="math inline">\(x(t+1) = f(x(t))\)</span>, a fixed point <span class="math inline">\(x^*\)</span> can be classified as follows:</p>
<ul>
<li><p><span class="math inline">\(|f'(x^*)| &gt; 1\)</span>: the deviation <span class="math inline">\(\epsilon(t)\)</span> grows, and the solution moves away from the fixed point; fixed point is <em>unstable</em></p></li>
<li><p><span class="math inline">\(|f'(x^*)| &lt; 1\)</span>: the deviation <span class="math inline">\(\epsilon(t)\)</span> decays, and the solution approaches the fixed point; fixed point is <em>stable</em></p></li>
<li><p><span class="math inline">\(|f'(x^*)| = 1\)</span>: the fixed point may be stable or unstable, and more information is needed</p></li>
</ul>
</div>
</div>
<p>We now know how to determine the stability of a fixed point, so let us apply this method to some examples.</p>
<p><strong>Example: linear difference equations.</strong> Let us analyze the stability of the fixed point of a linear difference equation, e.g. <span class="math inline">\(N(t+1) = -0.5N(t) +10\)</span>. The derivative of the updating function is equal to -0.5. Because it is less than 1 in absolute value, the fixed point is stable, so solutions converge to this equilibrium. We can state more generally that any linear difference equation of the form <span class="math inline">\(N(t+1) = aN(t) + b\)</span> has one fixed point, which is equal to <span class="math inline">\(N^* = b/(1-a)\)</span>. This fixed point is stable if <span class="math inline">\(|a| &lt;1\)</span> and unstable if <span class="math inline">\(|a|&gt;1\)</span>.</p>
<p><strong>Example: discrete logistic model.</strong> In the last subsection we found the fixed points of the simplified logistic model. To determine what happens to the solution, we need to determine the stability of both equilibria. Since the stability of fixed points is determined by the derivative of the defining function at the fixed points, we compute the derivative of <span class="math inline">\(f(N) = rN-rN^2\)</span> to be <span class="math inline">\(f'(N) = r-2rN\)</span>, and evaluate it at the two fixed points <span class="math inline">\(N^* = 0\)</span> and <span class="math inline">\(N^* = (r-1)/r\)</span>:</p>
<p><span class="math display">\[
f'(0) = r; \; \; f'((r-1)/r) = r-2(r-1) = 2-r
\]</span></p>
<p>Because the intrinsic death rate cannot be greater than the birth rate, we know that <span class="math inline">\(r&gt;0\)</span>. Therefore, we have the following <em>stability conditions</em> for the two fixed points:</p>
<ul>
<li><p>the fixed point <span class="math inline">\(N^*=0\)</span> is stable for <span class="math inline">\(r&lt;1\)</span>, and unstable for <span class="math inline">\(r&gt;1\)</span>;</p></li>
<li><p>the fixed point <span class="math inline">\(N^*= (r-1)/r\)</span> is stable for <span class="math inline">\(1&lt;r&lt;3\)</span>, and unstable otherwise.</p></li>
</ul>
</section>
</section>
<section id="analysis-of-logistic-population-model" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="analysis-of-logistic-population-model"><span class="header-section-number">3.3</span> Analysis of logistic population model</h2>
<section id="rescaling-the-logistic-model" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="rescaling-the-logistic-model"><span class="header-section-number">3.3.1</span> rescaling the logistic model</h3>
<p>First, let us do one more modification of the model, by taking the parameter <span class="math inline">\(r\)</span> as the common multiple:</p>
<p><span class="math display">\[
N_{t+1} = r(1 - \frac{K}{r} N_t) N_t
\]</span></p>
<p>As we saw, the parameter <span class="math inline">\(K\)</span> has dimension of inverse population size, and that the parameter <span class="math inline">\(r\)</span> is dimensionless. We can now use rescaling of the variable <span class="math inline">\(N\)</span> to simplify the logistic model. The goal is to reduce the number of parameters, by canceling some, and bringing the rest into one place, where they can be combined into a <em>dimensionless group</em>. Here is how this is accomplished for this model:</p>
<ol type="1">
<li>Pick a number of the same dimension as the variable, called the scale, and divide the variable by it. In this case, let the scale for population be <span class="math inline">\(r/K\)</span>, so then the new variable is</li>
</ol>
<p><span class="math display">\[
\tilde N = \frac{NK}{r}  \Longrightarrow N = \frac{\tilde N r}{ K }
\]</span></p>
<p>Since the parameter <span class="math inline">\(K\)</span> has dimension of inverse population size, <span class="math inline">\(NK\)</span> is in the dimensionless variable <span class="math inline">\(\tilde N\)</span>.</p>
<ol start="2" type="1">
<li>Substitute <span class="math inline">\(\tilde N / K\)</span> for <span class="math inline">\(N\)</span> in the equation:</li>
</ol>
<p><span class="math display">\[
\frac{\tilde N_{t+1}r }{ K} = r\left(1  -\frac{ K \tilde N_t  r}{rK} \right) \frac{\tilde N_t r} {K}
\]</span></p>
<ol start="3" type="1">
<li>Canceling all the parameters on both sides, we just have the dimensionless growth rate <span class="math inline">\(r\)</span>, as our only parameter:</li>
</ol>
<p><span class="math display">\[
\tilde N_{t+1}  = r(1 -\tilde N_t)\tilde N_t
\]</span></p>
<p>On the surface, we merely used algebraic trickery to simplify the equation, but the result is actually rather deep. By changing the dimension of measurement of the population from individuals (<span class="math inline">\(N\)</span>) to the dimensionless fraction of the carrying capacity (<span class="math inline">\(\tilde N\)</span>) we found that there is only one parameter <span class="math inline">\(r\)</span> that governs the behavior of this model. We will see in the next two section that varying this parameter leads to dramatic changes in the dynamics of the model population. <span class="citation" data-cites="edelstein-keshet_mathematical_2005">(<a href="references.html#ref-edelstein-keshet_mathematical_2005" role="doc-biblioref">Edelstein-Keshet 2005</a>)</span></p>
</section>
<section id="fixed-point-analysis" class="level3" data-number="3.3.2">
<h3 data-number="3.3.2" class="anchored" data-anchor-id="fixed-point-analysis"><span class="header-section-number">3.3.2</span> fixed point analysis</h3>
<p>The first step for qualitative analysis of a nonlinear model is to find the fixed points. We use the dimensionless version of the logistic equation, and the right-hand side function equal to the value of the special values <span class="math inline">\(N^*\)</span> (fixed points):</p>
<p><span class="math display">\[
r(1 - N^*) N^* = N^*
\]</span></p>
<p>There are two solutions to this equation, <span class="math inline">\(N^* = 0\)</span> and <span class="math inline">\(N^* = (r-1)/r\)</span>. These are the fixed points or the equilibrium population sizes for the model, the first being the obvious case when the population is extinct. The second equilibrium is more interesting, as it describes the <em>carrying capacity</em> of a population in a particular environment. To determine what happens to the solution, we need to evaluate the stability of both equilibria.</p>
<p>We have seen in the analytical section that the stability of fixed points is determined by the derivative of the defining function at the fixed points. The derivative of <span class="math inline">\(f(N) = rN-rN^2\)</span> is <span class="math inline">\(f'(N) = r-2rN\)</span>, and we evaluate it at the two fixed points:</p>
<p><span class="math display">\[
f'(0) = r; \; \; f'((r-1)/r) = r-2(r-1) = 2-r
\]</span></p>
<p>Because the intrinsic death rate cannot be greater than the birth rate, we know that <span class="math inline">\(r&gt;0\)</span>. Therefore, we have the following stability conditions for the two fixed points:</p>
<ul>
<li><p>the fixed point <span class="math inline">\(N^*=0\)</span> is stable for <span class="math inline">\(r&lt;1\)</span>, and unstable for <span class="math inline">\(r&gt;1\)</span>;</p></li>
<li><p>the fixed point <span class="math inline">\(N^*= (r-1)/r\)</span> is stable for <span class="math inline">\(1&lt;r&lt;3\)</span>, and unstable otherwise.</p></li>
</ul>
<p>We can plot the solution for the population size of the logistic model population over time. We see that, depending on the value of the parameter <span class="math inline">\(r\)</span> (but not on <span class="math inline">\(k\)</span>), the behavior is dramatically different:</p>
<p><strong>Case 1: <span class="math inline">\(r &lt; 1\)</span>.</strong> The fixed point at <span class="math inline">\(N^*= 0\)</span> is stable and the fixed point is unstable <span class="math inline">\(N^* = (r-1)/r\)</span>. The solution tends to 0, or extinction, regardless of the initial condition, which is illustrated in figure [fig:sol_logistic_2] for <span class="math inline">\(r=0.8\)</span>.</p>
<p><strong>Case 2: <span class="math inline">\(1 &lt; r &lt; 3\)</span>.</strong> The extinction fixed point <span class="math inline">\(N^*= 0\)</span> is unstable, but the carrying capacity fixed point <span class="math inline">\(N^* = (r-1)/r\)</span> is stable. We can conclude that the solution will approach the carrying capacity for most initial conditions. This was shown in figure [fig:sol_logistic_1] for <span class="math inline">\(r=1.5\)</span> and is illustrated in figure [fig:sol_logistic_3] for <span class="math inline">\(r=2.8\)</span>. Notice that although the solution approaches the carrying capacity equilibrium in both cases, when <span class="math inline">\(r&gt;2\)</span>, the solution oscillates while converging to its asymptotic value, foreshadowing the behavior when <span class="math inline">\(r&gt;3\)</span>.</p>
<p><strong>Case 3: <span class="math inline">\(r &gt; 3\)</span>.</strong> Strange things happen: there are no stable fixed points, so there is no value for the solution to approach. As we saw in the previous section, the solution can undergo so-called period two oscillations, which are shown in figure [fig:sol_logistic_4] with <span class="math inline">\(r=3.3\)</span>. However, even stranger behavior is observed when the parameter <span class="math inline">\(r\)</span> crosses the threshold of about <span class="math inline">\(3.59\)</span>. Figure [fig:sol_logistic_5] shows the behavior of the solution for <span class="math inline">\(r=3.6\)</span>, which is no longer periodic, and instead seems to bounce around without any discernible pattern. This dynamics is known as <em>chaos</em>.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-edelstein-keshet_mathematical_2005" class="csl-entry" role="listitem">
Edelstein-Keshet, Leah. 2005. <em>Mathematical <span>Models</span> in <span>Biology</span></em>. 1st ed. SIAM: Society for Industrial; Applied Mathematics.
</div>
<div id="ref-strogatz_nonlinear_2001" class="csl-entry" role="listitem">
Strogatz, Steven H. 2001. <em>Nonlinear <span>Dynamics</span> <span>And</span> <span>Chaos</span>: <span>With</span> <span>Applications</span> <span>To</span> <span>Physics</span>, <span>Biology</span>, <span>Chemistry</span>, <span>And</span> <span>Engineering</span></em>. 1st ed. Westview Press.
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./ch2_plotting_python.html" class="pagination-link" aria-label="Plotting in Python">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Plotting in Python</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./ch4_cobweb_plots.html" class="pagination-link" aria-label="Graphical analysis of difference equations">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Graphical analysis of difference equations</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>