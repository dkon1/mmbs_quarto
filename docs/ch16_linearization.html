<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.24">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>16&nbsp; Linearization of ODEs – Mathematical Methods for Biology, Part 1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./ch17_nonlinear_oscillations.html" rel="next">
<link href="./ch15_fourier.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dc55a5b9e770e841cd82e46aadbfb9b0.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-27c261d06b905028a18691de25d09dde.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ch16_linearization.html"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Linearization of ODEs</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Mathematical Methods for Biology, Part 1</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch1_discrete1var.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">One variable in discrete time</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch2_plotting_python.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Plotting in Python</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch3_discrete_chaos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Nonlinear discrete-time dynamic models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch4_cobweb_plots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Graphical analysis of difference equations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch5_discrete_higher.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Discrete models of higher order</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch6_matrix_mult.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Matrix multiplication and population models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch7_linear_reg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Linear regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch8_LinReg_python.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Linear regression in Python</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch9_1var_ode.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Models with one variable in continuous time</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch10_numeric_ode.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Numeric solutions of ODEs</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch11_graph_ode.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Graphical analysis of ordinary differential equations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch12_linear_pplane.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Linear ODEs with two variables</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch13_phase_portraits.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Phase portraits in Python</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch14_lin_oscillations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Forces and potentials in biological modeling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch15_fourier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Fourier series: decomposition by frequency</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch16_linearization.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Linearization of ODEs</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch17_nonlinear_oscillations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Nonlinear oscillations in biology</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">16.1</span> Introduction</a></li>
  <li><a href="#modeling-product-terms-in-nonlinear-differential-equations" id="toc-modeling-product-terms-in-nonlinear-differential-equations" class="nav-link" data-scroll-target="#modeling-product-terms-in-nonlinear-differential-equations"><span class="header-section-number">16.2</span> Modeling: product terms in nonlinear differential equations</a>
  <ul class="collapse">
  <li><a href="#ecological-competition" id="toc-ecological-competition" class="nav-link" data-scroll-target="#ecological-competition"><span class="header-section-number">16.2.1</span> ecological competition</a></li>
  <li><a href="#chemical-reactions-with-two-molecules" id="toc-chemical-reactions-with-two-molecules" class="nav-link" data-scroll-target="#chemical-reactions-with-two-molecules"><span class="header-section-number">16.2.2</span> chemical reactions with two molecules</a></li>
  </ul></li>
  <li><a href="#analytical-linearization-in-multiple-dimensions" id="toc-analytical-linearization-in-multiple-dimensions" class="nav-link" data-scroll-target="#analytical-linearization-in-multiple-dimensions"><span class="header-section-number">16.3</span> Analytical: linearization in multiple dimensions</a>
  <ul class="collapse">
  <li><a href="#finding-fixed-points-of-nonlinear-odes" id="toc-finding-fixed-points-of-nonlinear-odes" class="nav-link" data-scroll-target="#finding-fixed-points-of-nonlinear-odes"><span class="header-section-number">16.3.1</span> finding fixed points of nonlinear ODEs</a></li>
  <li><a href="#linear-stability-analysis-of-fixed-points" id="toc-linear-stability-analysis-of-fixed-points" class="nav-link" data-scroll-target="#linear-stability-analysis-of-fixed-points"><span class="header-section-number">16.3.2</span> linear stability analysis of fixed points</a></li>
  </ul></li>
  <li><a href="#computational-analysis-of-jacobian-matrices" id="toc-computational-analysis-of-jacobian-matrices" class="nav-link" data-scroll-target="#computational-analysis-of-jacobian-matrices"><span class="header-section-number">16.4</span> Computational analysis of Jacobian matrices</a></li>
  <li><a href="#application-sir-model" id="toc-application-sir-model" class="nav-link" data-scroll-target="#application-sir-model"><span class="header-section-number">16.5</span> Application: SIR model</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Linearization of ODEs</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="introduction" class="level2" data-number="16.1">
<h2 data-number="16.1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">16.1</span> Introduction</h2>
<p>Previously we learned to analyze and solve linear ODEs with two variables. The main idea was that the type of dynamics in a multivariable ODE is completely determined by the eigenvalues of the defining matrix, with the eigenvectors and initial conditions providing the relative weights of the variables. We will use these ideas to analyze nonlinear models, for which, typically, no analytical solution exists. Instead, we will focus on phase plane analysis to qualitatively describe the types of solutions possible for a dynamical system.</p>
<p>The main idea of this chapter is linearization, or approximating a nonlinear dynamical system with a matrix near a particular fixed point. This enables the use of the tools of linear algebra to characterize the local dynamics of the system. Linearization is an essential tool of applied mathematics and is quite powerful, even though it is not exact, and only applies in a local, possibly small neighborhood of a fixed point. In the next chapter, the stability of fixed points and the direction of flow of solutions will be used to obtain a more comprehensive picture of dynamics in the phase plane.</p>
<p>In this chapter, we will see examples of nonlinear ODEs in biology in the modeling section, and discuss the origin of product terms. In the analytical section, we will learn to linearize differential equations with more than one variable, and to analyze the dynamics near fixed points for two-variable ODEs. In the computational section, we will use numerical methods to find the eigenvalues of the linearized systems, and use computational tools for drawing the phase plane portraits near the fixed points. We will then use these techniques to analyze the dynamics of infections in a SIR epidemiology model.</p>
</section>
<section id="modeling-product-terms-in-nonlinear-differential-equations" class="level2" data-number="16.2">
<h2 data-number="16.2" class="anchored" data-anchor-id="modeling-product-terms-in-nonlinear-differential-equations"><span class="header-section-number">16.2</span> Modeling: product terms in nonlinear differential equations</h2>
<p>Nonlinear ODE is not a particularly descriptive term: it includes all equations that contain terms other than a constant or a constant times the dependent variable, e.g.&nbsp;<span class="math inline">\(x^2, y^3, ae^{x-y}\)</span>. One common type of nonlinearity is a product term <span class="math inline">\(axy\)</span> (<span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> are dependent variables, and <span class="math inline">\(a\)</span> is a constant). This term arises in diverse biological models, as illustrated below. The significance of the product terms is that they quantify the effect of <strong>independent encounters</strong> between the two entities modeled by the dependent variables, influence their rates of change. Thus, a product of the two variables captures this dependence, which grows proportional to the size of both variables, and is zero if either variable vanishes.</p>
<section id="ecological-competition" class="level3" data-number="16.2.1">
<h3 data-number="16.2.1" class="anchored" data-anchor-id="ecological-competition"><span class="header-section-number">16.2.1</span> ecological competition</h3>
<p>Suppose two species are competing for the same resources, e.g.&nbsp;rabbits and sheep want to graze in the same fields. Let their individual growth rates be governed by logistic equations, with certain carrying capacities <span class="math inline">\(K_r\)</span> and <span class="math inline">\(K_s\)</span> and rates of growth <span class="math inline">\(a_r\)</span> and <span class="math inline">\(a_s\)</span>. In addition, the two species influence each others’ rates of growth when their respective populations grow, by using up resources that both populations need to survive. Thus, the effect of competition can be represented by a term proportional to the <strong>product of the two populations</strong>. The effect of competition on the rabbits is represented by <span class="math inline">\(c_r\)</span> and that on the sheep <span class="math inline">\(c_s\)</span>, and the two parameters need not be the same, e.g.&nbsp;because the sheep are less sensitive to competition from rabbits than vice versa. The two variable ODE model can then be written as follows, with <span class="math inline">\(S\)</span> representing sheep and <span class="math inline">\(R\)</span> rabbits:</p>
<p><span class="math display">\[
\begin{aligned}
\dot S &amp;=&amp; r_1 S(K_1 -S) - c_s SR \\
\dot R &amp;=&amp; r_2 R(K_2 - R) - c_r SR
\end{aligned}
\]</span></p>
<p>These equations are nonlinear due to the squared terms and the <span class="math inline">\(SR\)</span> terms. We cannot apply the powerful methods of linear algebra and find the eigenvalues of the system, since the equations cannot be written in matrix-vector form. In the analytical section, we will learn to use the method of linearization around a fixed point to determine behavior locally near equilibrium points.</p>
</section>
<section id="chemical-reactions-with-two-molecules" class="level3" data-number="16.2.2">
<h3 data-number="16.2.2" class="anchored" data-anchor-id="chemical-reactions-with-two-molecules"><span class="header-section-number">16.2.2</span> chemical reactions with two molecules</h3>
<p>Many biochemical reactions depend on <strong>encounters between two molecules</strong>, e.g.&nbsp;an enzyme and a substrate. As we would expect, this process is represented by a product terms in models of chemical kinetics. Take, for instance, a reversible bimolecular reaction:</p>
<p><span class="math display">\[
A + B {\textstyle \overset{k_1}{\underset{k_{-1}}{\rightleftarrows}}} C
%A + B \xrightleftharpoons[k_{-1}]{k_1}C
\]</span></p>
<p>The chemical reaction rates <span class="math inline">\(k_1\)</span> and <span class="math inline">\(k_{-1}\)</span> are related to the speed of the forward (association) and backward (dissociation) reactions, but the two processes are fundamentally different, as in the SIS model above. The forward reaction depends on molecule <span class="math inline">\(A\)</span> encountering molecule <span class="math inline">\(B\)</span>, and thus its rate is proportional to the product of their concentrations. The dissociation reaction rate depends linearly on the concentration of <span class="math inline">\(C\)</span>. Thus, the differential equations describing the rates of change of the concentrations of the three molecules are:</p>
<p><span class="math display">\[
\begin{aligned}
\dot A &amp;=&amp;  -k_1 AB + k_{-1} C \\
\dot  B &amp;=&amp;  -k_1 AB + k_{-1} C\\
\dot C &amp;=&amp; k_1 AB - k_{-1} C
\end{aligned}
\]</span></p>
<p>The equation are redundant, as the rates of change of <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are equal. Therefore, if <span class="math inline">\(A_0\)</span> and <span class="math inline">\(B_0\)</span> are the initial concentrations of the two molecules, the concentration of <span class="math inline">\(B(t)\)</span> at some further time is given by <span class="math inline">\(B(t) = A(t) - A_0 + B_0\)</span> (adjusting for the difference in initial concentrations).</p>
<p>Further, there is a conserved quantity found by adding either <span class="math inline">\(\dot A + \dot C = 0\)</span> or <span class="math inline">\(\dot B + \dot C = 0\)</span>. Thus, the sum of either the number of molecules <span class="math inline">\(A\)</span> and <span class="math inline">\(C\)</span> or of <span class="math inline">\(B\)</span> and <span class="math inline">\(C\)</span> is constant in the course of the reaction. Let <span class="math inline">\(C_0\)</span> be the initial concentration of <span class="math inline">\(C\)</span>. Since the sum of two concentrations is constant, <span class="math inline">\(C(t) + A(t) = C_0 + A_0 \Rightarrow C(t) = C_0 + A_0 - A(t)\)</span>. Note that the total number of molecules <span class="math inline">\(A+B+C\)</span> is not conserved, since the reactions change the number of molecules. The two redundancies make it possible to reduce the three equations to one:</p>
<p><span class="math display">\[ A' = -k_1A(A-A_0+B_0) + k_{-1} A(C_0 + A_0 - A)\]</span></p>
<p>This equation can be examined using standard stability analysis for one-dimensional ODEs.</p>
</section>
</section>
<section id="analytical-linearization-in-multiple-dimensions" class="level2" data-number="16.3">
<h2 data-number="16.3" class="anchored" data-anchor-id="analytical-linearization-in-multiple-dimensions"><span class="header-section-number">16.3</span> Analytical: linearization in multiple dimensions</h2>
<p>In this section we learn to analyze the stability of fixed points in multiple dimensions. The concepts of fixed points and stability are the same as for one-dimensional dynamical systems. A fixed point is a point in the phase space (line, plane, etc.) at which all time derivatives are zero, i.e.&nbsp;there is no flow. The flow near a fixed point determines its stability: if all solutions in a neighborhood of a fixed point approach it for all time, the the fixed point is stable, otherwise it is not. We will now learn the mathematical to tools to do this analysis.</p>
<section id="finding-fixed-points-of-nonlinear-odes" class="level3" data-number="16.3.1">
<h3 data-number="16.3.1" class="anchored" data-anchor-id="finding-fixed-points-of-nonlinear-odes"><span class="header-section-number">16.3.1</span> finding fixed points of nonlinear ODEs</h3>
<p>A fixed point for a dynamical system of more than one variable is a set of values of all the variables, at which the dynamical system has no changes in any direction. More precisely,</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Definition
</div>
</div>
<div class="callout-body-container callout-body">
<p>For a dynamical system of <span class="math inline">\(N\)</span> variables <span class="math inline">\(\{x_i(t)\}\)</span> defined by <span class="math inline">\(N\)</span> first-order ordinary differential equations of the form <span class="math inline">\(\dot x_i = f_i(x_1, x_2, ..., x_N)\)</span>, a <em>fixed point</em> is a vector of values of all <span class="math inline">\(N\)</span> variables, <span class="math inline">\(\vec x^* = (x_1^*, x_2^*, ... , x_N^*)\)</span> for which every time derivative is zero, that is, $ 0 = f_i(x_1^<em>, x_2^</em>, …, x_N^*)$ for all <span class="math inline">\(i = 1, ..., N\)</span>.</p>
</div>
</div>
<p>It follows from the definition that to find a fixed point in multiple dimensions, we must solve several nonlinear algebraic equations simultaneously. This is not always easy, nor is it necessarily possible to do by hand. One standard approach is to consider the equations separately, and then the points where they all agree are the fixed points.</p>
<p>In two dimensions, this process is easy to visualize in terms of flow in the phase plane. Let us call the two dependent variables <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>, with differential equations <span class="math inline">\(\dot x = f_1(x,y)\)</span> and <span class="math inline">\(\dot y = f_2(x,y)\)</span>. The two equations for the fixed points are:</p>
<p><span class="math display">\[
\begin{aligned}
0 &amp;=&amp; f_1(x, y) \\
0 &amp;=&amp; f_2(x,y)
\end{aligned}
\]</span></p>
<p>The first equation specificies the condition that <span class="math inline">\(dx/dt = 0\)</span>, while the second corresponds to <span class="math inline">\(dy/dt = 0\)</span>. In terms of the geometry of the phase plane with <span class="math inline">\(x\)</span> on the horizontal axis and <span class="math inline">\(y\)</span> on the vertical, it means that at any point <span class="math inline">\((x,y)\)</span> that satisfies the first equation, the flow is strictly vertical, with no horizontal component, while for a point that satisfies the second equation, the flow is strictly horizontal, with no vertical component. This leads us to a useful new concept in the phase plane:</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Definition
</div>
</div>
<div class="callout-body-container callout-body">
<p>For a two-dimensional autonomous ODE defined by <span class="math inline">\(\dot x = f_1(x,y)\)</span> and <span class="math inline">\(\dot y = f_2(x,y)\)</span>, the set of points which satisfy <span class="math inline">\(0 = f_1(x,y)\)</span> is called the <em>x-nullcline</em>, and the set of points which satisfy <span class="math inline">\(0 = f_2(x,y)\)</span> is called the <em>y-nullcline</em>. The direction of flow at any point on the x-nullcline is strictly vertical, while on the y-nullcline it is strictly horizontal.</p>
</div>
</div>
<p>This idea gives us a graphical tool for visualizing the flow in the phase plane. The sets of points that satisfy the equations <span class="math inline">\(0=f_1(x,y)\)</span> and <span class="math inline">\(0=f_2(x,y)\)</span> may be found by solving the equation for <span class="math inline">\(y\)</span>, and then plotting the results as curves in the phase plane. In some cases, the equation may not be solvable analytically (e.g.&nbsp;a transcendental equation) but one can still find the nullcline numerically and to plot its graph. Once all the nullclines are graphed, one may find the fixed points at the intersections of the x- and y-nullclines.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Example: rabbits and sheep
</div>
</div>
<div class="callout-body-container callout-body">
<p>The fixed points of the model introduced in the modeling section, equation <span class="math inline">\(\ref{eq:rs_competition}\)</span> must satisfy the conditions <span class="math inline">\(\dot s = \dot r = 0\)</span>. Let us set the following constants for our example <span class="math inline">\(K_1 = 2\)</span>, <span class="math inline">\(K_r2 = 3\)</span>, <span class="math inline">\(r_1 = r_2 = 1\)</span>, <span class="math inline">\(c_s = 1\)</span>, <span class="math inline">\(c_r = 2\)</span>. Then the two equations that define the fixed points are:</p>
<p><span class="math display">\[
\begin{aligned}
0 &amp;=&amp;  s(2 -s) - sr \\
0 &amp;=&amp;  r(3 -r) - 2sr
\end{aligned}
\]</span></p>
<p>Let us find the nullclines of this dynamical system. The first equation is satisfied under two conditions: either <span class="math inline">\(s=0\)</span> or <span class="math inline">\(r = 2-s\)</span>; these are the two <span class="math inline">\(s\)</span>-nullclines. The second equation is satisfied under two conditions as well: either <span class="math inline">\(r=0\)</span> or <span class="math inline">\(2s = 3-r\)</span>; these are the two <span class="math inline">\(r\)</span>-nullclines.</p>
<p>We then look for the intersections of the nullclines to determine the fixed points. First, <span class="math inline">\(s=0\)</span> and <span class="math inline">\(r=0\)</span> intersect at the origin, so <span class="math inline">\(s=r=0\)</span> is a fixed point. Second, <span class="math inline">\(s=0\)</span> intersects the line <span class="math inline">\(2s = 3-r\)</span> at <span class="math inline">\(s=0; r=3\)</span>, so this is a second fixed point. Third, <span class="math inline">\(r=0\)</span> intersects the line <span class="math inline">\(r=2-s\)</span> at <span class="math inline">\(s=2; r=0\)</span>, and we have the third fixed point, Finally, the two lines <span class="math inline">\(r=2-s\)</span> and <span class="math inline">\(2s=3-r\)</span> intersect at <span class="math inline">\(s=1; r=1\)</span>, which may be found either by sibstitution of <span class="math inline">\(r=2-s\)</span> into <span class="math inline">\(2s=3-r\)</span> or by graphing the two lines. We have found four fixed points, and because all the nullclines have straight line graphs, they can only intersect once, therefore this is the complete list of fixed points.</p>
<p>Let us interpret these equilibria. The one at the origin corresponds to the situation when there are no sheep or rabbits, so it is the dual extinction equilibrium. The two fixed points on the axes (<span class="math inline">\(s=0; r=3\)</span> and <span class="math inline">\(s=2, r=0\)</span>) correspond to one species surviving and reaching its carrying capacity, with the other one dying off. The final fixed point <span class="math inline">\(s=1, r=1\)</span> is called a <em>coexistence equilibrium</em>, in which both species survive.</p>
</div>
</div>
</section>
<section id="linear-stability-analysis-of-fixed-points" class="level3" data-number="16.3.2">
<h3 data-number="16.3.2" class="anchored" data-anchor-id="linear-stability-analysis-of-fixed-points"><span class="header-section-number">16.3.2</span> linear stability analysis of fixed points</h3>
<p>We now turn to the question of stability of fixed points. As mentioned above, the definition of stability in multiple dimensions is identical to that is one dimension.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Definition
</div>
</div>
<div class="callout-body-container callout-body">
<p>A fixed point <span class="math inline">\(\vec x^*\)</span> of a dynamical system is <em>stable</em> if there exists a neighborhood of the fixed point (open set containing <span class="math inline">\(\vec x^*\)</span>) such that any trajectory with initial value in that neighborhood approaches the fixed point for all time.</p>
</div>
</div>
<p>To analyze the behavior of the ODE in the vicinity of the fixed point, we use the power of partial deriviatives, which are defined as follows:</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Definition
</div>
</div>
<div class="callout-body-container callout-body">
<p>For a multivariable function, e.g.&nbsp;<span class="math inline">\(f(x,y)\)</span> a <em>partial derivative</em> <span class="math inline">\(\frac{\partial f}{\partial x}\)</span> is the derivative of the function calculated while treating the other variables (e.g.&nbsp;<span class="math inline">\(y\)</span>) constant. The partial derivative can then be evaluated at any point <span class="math inline">\((x_0,y_0)\)</span> to obtain the rate of change of the function in the <span class="math inline">\(x\)</span> direction at that point.</p>
</div>
</div>
<p><strong>Example:</strong> For <span class="math inline">\(f(x,y) = 4x^3y - 5y^2\)</span> the partial derivatives are:</p>
<ul>
<li><p><span class="math inline">\(\frac{\partial f}{\partial x} = 12x^2y\)</span></p></li>
<li><p><span class="math inline">\(\frac{\partial f}{\partial y} = 4x^3 - 10y\)</span></p></li>
<li><p>Evaluated at the point <span class="math inline">\((x,y) = (1,2)\)</span> the partials are <span class="math inline">\(\frac{\partial f}{\partial x}(1,2) = 24\)</span> and <span class="math inline">\(\frac{\partial f}{\partial y} (1,2) = - 16\)</span></p></li>
</ul>
<p>The partial derivatives of a nonlinear function evaluated at a point allow us to approximate the behavior of the function using only linear terms. This is analogous to the linear Taylor approximation of a function of one variable, which approximates a nonlinear function with its tangent line. Specifically, for a function <span class="math inline">\(f(x,y)\)</span> which is zero at a particular point <span class="math inline">\((x^*, y^*)\)</span> - that is it, it’s a fixed point - the function can be approximated like this:</p>
<p><span class="math display">\[ f(x^*+u,y^*+v) = u\frac{\partial f}{\partial x} + v\frac{\partial f}{\partial y} + O((u,v)^2)\]</span></p>
<p>The new variables <span class="math inline">\(u\)</span> and <span class="math inline">\(v\)</span> represent the deviations from the fixed point in the <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> direction, respectively and the <span class="math inline">\(O((u,v)^2)\)</span> term represents the higher-order terms that are neglected by using only the linear terms. Since in the vicinity of the fixed point <span class="math inline">\(u\)</span> and <span class="math inline">\(v\)</span> are very small, raising them to higher powers produces very small numbers that can be neglected (although sometimes they must be considered, when linear stability analysis is inconclusive).</p>
<p>Note that these partial derivatives are the directions of flow <strong>at a particular fixed point</strong>, thus they have to calculated separately for each fixed point <span class="math inline">\((x^*,y^*)\)</span>. This produces a linear approximation in terms of the small increments <span class="math inline">\(u\)</span> and <span class="math inline">\(v\)</span>, and the partial derivatives play the role of constants, the local rates of change in <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> directions.</p>
<p>Let us focus on two-dimensional systems, for specificity. We can now approximate the functions <span class="math inline">\(f_1(x,y)\)</span> and <span class="math inline">\(f_2(x,y)\)</span> in the vicinity of a fixed point <span class="math inline">\((x^*, y^*)\)</span> using their partial derivatives as above. We can express the two variables near the fixed point as <span class="math inline">\(x = x^* + u\)</span> and <span class="math inline">\(y = y^*+v\)</span> and therefore obtain a local linear approximation for the system of two ODEs:</p>
<p><span class="math display">\[
\begin{aligned}
\dot u &amp;=&amp; u\frac{\partial f_1}{\partial x} (x^*,y^*) + v \frac{\partial f_1}{\partial y} (x^*,y^*) \\
\dot v &amp;=&amp; u\frac{\partial f_2}{\partial x} (x^*, y^*) + v\frac{\partial f_2}{\partial y} (x^*, y^*)
\end{aligned}
\]</span></p>
<p>What this achieves is an approximation of nonlinear differential equations by a set of linear differential equations, with the dependent variables expressed in terms of deviations from the fixed point. We now have a linear dynamical system, which can be written in matrix form:</p>
<p><span class="math display">\[ \left( \begin{array}{c} \dot u \\ \dot v \end{array} \right) = J \left( \begin{array}{c} u \\ v \end{array} \right) \]</span></p>
<p>The matrix <span class="math inline">\(J\)</span> is made up of partial derivatives of the two functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> evaluated at some particular point <span class="math inline">\((x,y)\)</span>, and it has a special name:</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Definition
</div>
</div>
<div class="callout-body-container callout-body">
<p>Let <span class="math inline">\((f_1(x,y), f_2(x,y)): \Re^2 \to \Re^2\)</span> (a function that takes in a two dimensional vector, and returns a two dimensional vector) be differentiable with to both variables <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>. Then its <em>Jacobian</em> matrix is defined as the matrix of first partial derivatives as follows:</p>
<p><span class="math display">\[ J(x,y) =  \left( \begin{array}{cc} \frac{\partial f_1}{\partial x}\vert_{(x,y)} &amp; \frac{\partial f_1}{\partial y}\vert_{(x,y)} \\
\frac{\partial f_2}{\partial x}\vert_{(x,y)} &amp; \frac{\partial f_2}{\partial y}\vert_{(x,y)} \end{array} \right) \]</span></p>
</div>
</div>
<p>The Jacobian matrix, evaluated at a fixed point, defines a linear dynamical system which approximates the original nonlinear dynamical system, in the vicinity of the fixed point. Thus, we can now use the tools from linear dynamical systems to determine the stability of a given fixed point. Much as the stability of a fixed point of a one-dimensional ODE was determined by the value of the derivative of the defining function at the fixed point, in higher dimensions the stability is determined by the eigenvalues of the Jacobian matrix at the fixed point.</p>
<p>To summarize, here is the outline for the steps for finding and analyzing the stability of fixed points of two-dimensional dynamical systems:</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Outline for analyzing fixed points of 2-variable ODEs
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>find the fixed points, as two dimensional vectors <span class="math inline">\((x^*, y^*)\)</span></p></li>
<li><p>find the expression for the Jacobian matrix of the ODE <span class="math inline">\(J(x,y)\)</span></p></li>
<li><p>plug in the values of the fixed points to find the local linearizations around each fixed point <span class="math inline">\(J(x^*, y^*)\)</span></p></li>
<li><p>find the eigenvalues of each Jacobian matrix and classify the local dynamics</p></li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Example: rabbits and sheep, continued
</div>
</div>
<div class="callout-body-container callout-body">
<p>Let us write down the linear approximation (first terms of the Taylor series) for the two functions defining the differential equation in the ecological competition model from equation <span class="math inline">\(\ref{eq:rs_competition}\)</span>, with specific parameters that we chose above.</p>
<p><span class="math display">\[
\begin{aligned}
\dot u &amp;=&amp;  (2 -2s - r)u + -sv\\
\dot v &amp;=&amp;  (3 -r - 2s)v -2ru
\end{aligned}
\]</span></p>
<p>You see that we have turned the nonlinear ODE into a linear system with variables <span class="math inline">\(u\)</span> and <span class="math inline">\(v\)</span>, defined by the Jacobian matrix evaluated at a point <span class="math inline">\((r,s)\)</span>:</p>
<p><span class="math display">\[\left(\begin{array}{c}  \dot u \\ \dot v \end{array}\right)  = \left(\begin{array}{cc}2-2s-r &amp; -s\\-2r &amp; 3-2r-2s\end{array}\right)\left(\begin{array}{c}  u \\  v \end{array}\right) \]</span></p>
<p>In practice, one can typically proceed directly to calculating the Jacobian by finding the partial derivatives and putting them in the right places. Let me emphasize that the linearization only describes the behavior of the system near a particular fixed point. For each fixed point, the linear equation is different. In order to analyze stability of each of the fixed points, we need to plug in the four values of the fixed points individually:</p>
<ul>
<li><span class="math inline">\(r=0,s=0\)</span>. The matrix is</li>
</ul>
<p><span class="math display">\[\left(\begin{array}{cc}2&amp; 0\\ 0 &amp; 3\end{array}\right)\]</span></p>
<p>and clearly has eigenvalues <span class="math inline">\(\lambda=2,3\)</span> with the corresponding eigenvectors on the two axes (1,0) and (0,1). This is an unstable node, with exponential growth away from it.</p>
<ul>
<li><span class="math inline">\(r=0, s=2\)</span>. The matrix is</li>
</ul>
<p><span class="math display">\[ \left(\begin{array}{cc}-2&amp; -2\\ 0 &amp; -1\end{array}\right) \]</span></p>
<p>with eigenvalues <span class="math inline">\(\lambda=-1,-2\)</span> with the corresponding eigenvectors (-2,1) and (1,0). This is a stable node (exponential decay toward the fixed point).</p>
<ul>
<li><span class="math inline">\(r=3, s=0\)</span>. The matrix is</li>
</ul>
<p><span class="math display">\[ \left(\begin{array}{cc}-1 &amp; 0\\ -6&amp; -3\end{array}\right) \]</span></p>
<p>with eigenvalues <span class="math inline">\(\lambda=-1,-6\)</span> with the corresponding eigenvectors (-1,3) and (0,1). This is a stable node (exponential decay toward the fixed point).</p>
<ul>
<li><span class="math inline">\(r=1, s=1\)</span>. The matrix is</li>
</ul>
<p><span class="math display">\[ \left(\begin{array}{cc}-1 &amp; -1\\ -2&amp; -1\end{array}\right) \]</span></p>
<p>with eigenvalues <span class="math inline">\(\lambda=-1\pm \sqrt{2}\)</span> with the eigenvectors (1, <span class="math inline">\(-\sqrt 2\)</span>) for the positive <span class="math inline">\(\lambda\)</span> and (1, <span class="math inline">\(\sqrt 2\)</span>) for the negative one. This is a saddle point, with one stable direction and one unstable.</p>
</div>
</div>
<p>The linear stability analysis we employed yielded only local information around each individual fixed point. We now know that starting with a very small population of rabbits and sheep, neither population will approach extinction, and that starting close to the carrying capacity for one population, and close to zero for the other, the solution will approach those two fixed points. The saddle point at the coexistence equilibrium appears more complex, but for practical purposes it is an unstable fixed point, and almost any solution near the coexistence equilibrium (but not exactly at <span class="math inline">\(s=1, r=1\)</span>) will deviate away from it. However, this analysis gives no information for what happens to the solutions once they are away from the fixed points. In the next section we will demonstrate how to describe the global flow in the phase plane.</p>
</section>
</section>
<section id="computational-analysis-of-jacobian-matrices" class="level2" data-number="16.4">
<h2 data-number="16.4" class="anchored" data-anchor-id="computational-analysis-of-jacobian-matrices"><span class="header-section-number">16.4</span> Computational analysis of Jacobian matrices</h2>
<p>In practice scientists usually employ computational tools to find the eigenvalues of Jacobian matrices of dynamical systems. The procedure is identical for a two-dimensional or an <span class="math inline">\(N\)</span>-dimensional differential equation, with the important difference that it is impractical to diagonalize matrices larger than 2 by 2 by hand. One can use any number of computational algorithms for finding eigenvalues, e.g.&nbsp;QR method . We will leave out the discussion of these algorithms, instead rely on the reader having access to an implementation of such algorithms, e.g in Python.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Outline for classification of fixed points
</div>
</div>
<div class="callout-body-container callout-body">
<p>Suppose that we have a two variable ODE and we have calculated its Jacobian matrix in general form.</p>
<ul>
<li>define the Jacobian function <span class="math inline">\(Jac(x,y)\)</span> which takes in two scalars <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> and returns the Jacobian matrix at that point</li>
<li>obtain a list of <span class="math inline">\(N\)</span> fixed points in two arrays <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span></li>
<li>for loop through all <span class="math inline">\(N\)</span> fixed points
<ul>
<li>obtain the Jacobian by calling <span class="math inline">\(Jac(x[i],y[i])\)</span></li>
<li>calculated its eigenvalues <span class="math inline">\(v[0]\)</span> and <span class="math inline">\(v[1]\)</span> (by calling an eigenvalue function)</li>
<li>if <span class="math inline">\(Re(v[0]) &gt; 0\)</span> and <span class="math inline">\(Re(v[1]) &gt; 0\)</span>
<ul>
<li>if <span class="math inline">\(Im(v[0]) == 0\)</span>
<ul>
<li>print ‘unstable node’</li>
</ul></li>
<li>else
<ul>
<li>print ‘unstable spiral’</li>
</ul></li>
</ul></li>
<li>if <span class="math inline">\(Re(v[0]) &lt; 0\)</span> and <span class="math inline">\(Re(v[1]) &lt; 0\)</span>
<ul>
<li>if <span class="math inline">\(Im(v[0])) == 0\)</span>
<ul>
<li>print ‘stable node’</li>
</ul></li>
<li>else
<ul>
<li>print ‘stable spiral’</li>
</ul></li>
</ul></li>
<li>if <span class="math inline">\(Re(v[0])*Re(v[1]) &lt; 0\)</span>
<ul>
<li>print ‘saddle point’</li>
</ul></li>
<li>if <span class="math inline">\(Re(v[0])*Re(v[1])) == 0\)</span>
<ul>
<li>if <span class="math inline">\(Im(v[0]) \neq 0\)</span>
<ul>
<li>print ‘center point’</li>
</ul></li>
<li>else
<ul>
<li>print ‘line of fixed points’</li>
</ul></li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
</section>
<section id="application-sir-model" class="level2" data-number="16.5">
<h2 data-number="16.5" class="anchored" data-anchor-id="application-sir-model"><span class="header-section-number">16.5</span> Application: SIR model</h2>
<p>Mathematical epidemiology models the dynamics of infectious disease in human (or other) populations. In Chapter 3, we saw the simplest models divide the population into two groups: those not infected (a.k.a. susceptible <span class="math inline">\(S\)</span>) and infected (<span class="math inline">\(I\)</span>). Here we will add a third category: recovered individuals (a group which may include those who died from the disease). There are two dynamic processes: the susceptible become infected at some rate upon encountering an infected individual, and the infected can recover. These two processes are different: the rate of infection fundamentally depends on <strong>encounters between susceptible and infected individuals</strong>, and thus is modeled as a product of <span class="math inline">\(S\)</span> and <span class="math inline">\(I\)</span>, while the rate of recovery depends only on the infected individuals, and is thus is represented by a linear term proportional to <span class="math inline">\(I\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
S + I &amp; \xrightarrow{\beta}2 I \\
I &amp; \xrightarrow{\gamma} R
\end{aligned}
\]</span></p>
<p>This is known as the Kermack-McKendrick model , or SIR model of epidemics, and it can be described by the following system of equations:</p>
<p><span class="math display">\[
\begin{aligned}
\dot S &amp;=&amp;  - \beta IS\\
\dot  I &amp;=&amp; -\gamma I + \beta IS \\
\dot R &amp;=&amp; \gamma I
\end{aligned}
\]</span></p>
<p>Notice that, just like the simpler SIS model in Chapter 3, this system has a conserved quantity, the total number of individuals <span class="math inline">\(N\)</span>. This can be shown by adding all three equations together, to see that <span class="math inline">\(\dot S + \dot I + \dot R = 0\)</span>, and therefore the sum of the three categories of individuals <span class="math inline">\(N\)</span> is constant. This makes intuitive sense because all the dynamics in the model consists of transferring individuals from one category to another, but we are assuming no births or deaths, outside of those we rolled into the recovered category.</p>
<p>Since there is a conserved quantity, the three variables can be reduced to two, e.g.&nbsp;by expressing <span class="math inline">\(R = N - I - S\)</span>. Since <span class="math inline">\(R\)</span> has no effect on the dynamics of <span class="math inline">\(S\)</span> or <span class="math inline">\(I\)</span>, let us leave it out, and analyze the two-variable ODE:</p>
<p><span class="math display">\[
\begin{aligned}
\dot S &amp;=&amp; -\beta IS \\
\dot I &amp;=&amp; -\gamma I + \beta IS
\end{aligned}
\]</span></p>
<p>First, let us find its fixed points. There are two nullclines for <span class="math inline">\(S\)</span>: <span class="math inline">\(I = 0\)</span> and <span class="math inline">\(S=0\)</span>. Similarly, there are two nullclines for <span class="math inline">\(I\)</span>: <span class="math inline">\(I = 0\)</span> and <span class="math inline">\(S = \beta/\gamma\)</span>. Notice that the two directions have one nullcline in common <span class="math inline">\(I=0\)</span>. This means that the line <span class="math inline">\(I=0\)</span> (the <span class="math inline">\(S\)</span>-axis) is a line of fixed points! As strange as it may seem, it should make sense: when there are no infected individuals, there can be no epidemic. There are no other fixed points, since if <span class="math inline">\(I \neq 0\)</span>, the fixed points would have to lie on the intersection of <span class="math inline">\(S=0\)</span> and <span class="math inline">\(S=\beta/\gamma\)</span>, which does not exist as long as the parameters are positive numbers.</p>
<p>Now let’s find the Jacobian of the system:</p>
<p><span class="math display">\[
J(S,I) = \left( \begin{array}{cc} -\beta I &amp; -\beta S \\ \beta I &amp; -\gamma + \beta S \end{array} \right)
\]</span></p>
<p>On the line of fixed points, <span class="math inline">\(I=0\)</span>, the Jacobian becomes:</p>
<p><span class="math display">\[
J = \left( \begin{array}{cc} 0 &amp; -\beta S \\ 0 &amp; -\gamma + \beta S \end{array} \right)
\]</span></p>
<p>This matrix is obviously singular, and has a zero eigenvalue with eigenvector <span class="math inline">\((1,0)\)</span>. This means that the flow on the <span class="math inline">\(S\)</span>-axis (provided it is horizontal) is strictly vertical. The other eigenvalue is <span class="math inline">\(-\gamma + \beta S\)</span>, with eigenvector <span class="math inline">\((0,1)\)</span>. This eigenvalue changes with <span class="math inline">\(S\)</span>, or position on the <span class="math inline">\(S\)</span>-axis. For <span class="math inline">\(S &gt; \gamma/\beta\)</span>, the eigenvalue is positive, while for <span class="math inline">\(S &lt; \gamma/\beta\)</span>, the eigenvalue is negative. Thus, we can predict stability of the infection-free equilibrium based on the size of <span class="math inline">\(S\)</span> relative to the threshold <span class="math inline">\(\gamma/\beta\)</span>.</p>
<p>We can now predict the local dynamics of an epidemic, starting with a small number of infected individuals <span class="math inline">\(I_0\)</span>. Further, let us assume that initially there are no recovered individuals, therefore <span class="math inline">\(N = I_0 + S_0 \approx S_0\)</span>. If <span class="math inline">\(N \beta /\gamma &gt; 1\)</span>, the number of infected individuals with increase, because the eigenvalue is positive and the flow takes the solution away from <span class="math inline">\(I=0\)</span>, and the infection will spread. If <span class="math inline">\(N \beta / \gamma &lt; 1\)</span>, the number of infected individuals will decrease, and the epidemic will die out. <span class="math inline">\(N \beta/ \gamma\)</span>, as in the SIS model, is called the disease reproductive ratio (and often denoted <span class="math inline">\(R_0\)</span>, in what may be considered notational abuse, since it has nothing to do with the number of recovered individuals). Notice that in both situations, the infection will spread beyond the initially infected individuals. The difference between the two scenarios is that in the first one, the number of infected individuals at a given time increases, while in the second one the number of infected at a given time decreases. However, in both cases, the number of people infected over the course of the epidemic is greater than the initial number <span class="math inline">\(I_0\)</span>.</p>
<p>As noted before, the local stability analysis does not describe the behavior away from the line of fixed points, but we have drawn some conclusions about the global dynamics of epidemics, based on the features of the flow in the phase plane. The total number of individuals is fixed, and all the infected individuals eventually recover, with no-reinfection possible. Therefore, no epidemic can persist, unlike in the SIS model, in which reinfection was possible. In fact, all solution trajectories eventually approach the line of fixed points at <span class="math inline">\(I=0\)</span>. If the reproductive ratio <span class="math inline">\(R_0 &lt; 1\)</span>, the solution heads for <span class="math inline">\(I=0\)</span> right away, but if <span class="math inline">\(R_0 &gt; 1\)</span>, the solution first travels away from <span class="math inline">\(I=0\)</span>, reaches its peak where it crosses the vertical nullcilne <span class="math inline">\(S=\beta/\gamma\)</span> (the direction of flow on that nullcline is strictly horizontal) and then turns toward <span class="math inline">\(I=0\)</span>, and eventually approaches an equilibrium of no infections, having burned itself out. The dynamics of the model for the two cases are shown in figure <span class="math inline">\(\ref{fig:sir_phase_plane}\)</span>. There are other interesting mathematical properties of the Kermack-McKendrick model, for a good summary of which see .</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/sir_r02.png" class="img-fluid figure-img"></p>
<figcaption>Dynamics in the phase plane of SIR models depends on the rep both have a line of fixed points on the <span class="math inline">\(x\)</span> axis. Shown here is the phase plane with <span class="math inline">\(R_0 = 2\)</span>, with infections that start to the right of the vertical nullcline spread before running out and approaching <span class="math inline">\(y=0\)</span>.</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/sir_r005.png" class="img-fluid figure-img"></p>
<figcaption>Dynamics in the phase plane of SIR models depends on the rep both have a line of fixed points on the <span class="math inline">\(x\)</span> axis. Shown here is the phase plane with <span class="math inline">\(R_0=0.5\)</span> and infections with any initial number of infecteds immediately decrease to zero.</figcaption>
</figure>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./ch15_fourier.html" class="pagination-link" aria-label="Fourier series: decomposition by frequency">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Fourier series: decomposition by frequency</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./ch17_nonlinear_oscillations.html" class="pagination-link" aria-label="Nonlinear oscillations in biology">
        <span class="nav-page-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Nonlinear oscillations in biology</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>