<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Mathematical Methods for Biology, Part 1 - 7&nbsp; Models with one variable in continuous time</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./ch8_numeric_ode.html" rel="next">
<link href="./ch6_matrix_mult.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Models with one variable in continuous time</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Mathematical Methods for Biology, Part 1</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch1_discrete1var.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">One variable in discrete time</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch2_plotting_python.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Plotting in Python</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch3_discrete_chaos.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Nonlinear discrete-time dynamic models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch4_cobweb_plots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Graphical analysis of difference equations</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch5_discrete_higher.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Discrete models of higher order</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch6_matrix_mult.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Matrix multiplication and population models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch7_1var_ode.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Models with one variable in continuous time</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch8_numeric_ode.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Numeric solutions of ODEs</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch9_linear_pplane.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Linear ODEs with two variables</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch10_phase_portraits.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Phase portraits in Python</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch11_lin_oscillations.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Forces and potentials in biological modeling</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch12_fourier.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Fourier series: decomposition by frequency</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch13_linearization.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Linearization of ODEs</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#ordinary-differential-equations" id="toc-ordinary-differential-equations" class="nav-link active" data-scroll-target="#ordinary-differential-equations"><span class="toc-section-number">7.1</span>  Ordinary differential equations</a>
  <ul class="collapse">
  <li><a href="#growth-proportional-to-population-size" id="toc-growth-proportional-to-population-size" class="nav-link" data-scroll-target="#growth-proportional-to-population-size"><span class="toc-section-number">7.1.1</span>  growth proportional to population size</a></li>
  <li><a href="#chemical-kinetics" id="toc-chemical-kinetics" class="nav-link" data-scroll-target="#chemical-kinetics"><span class="toc-section-number">7.1.2</span>  chemical kinetics</a></li>
  </ul></li>
  <li><a href="#analytic-solutions-of-linear-odes" id="toc-analytic-solutions-of-linear-odes" class="nav-link" data-scroll-target="#analytic-solutions-of-linear-odes"><span class="toc-section-number">7.2</span>  Analytic solutions of linear ODEs</a>
  <ul class="collapse">
  <li><a href="#concepts-of-odes" id="toc-concepts-of-odes" class="nav-link" data-scroll-target="#concepts-of-odes"><span class="toc-section-number">7.2.1</span>  concepts of ODEs</a></li>
  <li><a href="#solutions-via-separate-and-integrate" id="toc-solutions-via-separate-and-integrate" class="nav-link" data-scroll-target="#solutions-via-separate-and-integrate"><span class="toc-section-number">7.2.2</span>  solutions via separate-and-integrate</a></li>
  <li><a href="#solution-of-nonhomogeneous-odes" id="toc-solution-of-nonhomogeneous-odes" class="nav-link" data-scroll-target="#solution-of-nonhomogeneous-odes"><span class="toc-section-number">7.2.3</span>  solution of nonhomogeneous ODEs</a></li>
  <li><a href="#model-of-drug-concentration" id="toc-model-of-drug-concentration" class="nav-link" data-scroll-target="#model-of-drug-concentration"><span class="toc-section-number">7.2.4</span>  model of drug concentration</a></li>
  </ul></li>
  <li><a href="#membrane-as-electric-circuit" id="toc-membrane-as-electric-circuit" class="nav-link" data-scroll-target="#membrane-as-electric-circuit"><span class="toc-section-number">7.3</span>  Membrane as electric circuit</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Models with one variable in continuous time</span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<p>In the previous chapters we have considered discrete time models, in which time is measured in integers. This worked well to describe processes that happen in periodic cycles, like cell division or heart pumping. Many biological systems do not work this way. Change can happen continuously, that is, at any point in time. For instance, the concentration of a biological molecule in the cell changes gradually, as does the voltage across the cell membrane in a neuron.</p>
<p>The models for continuously changing variables require their own set of mathematical tools. Differential equations use derivatives to describe how a variable changes with time. There is a tremendous amount of knowledge accumulated by mathematicians, physicists and engineers for analyzing and solving differential equations. There are many classes of differential equations for which it is possible to find analytic solutions, often in the form of “special functions.” Differential equations courses for physicists and engineers are typically focused on learning about the variety of existing tools for solving a few types of differential equations. For the purposes of biological modeling, knowing how to solve a limited number of differential equations is of limited usefulness. We will instead focus on learning how to analyze the behavior of differential equations in general, without having to solve them on paper.</p>
<p>In this chapter we will analyze linear differential equations, which have mathematical solutions, and learn about numerical methods for computing and plotting these solution. Specifically, you will learn to:</p>
<ul>
<li>build differential equations of population size</li>
<li>mathematically solve linear differential equations</li>
<li>put together a model of membrane potential</li>
<li>compute numeric solutions of these models</li>
<li>compute and analyze the error in numeric solutions</li>
</ul>
<section id="ordinary-differential-equations" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="ordinary-differential-equations"><span class="header-section-number">7.1</span> Ordinary differential equations</h2>
<p>We consider models with <em>continuous time</em>, for which it does not make sense to break time up into equal intervals. Instead of equations describing the increments in the dependent variable from one time step to the next, we will see equations with the instantaneous rate of the change (derivative) of the variable. For discrete time models, one formulation of the general difference equation was this:</p>
<p><span class="math display">\[
x_{t+1} - x_t = g(x)
\]</span></p>
<p><span class="math inline">\(g(x)\)</span> is a function of the dependent variable, which may be as simple as 0 or <span class="math inline">\(ax\)</span>, or can be horribly nonlinear and complicated.</p>
<p>For difference equations, the time variable <span class="math inline">\(t\)</span> is measured in the number of time steps (<span class="math inline">\(\Delta t\)</span>), whether the time step is 20 minutes or 20 years. In continuous time models, we express <span class="math inline">\(t\)</span> in actual units of time, instead of counting time steps. Thus, what we wrote as <span class="math inline">\(t+1\)</span> for discrete time should be expressed as <span class="math inline">\(t+\Delta t\)</span> for continuous time. The left-hand-side of the equation above describes the change in the variable <span class="math inline">\(x\)</span> over one time step <span class="math inline">\(\Delta t\)</span>. We can write it as a Newton’s quotient, and then take the limit of the time step shrinking to 0:</p>
<p><span class="math display">\[
\lim_{\Delta t \rightarrow 0} \frac{x(t +\Delta t) - x(t)} {\Delta t} = \frac{d x} {dt}  = g(x)
\]</span></p>
<p>To take the limit of the time step going to 0 means that we allow the increments in time to be infinitesimally small, and therefore the time variable may be any real number. The equation above thus becomes a differential equation, because it involves a derivative of the dependent variable.</p>
<p>In general, an ordinary differential equation is defined as follows:</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Definition
</div>
</div>
<div class="callout-body-container callout-body">
<p>An ordinary differential equation is an equation that contains derivatives of the dependent variable (e.g.&nbsp;<span class="math inline">\(x\)</span>) with respect to an independent variable (e.g.&nbsp;<span class="math inline">\(t\)</span>).</p>
</div>
</div>
<p>For example:</p>
<p><span class="math display">\[
\frac{dx^2}{dt^2}+ 0.2 \frac{dx}{dt} - 25 = 0
\]</span></p>
<p>There are at least two good reasons to use differential equations for many applications. First, some events happen very frequently and non-periodically, so it is more reasonable to allow time to flow continuously instead of in steps. The second reason is mathematical: it turns out that dynamical systems with continuous time, described by differential equations, are better behaved than difference equations. This has to do with the essential “jumpiness” of difference equations. Even for simple nonlinear equations, the value of the variable after one time step can be far removed from its last value. This can lead to highly complicated solutions, as we saw in the logistic model in Chapter 1.</p>
<section id="growth-proportional-to-population-size" class="level3" data-number="7.1.1">
<h3 data-number="7.1.1" class="anchored" data-anchor-id="growth-proportional-to-population-size"><span class="header-section-number">7.1.1</span> growth proportional to population size</h3>
<p>We will now build up some of the most common differential equations models. First up, a simple population growth model with a constant growth rate. Suppose that in a population each individual reproduces with the average reproductive rate <span class="math inline">\(r\)</span>. This is reflected in the following differential equation:</p>
<p><span class="math display">\[
\frac{dx} {dt} = \dot x = r x
\]</span> (linear_ode)</p>
<p>This expression states that the rate of change of <span class="math inline">\(x\)</span>, which we take to be population size, is proportional to <span class="math inline">\(x\)</span> with multiplicative constant <span class="math inline">\(r\)</span>. We will frequenlty use the notation <span class="math inline">\(\dot x\)</span> for the time derivative of <span class="math inline">\(x\)</span> for aesthetic reasons.</p>
<p>First, we apply dimensional analysis to this model. The units of the derivative are population per time, as can be deduced from the Newton’s quotient definition. Thus, the units in the equation have the following relationship:</p>
<p><span class="math display">\[
\frac{[population]}{[time]} = [r] [population] = \frac{1}{[time]}[population]
\]</span></p>
<p>This shows that as in the discrete time models, the dimension of the population growth rate <span class="math inline">\(r\)</span> is inverse time, or frequency. The difference with the discrete time population models lies in the time scope of the rate. In the case of the difference equation, <span class="math inline">\(r\)</span> is the rate of change per one time step of the model. In the differential equation, <span class="math inline">\(r\)</span> is the <em>instantaneous rate of population growth</em>. It is less intuitive than the growth rate per single reproductive cycle, just like the slope of a curve is less intuitive than the slope of a line. The population growth happens continuously, so the growth rate of <span class="math inline">\(r\)</span> individuals per year does not mean that if we start with one individual, there will be <span class="math inline">\(r\)</span> after one year. In order to make quantitative predictions, we need to find the solution of the equation, which we will see in the next section.</p>
</section>
<section id="chemical-kinetics" class="level3" data-number="7.1.2">
<h3 data-number="7.1.2" class="anchored" data-anchor-id="chemical-kinetics"><span class="header-section-number">7.1.2</span> chemical kinetics</h3>
<p>Reactions between molecules in cells occur continuously, driven by molecular collisions and physical forces. In order to model this complex behavior, it is generally assumed that reactions occur with a particular speed, known as the <em>kinetic rate</em>. A simple reaction of conversion from one type of molecule (<span class="math inline">\(A\)</span>) to another (<span class="math inline">\(B\)</span>) can be written as follows:</p>
<p><span class="math display">\[
A \rightarrow^k B
\]</span></p>
<p>In this equation the parameter <span class="math inline">\(k\)</span> is the kinetic rate, describing the speed of conversion of <span class="math inline">\(A\)</span> into <span class="math inline">\(B\)</span>, per concentration of <span class="math inline">\(A\)</span>.</p>
<p>Chemists and biochemists use differential equations to describe the change in molecular concentration during a reaction. These equations are known as the <em>laws of mass action</em>. For the reaction above, the concentration of molecule <span class="math inline">\(A\)</span> decreases continuously proportionally to itself, and the concentration of molecule <span class="math inline">\(B\)</span> increases continuously proportionally to the concentration of <span class="math inline">\(A\)</span>. This is expressed by the following two differential equations:</p>
<p><span class="math display">\[\begin{aligned}
\dot A &amp;=&amp; - k A \\
\dot B &amp;=&amp; kA
\end{aligned}
\]</span> (lin_chem_kin)</p>
<p>Several conclusions can be drawn by inspection of the equations. First, the dynamics depend only on the concentration of <span class="math inline">\(A\)</span>, so keeping track of the concentration of <span class="math inline">\(B\)</span> is superfluous. The second observation reinforces the first: the sum of the concentrations of <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> is constant. This is mathematically demonstrated by adding the two equations together to obtain the following:</p>
<p><span class="math display">\[
\dot A + \dot B = -kA + kA = 0
\]</span></p>
<p>One of the basic properties of the derivative is that the sum of derivatives is the same as the derivative of the sum:</p>
<p><span class="math display">\[
\dot A + \dot B = \frac{d(A+B)}{dt} = 0
\]</span></p>
<p>This means that the sum of the concentrations of <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> is a constant. This is a mathematical expression of the law of conservation in chemistry: molecules can change from one type to another, but they cannot appear or disappear in other ways. In this case, a single molecule of <span class="math inline">\(A\)</span> becomes a single molecule of <span class="math inline">\(B\)</span>, so it follows that the sum of the two has to remain the same. If the reaction were instead two molecules of <span class="math inline">\(A\)</span> converting to a molecule of <span class="math inline">\(B\)</span>, then the conserved quantity is <span class="math inline">\(2A + B\)</span>. The concept of conserved quantity is very useful for the analysis of differential equations. We will see in later chapters how it can help us find solutions, and explain the behavior of complex dynamical systems.</p>
</section>
</section>
<section id="analytic-solutions-of-linear-odes" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="analytic-solutions-of-linear-odes"><span class="header-section-number">7.2</span> Analytic solutions of linear ODEs</h2>
<section id="concepts-of-odes" class="level3" data-number="7.2.1">
<h3 data-number="7.2.1" class="anchored" data-anchor-id="concepts-of-odes"><span class="header-section-number">7.2.1</span> concepts of ODEs</h3>
<p>Let us define some terminology for ODEs:</p>
<p>:::{.callout-note}<br>
## Definition The <em>order</em> of an ODE is the highest order of the derivative of the dependent variable <span class="math inline">\(x\)</span>. :::</p>
<p>For example, <span class="math inline">\(\dot x = rx\)</span> is a first order ODE, while <span class="math inline">\(\ddot x = - mx\)</span> is a second order ODE (double dot stands for second derivative). In this chapter we will restrict ourselves to first-order ODEs that can be generally written as follows:</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Definition
</div>
</div>
<div class="callout-body-container callout-body">
<p>A <em>first-order</em> ODE is one where the derivative <span class="math inline">\(dx/dt\)</span> is equal to a <em>defining function</em> <span class="math inline">\(f(x,t)\)</span>, like this:</p>
<p><span class="math display">\[
\frac{dx} {dt} = \dot x = f(x,t)
\]</span> (first-order-ode)</p>
</div>
</div>
<p>Note that the function may depend on both the dependent variable <span class="math inline">\(x\)</span> and the independent variable <span class="math inline">\(t\)</span>. This leads to the next definition:</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Definition
</div>
</div>
<div class="callout-body-container callout-body">
<p>An ODE is <em>autonomous</em> if the defining function <span class="math inline">\(f\)</span> depends only on the dependent variable <span class="math inline">\(x\)</span> and not on <span class="math inline">\(t\)</span>.</p>
</div>
</div>
<p>For example, <span class="math inline">\(\dot x = 5x -4\)</span> is an autonomous equation, while <span class="math inline">\(\dot x = 5t\)</span> is not. An autonomous ODE is also said to have <em>constant coefficients</em> (e.g.&nbsp;5 and -4 in the first equation above).</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Definition
</div>
</div>
<div class="callout-body-container callout-body">
<p>An ODE is <em>homogeneous</em> if every term in the defining function involves either the dependent variable <span class="math inline">\(x\)</span> or its derivative.</p>
</div>
</div>
<p>For example, <span class="math inline">\(\dot x = x^2 + \sin(x)\)</span> is homogeneous, while <span class="math inline">\(\dot x = -x + 5t\)</span> is not. Most simple biological models that we will encounter in the next two chapters are autonomous, homogeneous ODEs. However, inhomogeneous equations are important in many applications, and we will encounter them at the end of the present section.</p>
</section>
<section id="solutions-via-separate-and-integrate" class="level3" data-number="7.2.2">
<h3 data-number="7.2.2" class="anchored" data-anchor-id="solutions-via-separate-and-integrate"><span class="header-section-number">7.2.2</span> solutions via separate-and-integrate</h3>
<p>In contrast with algebraic equations, we cannot simply isolate <span class="math inline">\(x\)</span> on one side of the equal sign and find the solutions as one, or a few numbers. Instead, solving ordinary differential equations is very tricky, and no general strategy for solving an arbitrary ODE exists. Moreover, a solution for an ODE is not guaranteed to exist at all, or not for all values of <span class="math inline">\(t\)</span>. We will discuss some of the difficulties later, but let us start with equations that we can solve.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Definition
</div>
</div>
<div class="callout-body-container callout-body">
<p>The <em>analytic (or exact) solution</em> of an ordinary differential equation is a function of the independent variable that satisfies the equation. If no initial value is given, then the <em>general solution</em> function will contain an uknown <em>integration constant</em>. If an initial value is specified, the integration constant can be found to obtain a <em>specific solution</em>.</p>
</div>
</div>
<p>This means that the solution function obeys the relationship between the derivative and the defining function that is specified by the ODE. To verify that a function is a solution of a given ODE, take its derivative and check whether it matches the other side of the equation.</p>
<p><strong>Example</strong>. The function <span class="math inline">\(x(t) = 3t^2 +C\)</span> is a general solution of the ODE <span class="math inline">\(\dot x = 6t\)</span>, which can be verified by taking the derivative: <span class="math inline">\(\dot x (t) = 6t\)</span>. Since this matches the right-hand side of the ODE, the solution is valid.</p>
<p><strong>Example</strong>. The function <span class="math inline">\(x(t) = Ce^{5t}\)</span> is a general solution of the ODE <span class="math inline">\(\dot x = 5x\)</span>. This can be verified by the taking the derivative: <span class="math inline">\(\dot x = 5C e^{5t}\)</span> and comparing it with the right-hand side of the ODE: <span class="math inline">\(5x = 5 Ce^{5t}\)</span>. Since the two sides of the equation agree, the solution is valid.</p>
<p>In contrast with algebraic equations, we cannot simply isolate <span class="math inline">\(x\)</span> on one side of the equal sign and find the solutions as one, or a few numbers. Instead, solving ordinary differential equations is very tricky, and no general strategy for solving an arbitrary ODE exists. Moreover, a solution for an ODE is not guaranteed to exist at all, or not for all values of <span class="math inline">\(t\)</span>. We will discuss some of the difficulties later, but let us start with equations that we can solve.</p>
<p>The most obvious strategy for solving an ODE is integration. Since a differential equation contains derivatives, integrating it can remove the derivative. In the case of the general first order equation, we can integrate both sides to obtain the following:</p>
<p><span class="math display">\[
\int \frac{dx}{dt} dt = \int f(x,t) dt \Rightarrow x(t) + C = \int f(x,t) dt
\]</span></p>
<p>The constant of integration <span class="math inline">\(C\)</span> appears as in the standard antiderivative definition. It can be specified by an initial condition for the solution <span class="math inline">\(x(t)\)</span>. Unless the function <span class="math inline">\(f(x,t)\)</span> depends only on <span class="math inline">\(t\)</span>, it is not possible to evaluate the integral above. Instead, various tricks are used to find the analytic solution. The simplest method of analytical solution of a first-order ODEs, which I call <em>separate-and-integrate</em> consists of the following steps:</p>
<div class="callout-tip callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Outline of separate-and-integrate method
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><p>use algebra to place the dependent and independent variables on different sides of the equations, including the differentials (e.g.&nbsp;<span class="math inline">\(dx\)</span> and <span class="math inline">\(dt\)</span>)</p></li>
<li><p>integrate both sides with respect to the different variables, don’t forget the integration constant</p></li>
<li><p>solve for the dependent variable (e.g.&nbsp;<span class="math inline">\(x\)</span>) to find the <em>general solution</em></p></li>
<li><p>plug in <span class="math inline">\(t=0\)</span> and use the initial value <span class="math inline">\(x(0)\)</span> to solve for the integration constant and find the <em>specific solution</em></p></li>
</ol>
</div>
</div>
<p><strong>Example.</strong> Consider a very simple differential equation: <span class="math inline">\(\dot x = a\)</span>, where <span class="math inline">\(\dot x\)</span> stands for the time derivative of the dependent variable <span class="math inline">\(x\)</span>, and <span class="math inline">\(a\)</span> is a constant. It can be solved by integration:</p>
<p><span class="math display">\[
\int \frac{dx}{dt} dt  = \int a dt  \Rightarrow x(t) + C = at
\]</span></p>
<p>This solution contains an undetermined integration constant; if an initial condition is specified, we can determine the complete solution. Generally speaking, if the initial condition is <span class="math inline">\(x(0) = x_0\)</span>, we need to solve an algebraic equation to determine <span class="math inline">\(C\)</span>: <span class="math inline">\(x_0 = a \times 0 - C\)</span>, which results in <span class="math inline">\(C = -x_0\)</span>. The complete solution is then <span class="math inline">\(x(t) = at + x_0\)</span>. To make the example more specific, if <span class="math inline">\(a = 5\)</span> and the initial condition is <span class="math inline">\(x(0) = -3\)</span>, the solution is <span class="math inline">\(x(t) = 5t -3\)</span>.</p>
<p><strong>Example</strong>. Let us solve the linear population growth model in equation {eq}<code>linear_ode</code>: <span class="math inline">\(\dot x = rx\)</span>. The equation can be solved by first dividing both sides by <span class="math inline">\(x\)</span> and then integrating:</p>
<p><span class="math display">\[
\int \frac{1}{x} \frac{d x}{dt}  dt = \int \frac{dx}{x} = \int r dt \Longrightarrow \log |x| = rt + C  \Longrightarrow  x =  e^{rt+C} = Ae^{rt}
\]</span></p>
<p>We used basic algebra to solve for <span class="math inline">\(x\)</span>, exponentiating both sides to get rid of the logarithm on the left side. As a result, the additive constant <span class="math inline">\(C\)</span> gave rise to the multiplicative constant <span class="math inline">\(A=e^C\)</span>. Once again, the solution contains a constant which can be determined by specifying an initial condition <span class="math inline">\(x(0) = x_0\)</span>. In this case, the relationship is quite straightforward: <span class="math inline">\(x(0) = A e^0 = A\)</span>. Thus, the complete solution for equation {eq}<code>linear_ode</code> is:</p>
<p><span class="math display">\[
x(t) = x_0e^{rt}
\]</span></p>
<p>As in the case of the discrete-time models, population growth with a constant birth rate has exponential form. Once again, please pause and consider this fact, because the exponential solution of linear equations is one of the most basic and powerful tools in applied mathematics. Immediately, it allows us to classify the behavior of linear ODE into three categories:</p>
<div class="callout-tip callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Classification of solutions of linear ODEs
</div>
</div>
<div class="callout-body-container callout-body">
<p>For the solution of the ODE <span class="math inline">\(\dot x = rx\)</span></p>
<ul>
<li><p><span class="math inline">\(r &gt;0\)</span>: <span class="math inline">\(x(t)\)</span> grows without bound</p></li>
<li><p><span class="math inline">\(r &lt;0\)</span>: <span class="math inline">\(x(t)\)</span> decays to 0</p></li>
<li><p><span class="math inline">\(r = 0\)</span>: <span class="math inline">\(x(t)\)</span> remains constant at the initial value</p></li>
</ul>
</div>
</div>
<p>The rate <span class="math inline">\(r\)</span> being positive means that the birth rate is greater than the death rate in the population, leading to unlimited population growth. If the death rate is greater, the population will decline and die out. If the two are exactly matched, the population size will remain unchanged.</p>
<p><strong>Example.</strong> The solution for the biochemical kinetic model in equation {eq}<code>lin_chem_kin</code> is identical except for the sign: <span class="math inline">\(A(t) = A_0 e^{-kt}\)</span>. When the reaction rate <span class="math inline">\(k\)</span> is positive, as it is in chemistry, the concentration of <span class="math inline">\(A\)</span> decays to 0 over time. This is consistent with the arrow diagram of this model, since there is no back reaction, and the only chemical process is conversion of <span class="math inline">\(A\)</span> into <span class="math inline">\(B\)</span>. The concentration of <span class="math inline">\(B\)</span> can be found by using the fact that the total concentration of molecules in the model is conserved. Let us call it <span class="math inline">\(C\)</span>. Then <span class="math inline">\(B(t) = C - A(t) = C- A_0e^{-kt}\)</span>. The concentration of <span class="math inline">\(B\)</span> increases to the asymptotic limit of <span class="math inline">\(C\)</span>, meaning that all molecules of <span class="math inline">\(A\)</span> have been converted to <span class="math inline">\(B\)</span>.</p>
</section>
<section id="solution-of-nonhomogeneous-odes" class="level3" data-number="7.2.3">
<h3 data-number="7.2.3" class="anchored" data-anchor-id="solution-of-nonhomogeneous-odes"><span class="header-section-number">7.2.3</span> solution of nonhomogeneous ODEs</h3>
<p>ODEs that contain at least one term without the dependent variable are a bit more complicated. If the defining function is <span class="math inline">\(f(x,t)\)</span> is <em>linear</em> in the dependent variable <span class="math inline">\(x\)</span>, they can be solved on paper using the same separate-and-integrate method, modified slightly to handle the constant term. Here are the steps to solve the generic linear ODE with a constant term <span class="math inline">\(\dot x = ax +b\)</span>:</p>
<div class="callout-tip callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p># solution of linear autonomous ODEs</p>
<p>Consider an ODE of the form <span class="math inline">\(\dot x = ax +b\)</span></p>
<ol type="1">
<li><p>separate the dependent and independent variables on different sides of the equations, by dividing both sides by the right hand side <span class="math inline">\(ax+b\)</span>, and multiplying both sides by the differential <span class="math inline">\(dt\)</span></p></li>
<li><p>integrate both sides with respect to the different variables, don’t forget the integration constant!</p></li>
<li><p>solve for the dependent variable (e.g.&nbsp;<span class="math inline">\(x\)</span>) to find the <em>general solution</em></p></li>
<li><p>plug in <span class="math inline">\(t=0\)</span> and use the initial value <span class="math inline">\(x(0)\)</span> to solve for the integration constant and find the <em>specific solution</em></p></li>
</ol>
</div>
</div>
<p><strong>Example:</strong> Let us solve the following ODE model using separate and integrate with the given initial value:</p>
<p><span class="math display">\[
\frac{dx}{dt} = 4x -100;  \; x(0) = 30
\]</span></p>
<ul>
<li>Separate the dependent and independent variables:</li>
</ul>
<p><span class="math display">\[
\frac{dx}{4x - 100} = dt
\]</span></p>
<ul>
<li>Integrate both sides:</li>
</ul>
<p><span class="math display">\[
\int \frac{dx}{4x -100} =  \int dt \Rightarrow \frac{1}{4} \int \frac{du}{u} = \frac{1}{4} \ln | 4x- 100 |  = t + C
\]</span></p>
<p>The integration used the substitution of the new variable <span class="math inline">\(u=4x -100\)</span>, with the concurrent substitution of <span class="math inline">\(dx = du/4\)</span>.</p>
<ul>
<li>Solve for the dependent variable:</li>
</ul>
<p><span class="math display">\[
\ln | 4x- 100 |  = 4t + C \Rightarrow 4x-100 = e^{4t} B  \Rightarrow x = 25  + Be^{4t}
\]</span></p>
<p>Here the first step was to multiply both sides by 4, and the second to use both sides as the exponents of <span class="math inline">\(e\)</span>, removing the natural log from the left hand side, and finally simple algebra to solve for <span class="math inline">\(x\)</span> as a function of <span class="math inline">\(t\)</span>.</p>
<ul>
<li>Solve for the integration constant:</li>
</ul>
<p><span class="math display">\[
x(0) = 25  + B = 30 \Rightarrow B = 5
\]</span></p>
<p>Here the exponential “disappeared” because <span class="math inline">\(e^0=1\)</span>. Therefore, the specific solution of the ODE with the given initial value is</p>
<p><span class="math display">\[
x(t) =  25  + 5e^{4t}
\]</span></p>
<p>At this point, you might have noticed something about solutions of linear ODEs: they always involve an exponential term, with time in the exponent. Knowing this, it is possible to bypass the whole process of separate-and-integrate by using the following short-cut.</p>
<div class="callout-tip callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Important Fact
</div>
</div>
<div class="callout-body-container callout-body">
<p>Any linear ODE of the form <span class="math inline">\(\dot x= ax +b\)</span> has an analytic solution of the form:</p>
<p><span class="math display">\[
x(t) = Ce^{at} + D
\]</span></p>
<p>with <span class="math inline">\(D = -b/a\)</span> and <span class="math inline">\(C\)</span> determined by the initial value <span class="math inline">\(x(0)\)</span>.</p>
</div>
</div>
<p>This can be verified by plugging the solution back into the ODE to see if it satisfies the equation. First, take the derivative of the solution to get the left-hand side of the ODE: <span class="math inline">\(\frac{dx}{dt} = Ca e^{at}\)</span>; then plug in <span class="math inline">\(x(t)\)</span> into the right hand side of the ODE: $ aCe^{at} + aD +b$. Setting the two sides equal, we get: <span class="math inline">\(Ca e^{at} = aCe^{at} + aD +b\)</span>, which is satisfied if <span class="math inline">\(aD + b = 0\)</span>, which means <span class="math inline">\(D= -b/a\)</span>. This is consistent with the example above, the additive constant in the solution was 25, which is <span class="math inline">\(-b/a= -(-100)/4 = 25\)</span>.</p>
<p>Thus, if you want to solve a linear no ODE <span class="math inline">\(\dot x= ax +b\)</span> , you can bypass the separate-and-integrate process, because the general solution always has the form in equation {eq}<code>sol-nonhom</code>. So the upshot is that all linear ODEs have solutions which are exponential in time with exponential constant coming from the slope constant <span class="math inline">\(a\)</span> in the ODE. The dynamics of the solution are determined by the sign of the constant <span class="math inline">\(a\)</span>: if <span class="math inline">\(a&gt;0\)</span>, the solution grows (or declines) without bound; and if <span class="math inline">\(a&lt;0\)</span>, the solution approaches an asymptote at <span class="math inline">\(-b/a\)</span> (from above or below, depending on the initial value).</p>
</section>
<section id="model-of-drug-concentration" class="level3" data-number="7.2.4">
<h3 data-number="7.2.4" class="anchored" data-anchor-id="model-of-drug-concentration"><span class="header-section-number">7.2.4</span> model of drug concentration</h3>
<p>Describing and predicting the dynamics of drug concentration in the body is the goal of <em>pharmacokinetics</em>. Any drug that humans take goes through several stages: first it is administered (put into the body), then absorbed, metabolized (transformed), and excreted (removed from the body) <span class="citation" data-cites="rosenbaum_basic_2011">(<a href="references.html#ref-rosenbaum_basic_2011" role="doc-biblioref"><strong>rosenbaum_basic_2011?</strong></a>)</span>. Almost any drug has a dose at which it has a toxic effect, and most can kill a human if the dose is high enough. Drugs which are used for medical purposes have a <em>therapeutic range</em>, which lies between the lowest possible concentration (usually measured in the blood plasma) that achieves the therapeutic effect and the concentration which is toxic. One of the basic questions that medical practitioners need to know is how much and how frequently to administer a drug to maintain drug concentration in the therapeutic range.</p>
<p>The concentration of a drug is a dynamic variable which depends on the rates of several processes, most directly on the rate of administration and the rate of metabolism. Drugs can be administered through various means (e.g.&nbsp;orally or intravenously) which influences their rate of absorption and thus how the concentration increases. Once in the blood plasma, drugs are metabolized primarily by enzymes in the liver, converting drug molecules into compounds that can be excreted through the kidneys or the large intestine. The process of *metabolism proceeds at a rate that depends on both the concentration of the drug and on the enzyme that catalyzes the reaction. For some drugs the metabolic rate may be constant, or independent of the drug concentration, since the enzymes are already working at full capacity and can’t turn over any more reactions, for example alcohol is metabolized at a constant rate of about 1 drink per hours for most humans. {numref}<code>fig-alc-met</code> shows the time plots of the blood alcohol concentration for 4 males who ingested different amounts of alcohol, and the curves are essentially linear with the same slope after the peak. For other drugs, if the plasma concentration is low enough, the enzymes are not occupied all the time and increasing the drug concentration leads to an increase in the rate of metabolism. One can see this behavior in the metabolism of the anti-depressant drug bupropion in figure {numref}<code>fig-bupropion</code>, where the concentration curve shows a faster decay rate for higher concentration of the drug than for lower concentration. In the simplest case, the rate of metabolism is linear, or proportional to the concentration of the drug, with proportionality constant called the first-order metabolic rate.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/aa35graf.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Blood alcohol content after ingesting different numbers of drinks, from 4 in the top curve to 1 in the bottom (figure from the National Institute on Alcohol Abuse and Alcoholism in public domain)</figcaption><p></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/2000px-Bupropion_bioequivalency.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Blood concentration of bupropion for two different drugs in clinical trials (image by CMBJ based on FDA data under CC-BY 3.0 via Wikimedia Commons)</figcaption><p></p>
</figure>
</div>
<div class="callout-tip callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Example: ODE model of drug kinetics
</div>
</div>
<div class="callout-body-container callout-body">
<p>Let us build an ODE model for a simplified pharmacokinetics situation. Suppose that a drug is administered at a constant rate of <span class="math inline">\(M\)</span> (concentration units per time unit) and that it is metabolized at a rate proportional to its plasma concentration <span class="math inline">\(C\)</span> with metabolic rate constant <span class="math inline">\(k\)</span>. Then the ODE model of the concentration of the drug over time <span class="math inline">\(C(t)\)</span> is:</p>
<p><span class="math display">\[
\frac{dC}{dt} = M - kC
\]</span></p>
<p>The two rate constants <span class="math inline">\(M\)</span> and <span class="math inline">\(k\)</span> have different dimensions, which you should be able to determine yourself. The ODE can be solved using the separate-and-integrate method:</p>
<ul>
<li>Divide both sides by the right hand side <span class="math inline">\(M-kC\)</span>, and multiply both sides by the differential <span class="math inline">\(dt\)</span></li>
</ul>
<p><span class="math display">\[
\frac{dC}{M-kC} = dt
\]</span></p>
<ul>
<li>Integrate both sides with respect to the different variables, don’t forget the integration constant!</li>
</ul>
<p><span class="math display">\[
\int \frac{dC}{M-kC} = \int dt \Rightarrow  -\frac{1}{k} \log |M-kC| = t + A
\]</span></p>
<ul>
<li>Solve for the dependent variable <span class="math inline">\(C(t)\)</span></li>
</ul>
<p><span class="math display">\[
\exp(\log |M-kC| ) = -\exp(kt +A) \Rightarrow M - kC = B e^{-kt} \Rightarrow
\]</span></p>
<p><span class="math display">\[
C(t) = \frac{M}{k}- Be^{-kt}
\]</span></p>
<p>Notice that I changed the values of integration constants <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> during the derivation, which shouldn’t matter because they have not been determined yet.</p>
<ul>
<li>Plug in <span class="math inline">\(t=0\)</span> and use the initial value <span class="math inline">\(x(0)\)</span> to solve for the integration constant If we know the initial value <span class="math inline">\(C(0) = C_0\)</span>, then we can plug it in and get the following algebraic expression:</li>
</ul>
<p><span class="math display">\[
C_0 =  \frac{M}{k} - B \Rightarrow B = C_0 -  \frac{M}{k}
\]</span></p>
<p>Then the complete solution is:</p>
<p><span class="math display">\[
C(t) =  \frac{M}{k} - (C_0- \frac{M}{k})e^{-kt}
\]</span></p>
<p>The solution predicts that after a long time the plasma concentration will approach the value <span class="math inline">\(M/k\)</span>, since the exponential term decays to zero. Notice that mathematically this is the same type of solution we obtained in equation {eq}<code>sol-nonhom</code> for a generic linear ODE with a constant term.</p>
</div>
</div>
</section>
</section>
<section id="membrane-as-electric-circuit" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="membrane-as-electric-circuit"><span class="header-section-number">7.3</span> Membrane as electric circuit</h2>
<p>In this example we will construct and analyze a model of electric potential across a membrane. The potential is determined by the difference in concentrations of charged particles (ions) on the two sides of the phospholipid bilayer, as shown in {numref}<code>fig-cell-mem</code>. The ions can flow through specific channels across the membrane, changing the concentration and thus the electric potential. K.S. Cole used principles of electrical circuits to devise the first quantitative model of the membrane voltage <span class="citation" data-cites="cole_dispersion_1941">(<a href="references.html#ref-cole_dispersion_1941" role="doc-biblioref"><strong>cole_dispersion_1941?</strong></a>)</span>, which eventually led to more sophisticated models of Hodgkin and Huxley, and others.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/2000px-cell_membrane.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Illustration of a cell membrane with ion channels (image by LadyofHats in public domain via Wikimedia Commons)</figcaption><p></p>
</figure>
</div>
<p>To start, we will review the physical concepts and laws describing the flow of charged particles. The amount of charge (number of charged particles) is denoted by <span class="math inline">\(Q\)</span>. The rate of flow of charge per time is called the current: <span class="math inline">\(I = \frac{dQ}{dt}\)</span>. Current can be analogized to the flow of a liquid, and the difference in height that drives the liquid flow is similar to the electric potential, or voltage. The relationship between voltage and current is given by <em>Ohm’s law:</em> <span class="math inline">\(V = IR\)</span> where <span class="math inline">\(R\)</span> is the <em>resistance</em> of an electrical conductance, and sometimes we use the <em>conductance</em> <span class="math inline">\(g = 1/R\)</span> in the relationship between current and voltage:</p>
<p><span class="math display">\[
gV = I
\]</span></p>
<p>There are devices known as capacitors, which can store a certain amount of electrical potential in two conducting plates separated by a dielectric (non-conductor). The voltage drop across a capacitor is described by the capacitor law:</p>
<p><span class="math display">\[
V_C = \frac{Q}{C}
\]</span></p>
<p>where <span class="math inline">\(C\)</span> is the <em>capacitance</em> and <span class="math inline">\(Q\)</span> is the charge of the capacitor.</p>
<p>Lipid bilayer membranes separate media with different concentrations of ions on the two sides, typically the extracellular and cytoplasmic sides. The differences in concentrations of different ions produce a membrane potential. The membrane itself can be thought of as a capacitor, with two charged layers separated by the hydrophobic fatty acid tails in the middle. In addition, there are ion channels that allow ions to flow from the side with higher concentration to that with lower (these are known as passive channels, as opposed to active pumps that can transport ions against the concentration gradient, which we will neglect for now.) These channels are often gated, which means that they conduct ions up to a certain voltage <span class="math inline">\(V_R\)</span>, but then close and reverse direction at higher voltage. The channels are analogous to conducting metal wires, and therefore act as resistors with a specified conductance <span class="math inline">\(g\)</span>. Finally, the electrochemical concentrations of ions act as batteries for each species, (Na<span class="math inline">\(^+\)</span>, K<span class="math inline">\(^+\)</span>, etc.) The overall electric circuit diagram of this model is shown in {numref}<code>fig-mem-circuit</code>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/2000px-MembraneCircuit.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Model of ionic flow across a cell membrane as an electric circuit with ion channels as resistors and membrane as a capacitor, (image by NretsNrets under CC BY-SA 3.0 via Wikimedia Commons)</figcaption><p></p>
</figure>
</div>
<p>Because the different components are connected in parallel, the total current has to equal the sum of the current passing through each element: the capacitor (membrane) and the gated resistors (specific ion channels). The current flowing through a capacitor can be found by differentiating the capacitor law:</p>
<p><span class="math display">\[
\frac{dQ}{dt} = I = C \frac{dV_C}{dt}
\]</span></p>
<p>The current flowing through each ion channel is described by this relation: <span class="math inline">\(I = g (V-V_R)\)</span> Then, the total ion flow through the system is described as follows, where <span class="math inline">\(i\)</span> denotes the different ionic species:</p>
<p><span class="math display">\[
I_{app} = C \frac{dV}{dt} + \sum_i g (V-V_{Ri})
\]</span></p>
<p>Let us reduce this model to a simple version, where there is no applied current <span class="math inline">\(I_{app} = 0\)</span> and only a single ionic species with reversal potential <span class="math inline">\(V_R\)</span>. Then the differential equation looks like this:</p>
<p><span class="math display">\[
\frac{dV}{dt} = -\frac{g}{C} (V-V_{Ri})
\]</span></p>
<p>The Cole membrane potential ODE cam also be solved by the separate-and-integrate method. Dividing both sides by <span class="math inline">\(V-V_R\)</span> and multiplying through by the differential <span class="math inline">\(dt\)</span>, we get: <span class="math display">\[
\frac{ dV }{V-V_R} = - \frac{g}{C}dt
\]</span></p>
<p>Remember, that <span class="math inline">\(V_R\)</span> is a constant, while <span class="math inline">\(V(t)\)</span> is the dependent variable. Performing the substitution <span class="math inline">\(u = V - V_R\)</span>, and integrating, we get <span class="math inline">\(\ln |V - V_R | = - \frac{g}{C}t + A\)</span>, where <span class="math inline">\(A\)</span> is the integration constant. Exponentiating both sides and solving for <span class="math inline">\(V(t)\)</span>, we obtain:</p>
<p><span class="math display">\[
V(t) = V_R + Ae^{-\frac{g}{C}t}
\]</span></p>
<p>So, if the voltage is <span class="math inline">\(V_0\)</span> at time 0, we have <span class="math inline">\(V_0 = V_R + A \Rightarrow A = V_0-V_R\)</span>. Thus, the specific solution is:</p>
<p><span class="math display">\[
V(t) = V_R + (V_0-V_R)e^{-\frac{g}{C}t}
\]</span></p>
<p>This model predicts that if there is no applied current, then starting at a voltage <span class="math inline">\(V_0\)</span>, the membrane potential will exponentially decay (or grow) to the channel resting (or reversal) potential.</p>
<p>Notice how similar the solutions of the two models are, even thought they are modeling different phenomena. This is an illustration of the power of mathematical modeling, which allows us to use the same tools to draw general conclusions. This is another illustration of the fact that <strong>solutions of linear ODEs are always exponential in their time dependence</strong>. In cases with a constant rate term, the solutions also include a constant term, to which the solution converges, if the exponential term has a negative constant up in its power.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./ch6_matrix_mult.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Matrix multiplication and population models</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./ch8_numeric_ode.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Numeric solutions of ODEs</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>