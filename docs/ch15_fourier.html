<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Mathematical Methods for Biology, Part 1 - 15&nbsp; Fourier series: decomposition by frequency</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./ch16_linearization.html" rel="next">
<link href="./ch14_lin_oscillations.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Fourier series: decomposition by frequency</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Mathematical Methods for Biology, Part 1</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch1_discrete1var.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">One variable in discrete time</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch2_plotting_python.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Plotting in Python</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch3_discrete_chaos.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Nonlinear discrete-time dynamic models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch4_cobweb_plots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Graphical analysis of difference equations</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch5_discrete_higher.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Discrete models of higher order</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch6_matrix_mult.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Matrix multiplication and population models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch7_linear_reg.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Linear regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch8_LinReg_python.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Linear regression in Python</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch9_1var_ode.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Models with one variable in continuous time</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch10_numeric_ode.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Numeric solutions of ODEs</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch11_graph_ode.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Graphical analysis of ordinary differential equations</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch12_linear_pplane.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Linear ODEs with two variables</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch13_phase_portraits.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Phase portraits in Python</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch14_lin_oscillations.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Forces and potentials in biological modeling</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch15_fourier.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Fourier series: decomposition by frequency</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch16_linearization.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Linearization of ODEs</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#periodic-signals" id="toc-periodic-signals" class="nav-link active" data-scroll-target="#periodic-signals"><span class="toc-section-number">15.1</span>  Periodic signals</a>
  <ul class="collapse">
  <li><a href="#amplitude-period-and-frequency" id="toc-amplitude-period-and-frequency" class="nav-link" data-scroll-target="#amplitude-period-and-frequency"><span class="toc-section-number">15.1.1</span>  amplitude, period, and frequency</a></li>
  <li><a href="#brain-waves-in-eeg" id="toc-brain-waves-in-eeg" class="nav-link" data-scroll-target="#brain-waves-in-eeg"><span class="toc-section-number">15.1.2</span>  brain waves in EEG</a></li>
  </ul></li>
  <li><a href="#periodic-functions-as-a-basis-set" id="toc-periodic-functions-as-a-basis-set" class="nav-link" data-scroll-target="#periodic-functions-as-a-basis-set"><span class="toc-section-number">15.2</span>  Periodic functions as a basis set</a>
  <ul class="collapse">
  <li><a href="#fourier-decomposition-of-a-square-wave" id="toc-fourier-decomposition-of-a-square-wave" class="nav-link" data-scroll-target="#fourier-decomposition-of-a-square-wave"><span class="toc-section-number">15.2.1</span>  Fourier decomposition of a square wave</a></li>
  <li><a href="#complex-fourier-series" id="toc-complex-fourier-series" class="nav-link" data-scroll-target="#complex-fourier-series"><span class="toc-section-number">15.2.2</span>  complex Fourier series</a></li>
  </ul></li>
  <li><a href="#discrete-fourier-transform" id="toc-discrete-fourier-transform" class="nav-link" data-scroll-target="#discrete-fourier-transform"><span class="toc-section-number">15.3</span>  Discrete Fourier Transform</a></li>
  <li><a href="#sampling-theorem-and-aliasing" id="toc-sampling-theorem-and-aliasing" class="nav-link" data-scroll-target="#sampling-theorem-and-aliasing"><span class="toc-section-number">15.4</span>  sampling theorem and aliasing</a></li>
  <li><a href="#fast-fourier-transform" id="toc-fast-fourier-transform" class="nav-link" data-scroll-target="#fast-fourier-transform"><span class="toc-section-number">15.5</span>  Fast Fourier Transform</a>
  <ul class="collapse">
  <li><a href="#splitting-the-data-into-even-and-odd-inputs" id="toc-splitting-the-data-into-even-and-odd-inputs" class="nav-link" data-scroll-target="#splitting-the-data-into-even-and-odd-inputs"><span class="toc-section-number">15.5.1</span>  splitting the data into even and odd inputs</a></li>
  <li><a href="#recursive-splitting-and-reassembly" id="toc-recursive-splitting-and-reassembly" class="nav-link" data-scroll-target="#recursive-splitting-and-reassembly"><span class="toc-section-number">15.5.2</span>  recursive splitting and reassembly</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Fourier series: decomposition by frequency</span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<p>In this chapter we present the method of Fourier analysis, which extracts information about frequency from a data set. In the modeling section we motivate the notion of frequency analysis with the example of electro-encephalogram (EEG) recordings of electrical activity of the central nervous system. The analytic section develops the mathematical notion of function spaces, and the basis of sine and cosine functions. This is used for Fourier decomposition, or description of an arbitrary periodic function as a sum of sines and cosines. In the computational section, we describe the computation of Fourier decomposition using an efficient algorithm called the Fast Fourier Transform, which is a seminal development in the history of computation.</p>
<section id="periodic-signals" class="level2" data-number="15.1">
<h2 data-number="15.1" class="anchored" data-anchor-id="periodic-signals"><span class="header-section-number">15.1</span> Periodic signals</h2>
<section id="amplitude-period-and-frequency" class="level3" data-number="15.1.1">
<h3 data-number="15.1.1" class="anchored" data-anchor-id="amplitude-period-and-frequency"><span class="header-section-number">15.1.1</span> amplitude, period, and frequency</h3>
<p>Many biological processes are periodic, or repetitive, with a particular pattern that serves biological needs; common examples are waves of activity in the heart muscle, repeated spikes of voltage across neural membranes, and daily Circadian rhythms in physiological regulation. It is highly useful to measure the properties of these periodic activities, and to describe them using idealized mathematical functions, specifically sines and cosines.</p>
<p>As a reminder sines and cosines both have period <span class="math inline">\(2\pi\)</span>, but the sine is an odd function: <span class="math inline">\(\sin(x) = -\sin(-x)\)</span>, whereas the cosine is an even function: <span class="math inline">\(\cos(x) = \cos(-x)\)</span>. Furthermore, by adding a couple of parameters, one can produce a sine or cosine wave of any period and any amplitude. In the following expression, the <em>period</em> of both the sine and the cosine is <span class="math inline">\(L\)</span>, and thus the <em>frequency</em> is <span class="math inline">\(1/L\)</span>, while the amplitude of the sine is <span class="math inline">\(A\)</span> and that of the cosine is <span class="math inline">\(B\)</span>.</p>
<p><span class="math display">\[ A \cos(2\pi x/L); \;  B\sin(2\pi x/L)\]</span></p>
</section>
<section id="brain-waves-in-eeg" class="level3" data-number="15.1.2">
<h3 data-number="15.1.2" class="anchored" data-anchor-id="brain-waves-in-eeg"><span class="header-section-number">15.1.2</span> brain waves in EEG</h3>
<p>Of course, not all periodic functions are sines and cosines, but sines and cosines can be used to describe the types of frequencies present in a periodic signal. Consider the following electroencephalograph (EEG) data collected from electrodes on the scalp of a human:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/eegplot.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">EEG signal recordings from multiple electrodes <a href="https://www.cs.colostate.edu/eeg/data/json/doc/tutorial/_build/html/getting_started.html#getting-started" class="uri">https://www.cs.colostate.edu/eeg/data/json/doc/tutorial/_build/html/getting_started.html#getting-started</a></figcaption><p></p>
</figure>
</div>
<p>By inspection, it appears as if there are some periodic processes producing these data, but these are not neat periodic sine or cosine waves. Instead, we have many different overlapping signals, produced by huge numbers of electrical pulses in the brain, each with different frequency. In order to analyze this signal, we need to decompose it into contributions of different frequencies. Signals of different frequencies,called brain waves in neuroscience, serve distinct purposes: for instance, different stages of sleep can be characterized by the frequencies of the brain waves. In the following section we will learn how to describe complex, periodic data sets, such as the one in {numref}<code>fig-eeg-plot</code>, in terms of the contributions, or amplitudes, of sines and cosines of different frequencies. This way we can quantify the presence of different types of brain waves in a given EEG recording.</p>
</section>
</section>
<section id="periodic-functions-as-a-basis-set" class="level2" data-number="15.2">
<h2 data-number="15.2" class="anchored" data-anchor-id="periodic-functions-as-a-basis-set"><span class="header-section-number">15.2</span> Periodic functions as a basis set</h2>
<p>We now introduce the idea of a space of functions, instead of vectors, and describe how to decompose any given function in terms of a basis of other functions. Joseph Fourier postulated in 1822 that any function can be described by an infinite sum of sine functions. Some of the details were incorrect, but he introduced an a revolutionary concept that has found fundamental applications in a multitude of fields of science, from acoustics to medical imaging. The fact is that any function on a finite interval of length <span class="math inline">\(L\)</span> (or a periodic function with period <span class="math inline">\(L\)</span>, which is equivalent) can be represented exactly by an infinite sum of sines and cosines, plus a constant term:</p>
<p><span class="math display">\[
f(x) = a_0 + \sum_{k=1}^\infty a_k \cos(2\pi k x/L)   + \sum_{i=1}^\infty b_k \sin(2\pi k x/L)
\]</span></p>
<p>Notice that this is the same concept of decomposition in terms of a basis set. Any such function can be written as the sum of sines and cosines, and only the coefficients are different for different functions. The main difference is that vector spaces (such as <span class="math inline">\(\mathbb{R}^3\)</span>) have finite basis sets of vectors, while a function space (e.g.&nbsp;the space of all functions with period <span class="math inline">\(L\)</span>) has an infinite basis set of functions (e.g.&nbsp;sines and cosines with different frequencies.) To be specific, let us define these concepts.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Definition
</div>
</div>
<div class="callout-body-container callout-body">
<p>A <em>function space</em> is a collection of all functions defined over a given domain, for example the interval <span class="math inline">\([-L/2, L/2]\)</span>, that have a finite norm, to be defined below.</p>
</div>
</div>
<p>The notion of the norm of a function is similar to the norm, or magnitude of a vector. The reason for restricting function spaces to functions with a finite norm, is to ensure that computations of various quantities of interests are valid and do not blow up. Now let us define the function norm:</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Definition
</div>
</div>
<div class="callout-body-container callout-body">
<p>The <em>norm</em> of a function <span class="math inline">\(f(x)\)</span>, denoted <span class="math inline">\(||f||\)</span>, is a mapping from the function space into nonnegative real numbers, which obeys the following rules:</p>
<ol type="1">
<li><span class="math inline">\(||f|| = 0\)</span> iff <span class="math inline">\(f(x) = 0\)</span> (the function is zero everywhere)</li>
<li><span class="math inline">\(||af|| = a||f||\)</span> for any real number <span class="math inline">\(a\)</span></li>
<li><span class="math inline">\(|| f+g || \leq ||f|| + ||g||\)</span> for any functions <span class="math inline">\(f\)</span> and <span class="math inline">\(g\)</span> in the function space (triangle inequality)</li>
</ol>
</div>
</div>
<p>The norm that we will utilize in the function spaces is called the <span class="math inline">\(L^2\)</span> norm and it is defined as follows:</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Definition
</div>
</div>
<div class="callout-body-container callout-body">
<p>The <span class="math inline">\(L^2\)</span> norm of a real-valued function <span class="math inline">\(f(x)\)</span> over an interval <span class="math inline">\([-L/2,L/2]\)</span> is defined as follows:</p>
<p><span class="math display">\[ ||f|| =\sqrt{\int_{-L/2}^{L/2} f(x)^2 dx}\]</span></p>
</div>
</div>
<p>The <span class="math inline">\(L^2\)</span> norm in function spaces is the square root of the integral of the square of the function values over the interval of its definition (which can be extended to the entire real number line, in the limit of <span class="math inline">\(L \to \infty\)</span>). This is the equivalent of the Euclidean distance norm in vector spaces, which if you recall is the square root of the sum of squares of all the components of the vector. There are many possible norms of function spaces, but the <span class="math inline">\(L^2\)</span> norm is mathematically special, because it is derived from the inner product of the function space:</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Definition
</div>
</div>
<div class="callout-body-container callout-body">
<p>The <em>inner product</em> between two functions <span class="math inline">\(f\)</span> and <span class="math inline">\(g\)</span> defined on the same interval <span class="math inline">\([-L/2,L/2]\)</span> is:</p>
<p><span class="math display">\[&lt;f, g&gt;  = \int_{-L/2}^{L/2} f(x)g(x) dx\]</span></p>
</div>
</div>
<p>The function norm can be defined in terms of the inner product: <span class="math inline">\(||f(x)|| = \sqrt{&lt;f(x), f(x)&gt;}\)</span>. This defines the machinery for computing the “size”” of a function, measured by its norm, as well as the “similarity” between two functions, measured by the inner product. If two functions <span class="math inline">\(f\)</span> and <span class="math inline">\(g\)</span> are very similar, the inner product is close to the square of the norm of <span class="math inline">\(f\)</span> (or <span class="math inline">\(g\)</span>). If <span class="math inline">\(f\)</span> and <span class="math inline">\(g\)</span> are very similar, but flipped by a negative sign, the inner product is close to negative of the square of the norm of <span class="math inline">\(f\)</span> (or <span class="math inline">\(g\)</span>). On the other hand, if the two functions are dissimilar - loosely speaking, if <span class="math inline">\(f\)</span> is positive, <span class="math inline">\(g\)</span> is sometimes positive, sometimes negative, then the product of the values of <span class="math inline">\(f\)</span> and <span class="math inline">\(g\)</span> is sometimes positive and sometimes negative, and thus its integral will add to be close to zero. This is how one can define orthogonality of two functions:</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Definition
</div>
</div>
<div class="callout-body-container callout-body">
<p>Two functions <span class="math inline">\(f\)</span> and <span class="math inline">\(g\)</span> in a function space are <em>orthogonal</em> if <span class="math inline">\(&lt;f,g&gt; = 0\)</span>.</p>
</div>
</div>
<p>Now that we can describe the coefficients for the sines are cosines, by using the inner product of the function we are decomposing, with the basis functions (sines and cosines) in a manner analogous to the basis decomposition described for vector spaces in Chapter 8. The coefficients for the sines and cosines of the Fourier decomposition of a function <span class="math inline">\(f(x)\)</span> with period <span class="math inline">\(L\)</span> are found as follows:</p>
<p><span class="math display">\[a_k = \frac{ &lt;f(x),\cos(2\pi k x/L) &gt; }{  &lt;\cos(2\pi k x/L) ,\cos(2\pi k x/L) &gt;} =\frac{2}{L} \int _{-\frac{L}{2}} ^{\frac{L}{2}} f(x) \cos(2\pi k x/L) dx \]</span></p>
<p><span class="math display">\[  b_k = \frac{ &lt;f(x), \sin(2\pi k x/L)&gt; }{  &lt; \sin(2\pi k x/L), \sin(2\pi k x/L)&gt;} = \frac{2}{L} \int _{-\frac{L}{2}} ^{\frac{L}{2}} f(x) \sin(2\pi k x/L) dx\]</span></p>
<p><span class="math display">\[ a_0 = \frac{1}{L} \int _{-\frac{L}{2}} ^{\frac{L}{2}} f(x)dx\]</span></p>
<p>The factor of <span class="math inline">\(L/2\)</span> in front of the integrals serves to divide out the norm of the basis function. Note that the constant term <span class="math inline">\(c_0\)</span> is the mean value of the function on the interval <span class="math inline">\((-L/2, L/2)\)</span> - it moves the function up or down, while the sines and cosines all have the mean value of zero.</p>
<section id="fourier-decomposition-of-a-square-wave" class="level3" data-number="15.2.1">
<h3 data-number="15.2.1" class="anchored" data-anchor-id="fourier-decomposition-of-a-square-wave"><span class="header-section-number">15.2.1</span> Fourier decomposition of a square wave</h3>
<p>Take a common example of a simple function subject to Fourier decomposition: a square wave, which is a function which equals one constant value (e.g.&nbsp;-1) for half of the interval, and another constant (e.g.&nbsp;1) for the other half of the interval. Here is how we find the coefficients of the sines and cosines analytically:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/square_wave1.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">A square wave function alternates between two constant values. <a href="https://levelup.gitconnected.com/representing-a-square-wave-with-a-fourier-series-and-python-6d43beb19442" class="uri">https://levelup.gitconnected.com/representing-a-square-wave-with-a-fourier-series-and-python-6d43beb19442</a></figcaption><p></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/square_wave2.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Approximations of a square wave function with five terms of the Fourier series. <a href="https://levelup.gitconnected.com/representing-a-square-wave-with-a-fourier-series-and-python-6d43beb19442" class="uri">https://levelup.gitconnected.com/representing-a-square-wave-with-a-fourier-series-and-python-6d43beb19442</a></figcaption><p></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/square_wave3.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Approximations of a square wave function with twenty terms of the Fourier series.<a href="https://levelup.gitconnected.com/representing-a-square-wave-with-a-fourier-series-and-python-6d43beb19442" class="uri">https://levelup.gitconnected.com/representing-a-square-wave-with-a-fourier-series-and-python-6d43beb19442</a></figcaption><p></p>
</figure>
</div>
<p><span class="math display">\[ a_k = \frac{2}{L} \int _{-\frac{L}{2}} ^{\frac{L}{2}} f(x) \cos(2\pi k x/L) dx = \frac{2}{L} \int _{-\frac{L}{2}} ^0 -\cos(2\pi k x/L) dx + \frac{2}{L} \int _0 ^{\frac{L}{2}}  \cos(2\pi k x/L) dx = \]</span> <span class="math display">\[= \frac{2}{L} \left[ \frac{L}{2\pi k} \sin(2\pi k x/L) |_{-\frac{L}{2}} ^0   -  \frac{L}{2\pi k}  \sin(2\pi k x/L)|_0^{\frac{L}{2}} \right] = \frac{1}{\pi k} \left[ 0-0 -0+0\right] = 0 \]</span></p>
<p><span class="math display">\[ b_k = \frac{2}{L} \int _{-\frac{L}{2}} ^{\frac{L}{2}} f(x) \sin(2\pi k x/L) dx = \frac{2}{L} \int _{-\frac{L}{2}} ^0 -\sin(2\pi k x/L) dx + \frac{2}{L} \int _0 ^{\frac{L}{2}}  \sin(2\pi k x/L) dx = \]</span> <span class="math display">\[= \frac{2}{L} \left[ -\frac{L}{2\pi k} \cos(2\pi k x/L) |_{-\frac{L}{2}} ^0   + \frac{L}{2\pi k}  \cos(2\pi k x/L)|_0^{\frac{L}{2}} \right] = \frac{1}{\pi k} \left[ 1 -  \cos(\pi k)  + 1 - \cos(\pi k) \right] = 0 \; or \; \frac{4}{\pi k}  \]</span></p>
<p>The coefficients for the cosines are zeros, but there are nonzero values for the sines, when <span class="math inline">\(k\)</span> is odd, and <span class="math inline">\(\cos(\pi k) = -1\)</span>. When <span class="math inline">\(k\)</span> is even, <span class="math inline">\(\cos(\pi k) = 1\)</span>, and the expression reduces to 0. Thus, the Fourier series representing the square wave with period <span class="math inline">\(L\)</span> looks like this:</p>
<p><span class="math display">\[ f(x) = \frac{4}{\pi}\sin(2 \pi x/ L)  + \frac{4}{3\pi}\sin(2 \pi 3 x/ L) +  \frac{4}{5\pi}\sin(2 \pi 5 x/ L) + ... \]</span></p>
<p>Notice how the coefficients decline for higher frequency terms. This means that one can take a finite, often just a handful of lowest-frequency terms and have a decent approximation of the function. This is typical for most reasonable functions, as we will discuss below.</p>
</section>
<section id="complex-fourier-series" class="level3" data-number="15.2.2">
<h3 data-number="15.2.2" class="anchored" data-anchor-id="complex-fourier-series"><span class="header-section-number">15.2.2</span> complex Fourier series</h3>
<p>We saw that periodic functions can be approximated by a sum of sines and/or cosines of different frequencies, which is called the Fourier series. Because both sines and cosines are needed to represent a function that is not purely odd or even, a more compact complex representation of the Fourier series is used:</p>
<p><span class="math display">\[
f(x) = \sum_{n=-\infty}^\infty c_k e^{i2\pi x k/L}
\]</span></p>
<p>Here <span class="math inline">\(L\)</span> denotes the length of the period of the function <span class="math inline">\(f(x)\)</span>, and <span class="math inline">\(c_n\)</span> are the complex coefficients of the Fourier series, each corresponding to the frequency <span class="math inline">\(n/L\)</span>. They are found by the same integration as the ones for sine and cosines series:</p>
<p><span class="math display">\[ c_k = \frac{1}{L}\int_{-L/2}^{L/2} f(x) e^{-i2\pi kx/L}dx; \; \; -\infty &lt; k &lt; \infty \]</span></p>
<p>The coefficient <span class="math inline">\(c_0\)</span>, as can be seen from the integral, is the average value of <span class="math inline">\(f(x)\)</span> on the interval <span class="math inline">\([-L/2,L/2]\)</span>.</p>
<p>In the complex Fourier series, positive and negative frequencies are used in order to combine both sines and cosines into the same series, by using the expressions <span class="math inline">\(e^{i2\pi x k/L} + e^{- i2\pi x k/L} = 2\cos(\pi x n/L)\)</span> and <span class="math inline">\(e^{i2\pi x n/L} - e^{- i2\pi x n/L} = 2i\sin(2\pi x n/L)\)</span>. Thus, the complex coefficients <span class="math inline">\(c_n\)</span> are related to the coefficients <span class="math inline">\(a_k\)</span> and <span class="math inline">\(b_k\)</span> of the cosine and sine series as follows:</p>
<p><span class="math display">\[
c_k = \frac{a_k -ib_k}{2}; \; c_{-k} = \frac{a_k + ib_k}{2}; \; k \geq 1
\]</span></p>
<p>Note that as long as <span class="math inline">\(a_n\)</span> and <span class="math inline">\(b_n\)</span> are real (which is the same as saying the function <span class="math inline">\(f(x)\)</span> is real) the coefficients with opposite signs will be complex conjugates of each other.</p>
</section>
</section>
<section id="discrete-fourier-transform" class="level2" data-number="15.3">
<h2 data-number="15.3" class="anchored" data-anchor-id="discrete-fourier-transform"><span class="header-section-number">15.3</span> Discrete Fourier Transform</h2>
<p>Now let us consider a series of data points, instead of idealized functions, since in reality the data are never described by perfect continuous functions. Let us suppose that they come from measuring a certain function <span class="math inline">\(f(x)\)</span> over a range of length <span class="math inline">\(L\)</span> at regular intervals. This is called of the function and the sampling interval (in units of <span class="math inline">\(x\)</span>) between the sample points is called <span class="math inline">\(\Delta = L/N\)</span>, where <span class="math inline">\(N\)</span> is the number of sample points. As a result, we get a sequence of <span class="math inline">\(N\)</span> measurements <span class="math inline">\(\{x_i\}\)</span>. In order to decompose the sampled inputs into their frequency components, we need to find the coefficients of the Fourier series. Let us use the notation <span class="math inline">\(\{X_k\}\)</span> for the Fourier coefficients, and define the following the <em>Discrete Fourier Transform</em>:</p>
<p><span class="math display">\[
X_{k} = \sum_{n=0}^{N-1} x_{n} e^{-i 2\pi kn /N}
\]</span></p>
<p>It is called the Discrete Fourier Transform because it is based on the finite data set, and thus computation of coefficients requires summation instead of integration. Let us consider what frequency each coefficient <span class="math inline">\(X_k\)</span> corresponds to. When <span class="math inline">\(k=0\)</span>, <span class="math inline">\(e^0=1\)</span> and we just have the sum of all the sample points. This is called the zero frequency term, or sometimes the DC (direct current) term by electrical engineers. The other terms have frequencies given by <span class="math inline">\(k/N\)</span>, all the way up to <span class="math inline">\((N-1)/N\)</span>. Note here that we assume for convenience that the interval <span class="math inline">\(\Delta\)</span> is 1, so the frequency corresponds to the fraction of points in the cycle (e.g.&nbsp;<span class="math inline">\(k/N\)</span>). The frequency ranges from the lowest of <span class="math inline">\(1/N\)</span> to the highest of <span class="math inline">\((N-1)/N\)</span>. However, the highest frequency is actually equivalent to <span class="math inline">\(-1/N\)</span>, because going around the <span class="math inline">\((N-1)/N\)</span> fraction of a circle in one direction is the same as going <span class="math inline">\(1/N\)</span> fraction in the opposite direction.</p>
<p>Thus, the first half of the coefficients correspond to positive frequencies in increasing order, until the frequency <span class="math inline">\(1/2\)</span> is reached, and then the coefficients correspond to negative frequencies in descending order of the absolute value. In fact, if the input points are real, the coefficients of positive and negative frequencies are symmetric, and so for the Pyhon indexing above, we have: <span class="math inline">\(C(k+1) = C(N-k+1)\)</span> (for <span class="math inline">\(k&gt;0\)</span>). This is because the complex terms have to add up to real numbers, so this ensures that terms with opposite frequencies are complex conjugates (convince yourself of this fact).</p>
</section>
<section id="sampling-theorem-and-aliasing" class="level2" data-number="15.4">
<h2 data-number="15.4" class="anchored" data-anchor-id="sampling-theorem-and-aliasing"><span class="header-section-number">15.4</span> sampling theorem and aliasing</h2>
<p>By representing a periodic function <span class="math inline">\(f(x)\)</span> in terms of the Fourier series, we reduce its description to the values of the coefficients <span class="math inline">\(c_k\)</span>. We say that this set of coefficients is a representation in the <em>frequency domain</em> as opposed to the time or space domain of the original variable <span class="math inline">\(x\)</span>. This is very useful for analyzing the types of frequencies that a function contains.</p>
<p>To elaborate, <span class="math inline">\(c_k\)</span> gives the weight of the sine or the cosine function with frequency <span class="math inline">\(k\)</span>, that is, one which has <span class="math inline">\(k\)</span> repetitions within the period <span class="math inline">\(L\)</span>. Higher frequency terms are more wiggly, and are needed to represent functions with high slopes. Lower frequency terms represent the larger, slower varying shape of the function. For any reasonable function, the higher frequency terms will generally have smaller coefficients than lower-frequency terms, and for really high frequencies will be very small. This enables one simple use of the Fourier series: a periodic function can be approximated by a few lower-frequency terms, so it can be represented by a few numbers. This has great applications in image and sound compression.</p>
<p>The highest frequency possibly in a sample of <span class="math inline">\(N\)</span> data points is called the <em>Nyquist critical frequency</em> <span class="math inline">\(f_c\)</span>. It depends on the sampling interval <span class="math inline">\(\Delta\)</span> like this: <span class="math inline">\(f_c = 1/2\Delta\)</span>. The intuition behind this is that in order to detect a frequency <span class="math inline">\(f\)</span>, one needs to make at least two measurements during one period <span class="math inline">\(1/f_c\)</span>. (Convince yourself of this by drawing a sine wave and sampling it two or fewer times per period.) Since each measurement takes <span class="math inline">\(\Delta\)</span> units, the highest frequency we can sample is <span class="math inline">\(1/2\Delta\)</span>. This leads to a remarkable result, called the Sampling Theorem:</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Theorem
</div>
</div>
<div class="callout-body-container callout-body">
<p>If a function <span class="math inline">\(h(x)\)</span> contains no higher frequencies than some <span class="math inline">\(f_c\)</span>, more precisely its Fourier transform <span class="math inline">\(\hat h(f) = 0\)</span> for any <span class="math inline">\(f&gt;f_c\)</span>, then this function can be completely represented by a sample with the interval <span class="math inline">\(\Delta\)</span> such that <span class="math inline">\(\Delta &lt; 1/2f_c\)</span>.</p>
</div>
</div>
<p>Practically, this means that any function that does not change too abruptly (which requires higher frequency terms) can be represented by a discrete set of low-frequency terms. However, in practice there is always noise or abrupt changes, so one cannot have what is known a <em>bandwidth limit</em> (meaning the band of frequencies contributing to the function is limited). Then, when we try to represent a function with a discrete set of points that we Fourier-transform, when we perform the inverse FT, we get error due to lack of the high-frequency terms. This is called <em>aliasing error</em>.</p>
</section>
<section id="fast-fourier-transform" class="level2" data-number="15.5">
<h2 data-number="15.5" class="anchored" data-anchor-id="fast-fourier-transform"><span class="header-section-number">15.5</span> Fast Fourier Transform</h2>
<p>Now let us get down to the business of computing the Fourier decomposition of an input of <span class="math inline">\(N\)</span> data points. In equation <span class="math inline">\(\ref{eq:dft}\)</span> in the discrete Fourier transform section, we found an analytic formula for finding the coefficients of a complex Fourier series by summation of <span class="math inline">\(N\)</span> components. In order to obtain all <span class="math inline">\(N\)</span> Fourier coefficients, we would need to perform approximately <span class="math inline">\(N^2\)</span> operations (<span class="math inline">\(N\)</span> multiplications plus <span class="math inline">\(N-1\)</span> additions for each of the <span class="math inline">\(N\)</span> coefficients). This means that as the number of inputs grows, the computational cost of performing the Discrete Fourier Transform grows quadratically. This is a major problem because Discrete Fourier Transforms are so ubiquitous - they are at the heart of graphics engines, audio and image analysis, and many other computationally intensive applications. In this section we will describe a truly transformational algorithm which dramatically reduces the computational cost of a DFT, descriptively called the Fast Fourier Transform (FFT). Specifically, we will describe the classic Cooley-Tukey algorithm , which was the first type of FFT; subsequently other variations were developed, which have some advantages, but the original FFT is so fundamental to modern computing that I will present it in this section.</p>
<section id="splitting-the-data-into-even-and-odd-inputs" class="level3" data-number="15.5.1">
<h3 data-number="15.5.1" class="anchored" data-anchor-id="splitting-the-data-into-even-and-odd-inputs"><span class="header-section-number">15.5.1</span> splitting the data into even and odd inputs</h3>
<p>Let the set of inputs for the Discrete Fourier Transform consist of <span class="math inline">\(N\)</span> numbers, <span class="math inline">\(\{x_n\}\)</span>. This number <span class="math inline">\(N\)</span> could be large, and practicing computational scientists have thought about a way of simplifying the calculation. It turns out that there is a beautiful symmetry in the Fourier calculation that enables the calculation of the Fourier coefficients of <span class="math inline">\(N\)</span> data points in terms of the Fourier coefficients of two halves of the data set: the even and the odd numbered inputs. First, let us write down the expression in equation <span class="math inline">\(\ref{eq:dft}\)</span> in terms of sums of the <span class="math inline">\(N/2\)</span> even and the <span class="math inline">\(N/2\)</span> odd inputs, as follows:</p>
<p><span class="math display">\[
X_{k} = \sum_{n=0}^{N-1} x_{n} e^{-i 2\pi kn /N} = \sum_{m=0}^{N/2-1} x_{2m} e^{-i2\pi (2m)k/N} + \sum_{m=0}^{N/2-1} x_{2m+1} e^{-i2\pi (2m+1)k/N}
\]</span></p>
<p>The two sums look very similar to the sum that produces the Fourier coefficients for the <span class="math inline">\(N\)</span> inputs. In fact, the first sum, is identical to the DFT of the even-numbered inputs, which we will denote as <span class="math inline">\(X_{k}^{(e)}\)</span>. The second sum can be transformed by taking the factor <span class="math inline">\(e^{-i2\pi k/N}\)</span> out of the sum into the sum for the DFT of the odd-numbered inputs , which we denote <span class="math inline">\(X_k^{(o)}\)</span>. Conventionally in Fourier literature, the factor <span class="math inline">\(e^{-i2\pi k/N}\)</span>, which is the <span class="math inline">\(N\)</span>th root of unity raised to the <span class="math inline">\(k\)</span>th power, is called the <em>twiddle factor</em>, and is notated <span class="math inline">\(w^k\)</span> (for <span class="math inline">\(N\)</span> inputs). Therefore, we have the following expression:</p>
<p><span class="math display">\[ X_k = X_{k}^{(e)} + w^k X_k^{(o)}\]</span></p>
<p>Note that this formula works for <span class="math inline">\(0\leq k \leq N/2-1\)</span>, since the DFTs of halves of the data set have only half of the outputs (<span class="math inline">\(N/2\)</span>). However, due to its periodicity, the DFT repeats itself for coefficients that go beyond the size of the inputs; for a DFT of size <span class="math inline">\(N\)</span>, <span class="math inline">\(X_{k} = X_{k-N}\)</span>. Therefore, we can compute the other half of the Fourier coefficients of the original data set (<span class="math inline">\(0 \leq k \leq N/2-1\)</span>) to obtain the same formula:</p>
<p><span class="math display">\[
X_{k} = X_{k}^{(e)} + w^{k} X_{k}^{(o)}
\]</span></p>
<p>This result, known as the <em>Danielson-Lanczos lemma</em>, allows the calculation of a DFT with <span class="math inline">\(N\)</span> inputs, in terms of the coefficients of two DFTs with <span class="math inline">\(N/2\)</span> inputs. It is clear that even applying this splitting once leads to computational advantage, since as we noted above, DFT requires on the order of <span class="math inline">\(N^2\)</span> arithmetic operations. Thus, performing DFTs on half of the number of inputs will reduce the number of calculations by a factor of 4, and since it is performed for each half of the data, this results in approximately two-fold reduction in operations, as it requires only on the order of <span class="math inline">\(N\)</span> additional operations to reassemble the full DFT.</p>
</section>
<section id="recursive-splitting-and-reassembly" class="level3" data-number="15.5.2">
<h3 data-number="15.5.2" class="anchored" data-anchor-id="recursive-splitting-and-reassembly"><span class="header-section-number">15.5.2</span> recursive splitting and reassembly</h3>
<p>If splitting the problem in half once reduces the computational cost, why not do it again? and again? This was the idea that Cooley and Tukey came up with in 1965. For example, if the number of inputs is divisible by 4, one can split the data sets into even- and odd-numbered halves, and then split each of those into even and odd-numbered halves, and perform DFT on the quarter-data sets separately. The resulting four sets of Fourier coefficients will be labeled <span class="math inline">\(\{X^{(ee)}\}\)</span>, <span class="math inline">\(\{X^{(eo)}\}\)</span>, <span class="math inline">\(\{X^{(oe)}\}\)</span>, and <span class="math inline">\(\{X^{(oo)}\}\)</span> (e.g.&nbsp;the second one represents the quarter of data set that had even indices in the original set, and odd indices in the even half, corresponding to indices 2,6,10, etc.), and they can be recombined in order to compute the Fourier coefficients of the entire set. Using the above formula, we can find the the expression for reassembling the four quarter-size DFTs to compute the DFT. The twiddle factor for quarter-size data sets is <span class="math inline">\(e^{-i2\pi k/(N/2)} =e^{-i2\pi 2k/N} = w^{2k}\)</span>. Therefore, the formula for the DFT, for indices <span class="math inline">\(0 \leq k \leq N-1\)</span> is: <span class="math display">\[ X_k =  X^{(ee)} + w^{2k}X^{(eo)}  + w^k X^{(oe)} + w^{3k} X^{(oo)}\]</span></p>
<p>We can continue further dividing the data into halves and reassembling the resulting DFT coefficients, as long as the number of data points in the subsets is divisible by two. In order to achieve maximal decomposition, let us assume that the number of inputs is a power of 2 (<span class="math inline">\(N=2^M\)</span>). Then after <span class="math inline">\(M\)</span> such divisions into even and odd subsets, the data are subdivided into <span class="math inline">\(N\)</span> subsets of single values. The DFT of a single data point, by the formula in equation above is just the data point. Therefore, for any data point with a given pattern of even and odd divisions, e.g.&nbsp;<span class="math inline">\(ooeeo...\)</span>, there is a corresponding singlet DFT with index <span class="math inline">\(n\)</span>:</p>
<p><span class="math display">\[ x_n  =  X^{(ooeeo...)}\]</span></p>
<p>The question is, how does the index <span class="math inline">\(n\)</span> of the data point correspond to the string of even and odd divisions in the DFT? The answer turns out to be simple and elegant in binary representation of indices. Consider, for example, a data set of four input values, indexed <span class="math inline">\(\{x_0,x_1,x_2, x_3\}\)</span>. The first division splits them into <span class="math inline">\(\{x_0,x_2\}\)</span> and <span class="math inline">\(\{x_1,x_3\}\)</span>, and the second subdivides them into singleton sets: <span class="math inline">\(\{x_0\},\{x_2\},\{x_1\},\{x_3\}\)</span>. The rearrangement of indices due to divisions into evens and odds is captured by of the binary indices. In binary, we can write <span class="math inline">\(0=00; 1=01; 2=10; 3=11\)</span>. Reversing the bits, that is re-writing the binary numbers from right to left, yields: <span class="math inline">\(00=0, 10=2, 01=1; 11=3\)</span>, which is exactly the order we produced by two splittings. Therefore, we can find the DFTs of each of the resulting singleton sets by reordering the input values by bit-reversal and then recombining them using the Danielson-Lanczos formula above.</p>
<p><strong>Example.</strong> Let us calculate the DFT for the data set <span class="math inline">\(\{x_0, x_1, x_2, x_3\} = \{2, -1, 2, -1 \}\)</span>. As we saw above, we split the four inputs into halves twice until we are left with singleton sets, which are then arranges as follows: $ {x_0, x_1, x_2, x_3 } = {2, 2 -1, -1 }$. Then we recombine the value with appropriate twiddle factors to calculate the DFT. First, calculate the twiddle factors for DFT with <span class="math inline">\(N=2\)</span>:</p>
<p><span class="math display">\[w_0 = 1; \;  w_1 = e^{-i\pi} = -1\]</span></p>
<p><span class="math display">\[ X_0^{(e)} = x_0 + x_2 = 4 \]</span></p>
<p><span class="math display">\[ X_1^{(e)} = x_0 + w^1x_2 = 0\]</span></p>
<p><span class="math display">\[ X_0^{(o)} =  x_1 + x_3 =  - 2\]</span></p>
<p><span class="math display">\[ X_1^{(o)} =  x_1 + w^1 x_3 =  0\]</span></p>
<p>Calculate the twiddle factors for <span class="math inline">\(N=4\)</span>:</p>
<p><span class="math display">\[w_0 = 1; \;  w_1 = e^{-i\pi/2} = -i ; \; w_2 = e^{-i\pi } = -1 ;\;  w_3 = e^{-i3\pi/2} = i\]</span></p>
<p><span class="math display">\[ X_0 =  X_0^{(e)}  + X_0^{(o)} = 2\]</span></p>
<p><span class="math display">\[ X_1 =  X_1^{(e)}  + w^1 X_1^{(o)}  = 0 \]</span></p>
<p><span class="math display">\[ X_2 =  X_0^{(e)}  + w^2 X_1^{(o)}  = 6\]</span></p>
<p><span class="math display">\[ X_3 =  X_1^{(e)}  + w^3 X_1^{(o)} =  0 \]</span></p>
<p>Each DFT coefficient contains information about the periodicity of the data set: the zeroth one is the sum (average signal); the first one measures the strength of the period one component (in this case, none), the second one is the strength of the period two component (in this case, the only frequency present), and the third one mirrors the period one (since there cannot be a period three signal measured in four points.)</p>
<p>This calculation for a small data set illustrates how the FFT algorithm reduces the calculation of the DFT coefficients to reassembling the values of the inputs <span class="math inline">\(x_k\)</span> with the bit-reversed indices with appropriate twiddle factors. This is illustrated in {numref}<code>fig-fft-butterfly</code>, known as the “FFT butterfly” for its visual appearance. The figure demonstrates how the original data points on the left, if arranged in the bit-reversed order are scrambled up by the even/odd divisions, and how they end up in the normal order on the right hand side.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/DIT-FFT-butterfly.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Schematic of the FFT butterfly for 8 input points <a href="https://commons.wikimedia.org/wiki/File:DIT-FFT-butterfly.png" class="uri">https://commons.wikimedia.org/wiki/File:DIT-FFT-butterfly.png</a></figcaption><p></p>
</figure>
</div>
<p>The result of the FFT calculation is exactly the same as the direct DFT, but the FFT takes fewer arithmetic operations to perform. As mentioned above, computing the DFT directly requires <span class="math inline">\(O(N^2)\)</span> operations (the notation means a scalar multiple of <span class="math inline">\(N^2\)</span>). The FFT starts by rearranging the data using bit-reversal (which takes only a small number of calculations). The key to efficiency is recursive reassembly of the DFT, which happens <span class="math inline">\(\log_2 (N)\)</span> times, one for each split (assuming that <span class="math inline">\(N\)</span> is a power of two, which allows for a clean division into singletons.) This calculation, as shown in equation, requires only two operations (an addition and a multiplication by the pre-computed twiddle factor) for each of the <span class="math inline">\(N\)</span> DFT coefficients. Therefore, the total number of operations for FFT is <span class="math inline">\(O(N \log_2 (N) )\)</span> instead of <span class="math inline">\(O(N^2)\)</span> for DFT. This results is a huge gain in efficiency for large data sets, for example, for a million data points <span class="math inline">\(\log_2(10^6) \approx 20\)</span>, the number of operations is reduced by a factor of 50,000.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./ch14_lin_oscillations.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Forces and potentials in biological modeling</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./ch16_linearization.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Linearization of ODEs</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>