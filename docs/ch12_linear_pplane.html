<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.24">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>12&nbsp; Linear ODEs with two variables – Mathematical Methods for Biology, Part 1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./ch13_phase_portraits.html" rel="next">
<link href="./ch11_graph_ode.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dc55a5b9e770e841cd82e46aadbfb9b0.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-27c261d06b905028a18691de25d09dde.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ch12_linear_pplane.html"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Linear ODEs with two variables</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Mathematical Methods for Biology, Part 1</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch1_discrete1var.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">One variable in discrete time</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch2_plotting_python.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Plotting in Python</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch3_discrete_chaos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Nonlinear discrete-time dynamic models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch4_cobweb_plots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Graphical analysis of difference equations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch5_discrete_higher.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Discrete models of higher order</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch6_matrix_mult.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Matrix multiplication and population models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch7_linear_reg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Linear regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch8_LinReg_python.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Linear regression in Python</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch9_1var_ode.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Models with one variable in continuous time</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch10_numeric_ode.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Numeric solutions of ODEs</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch11_graph_ode.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Graphical analysis of ordinary differential equations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch12_linear_pplane.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Linear ODEs with two variables</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch13_phase_portraits.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Phase portraits in Python</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch14_lin_oscillations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Forces and potentials in biological modeling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch15_fourier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Fourier series: decomposition by frequency</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch16_linearization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Linearization of ODEs</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch17_nonlinear_oscillations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Nonlinear oscillations in biology</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#flow-in-the-phase-plane" id="toc-flow-in-the-phase-plane" class="nav-link active" data-scroll-target="#flow-in-the-phase-plane"><span class="header-section-number">12.1</span> Flow in the phase plane</a>
  <ul class="collapse">
  <li><a href="#activators-and-inhibitors-in-biochemical-reactions" id="toc-activators-and-inhibitors-in-biochemical-reactions" class="nav-link" data-scroll-target="#activators-and-inhibitors-in-biochemical-reactions"><span class="header-section-number">12.1.1</span> activators and inhibitors in biochemical reactions</a></li>
  <li><a href="#phase-plane-portraits" id="toc-phase-plane-portraits" class="nav-link" data-scroll-target="#phase-plane-portraits"><span class="header-section-number">12.1.2</span> phase plane portraits</a></li>
  </ul></li>
  <li><a href="#solutions-of-linear-two-variable-odes" id="toc-solutions-of-linear-two-variable-odes" class="nav-link" data-scroll-target="#solutions-of-linear-two-variable-odes"><span class="header-section-number">12.2</span> Solutions of linear two-variable ODEs</a></li>
  <li><a href="#classification-of-linear-systems" id="toc-classification-of-linear-systems" class="nav-link" data-scroll-target="#classification-of-linear-systems"><span class="header-section-number">12.3</span> Classification of linear systems</a>
  <ul class="collapse">
  <li><a href="#real-eigenvalues" id="toc-real-eigenvalues" class="nav-link" data-scroll-target="#real-eigenvalues"><span class="header-section-number">12.3.1</span> real eigenvalues</a></li>
  <li><a href="#complex-eigenvalues" id="toc-complex-eigenvalues" class="nav-link" data-scroll-target="#complex-eigenvalues"><span class="header-section-number">12.3.2</span> complex eigenvalues</a></li>
  <li><a href="#classification-of-linear-systems-1" id="toc-classification-of-linear-systems-1" class="nav-link" data-scroll-target="#classification-of-linear-systems-1"><span class="header-section-number">12.3.3</span> classification of linear systems</a></li>
  </ul></li>
  <li><a href="#dynamics-of-romantic-relationships" id="toc-dynamics-of-romantic-relationships" class="nav-link" data-scroll-target="#dynamics-of-romantic-relationships"><span class="header-section-number">12.4</span> Dynamics of romantic relationships</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Linear ODEs with two variables</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In chapter 3 we introduced and analyzed discrete-time models with multiple variables representing different demographic groups. In those models, the populations at the next time step depend on the population at the current time step in a linear fashion. More generally, any model with only linear dependencies can be represented in matrix form. In this chapter we will learn how to analyze the behavior of these models, and identify all possible classes of linear dynamical systems.</p>
<p>The main concept of this chapter are the special numbers and vectors associated with a matrix, called eigenvalues and eigenvectors. Any matrix can be thought of as an operator acting on vectors, and transforming them in certain ways. Loosely speaking, this transformation can be expressed in terms of special directions (eigenvectors) and special numbers that describe what happens along those special directions. Finding the eigenvalues and eigenvectors of a matrix allows us to understand the dynamics of biological models by classifying them into distinct categories.</p>
<p>In the modeling section, we will develop some intuition for modeling activators and inhibitors of biochemical reactions. We will then learn how to draw the flow of two-dimensional dynamical systems in the plane. In the analytical section, we will define eigenvectors and eigenvalues, and use this knowledge to find the general solution of linear multi-variable systems. In the computational section, numerical solutions of eigenvalues and eigenvectors will be applied to classifying all linear multi-dimensional systems, and to plotting the solutions, both over time and in the plane. Finally, in the synthesis section we will use a light-hearted model of relationship dynamics to illustrate how to analyze linear dynamical systems.</p>
<section id="flow-in-the-phase-plane" class="level2" data-number="12.1">
<h2 data-number="12.1" class="anchored" data-anchor-id="flow-in-the-phase-plane"><span class="header-section-number">12.1</span> Flow in the phase plane</h2>
<section id="activators-and-inhibitors-in-biochemical-reactions" class="level3" data-number="12.1.1">
<h3 data-number="12.1.1" class="anchored" data-anchor-id="activators-and-inhibitors-in-biochemical-reactions"><span class="header-section-number">12.1.1</span> activators and inhibitors in biochemical reactions</h3>
<p>Suppose two gene products (proteins) regulate each others’ expression. Activator protein <span class="math inline">\(A\)</span> binds to the promoter of the gene for <span class="math inline">\(I\)</span> and activates its expression, while inhibitor protein <span class="math inline">\(I\)</span> binds to the promoter of the gene for <span class="math inline">\(A\)</span> and inhibits its expression (here the variables stand for concentrations of the two proteins in the cell):</p>
<p><span class="math display">\[
\begin{aligned}
\dot  A &amp; = &amp; - \alpha I\\
\dot  I &amp; = &amp; \beta A
\end{aligned}
\]</span></p>
<p><span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> are positive rate constants. They represent the rate of inhibition of <span class="math inline">\(A\)</span> by <span class="math inline">\(I\)</span>, and of activation of <span class="math inline">\(I\)</span> by <span class="math inline">\(A\)</span>, respectively. Let us now complicate the model by adding self-inhibition. It is common for regulatory proteins to inhibit their own production. Then, we have the following system of equations:</p>
<p><span class="math display">\[
\begin{aligned}
\dot  A &amp; = &amp; - \gamma A - \alpha I\\
\dot  I &amp; = &amp; \beta A - \delta I
\end{aligned}
\]</span></p>
<p>Here we have added two rates of self-inhibition <span class="math inline">\(\gamma\)</span> and <span class="math inline">\(\delta\)</span>. This is a system of two coupled ODEs, and we will learn how to analyze these models both analytically and graphically.</p>
</section>
<section id="phase-plane-portraits" class="level3" data-number="12.1.2">
<h3 data-number="12.1.2" class="anchored" data-anchor-id="phase-plane-portraits"><span class="header-section-number">12.1.2</span> phase plane portraits</h3>
<p>Before we learn about the analytical tools of linear algebra, let us think intuitively about the effect of the variables on each other. The best way to describe this is through plotting the geometry of the <em>flow</em> prescribed by the differential equations. As we saw, for one-dimensional ODEs the direction of the change of the dependent variable (also known as the flow) could be shown as arrows on a line. A single variable can only increase, decrease, or stay the same (at a fixed point). In two dimensions there is more freedom. The flow is plotted on the <em>phase plane</em>, where for any combination of the two variables (say <span class="math inline">\(x,y\)</span>) the ODE gives the derivatives of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>. This vector gives the flow, or the rate of change at the particular point in the plane. Intuitively, the flow describes the direction in which the system is pulling the 2-dimensional solution. If we plot the progress of a solution of ODE (all the values of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> starting with the initial condition) we will obtain a <em>trajectory</em> in the phase plane. The arrows of the flow are tangent to any trajectory curve, since they plot the derivatives of <span class="math inline">\(x,y\)</span>.</p>
<p><strong>Example: positive relationship between the variables</strong> Consider the following system of differential equations:</p>
<p><span class="math display">\[
\begin{aligned}
\dot x &amp; = &amp; x + y \\
\dot y &amp; = &amp; x + 2y
\end{aligned}
\]</span> (eq-ode1)</p>
<p>This is system is coupled, with <span class="math inline">\(x\)</span> having an effect on <span class="math inline">\(y\)</span> and vice versa. Specifically, the signs of the constants mean that positive values of <span class="math inline">\(x\)</span> have the effect of increasing <span class="math inline">\(y\)</span> (and vice versa), while negative values of <span class="math inline">\(x\)</span> have the effect of decreasing <span class="math inline">\(y\)</span> (and vice versa). For any pair of values of <span class="math inline">\((x,y)\)</span>, there is a flow prescribed by the ODEs. E.g., when <span class="math inline">\(x=1, y=1\)</span>, the derivatives are <span class="math inline">\(\dot x = 2, \dot y = 3\)</span>. This means that the flow at that point is given by the vector <span class="math inline">\((2,3)\)</span>, and can be plotted in the <span class="math inline">\(x,y\)</span> phase plane. This can be done for any pair of values of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>, and plotted to give the phase plane portrait in figure {numref}<code>fig-ode1</code>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/week6_pp5.png" class="img-fluid figure-img"></p>
<figcaption>Phase plane flow for the system in {eq}<code>eq-ode1</code></figcaption>
</figure>
</div>
<p>Observe that the overall dynamics of the systems are directed outward from the origin, as we expect from the ODEs. The blue lines on the plot are some sample trajectories. The solution over time for both <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> will either grow toward positive infinity, or decay to negative infinity.</p>
<p><strong>Example: negative relationship between the variables</strong> Consider the following system of differential equations, where <span class="math inline">\(y\)</span> has an effect on <span class="math inline">\(\dot x\)</span> opposite of its own sign. That is, negative values of <span class="math inline">\(y\)</span> contribute to the growth of <span class="math inline">\(x\)</span>, and vice versa.</p>
<p><span class="math display">\[
\begin{aligned}
\dot x &amp; = &amp; -y \\
\dot y &amp; = &amp; x  
\end{aligned}
\]</span> (eq-ode2)</p>
<p>As above, the flow at any one point is given by the ODEs. E.g. at <span class="math inline">\((0,1)\)</span> the two derivatives prescribe flow in the <span class="math inline">\((1,0)\)</span> (up) direction, while at <span class="math inline">\((1,0)\)</span> the flow is in the <span class="math inline">\((0,-1)\)</span> direction. Figure {numref}<code>fig-ode2</code> shows the arrows of flow in the phase plane around the origin. Note that the arrows go around in a circular pattern around the origin - this shows oscillatory flow of solutions.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/week6_pp2.png" class="img-fluid figure-img"></p>
<figcaption>Phase plane flow for the system in {eq}<code>eq-ode2</code></figcaption>
</figure>
</div>
<p>Let us consider the trajectories of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> in time. The blue curves in the phase plane plot demonstrate the solutions go around the origin and return to the same point. This means that the behavior of the solutions over time is <em>periodic</em>, with oscillations going from positive to negative numbers and back forever.</p>
</section>
</section>
<section id="solutions-of-linear-two-variable-odes" class="level2" data-number="12.2">
<h2 data-number="12.2" class="anchored" data-anchor-id="solutions-of-linear-two-variable-odes"><span class="header-section-number">12.2</span> Solutions of linear two-variable ODEs</h2>
<p>Let us start by considering two variable ODEs that do not affect each other:</p>
<p><strong>Example: two uncoupled ODEs</strong> In general, for a two-variable system, the value of one variable affects the other. In the equations above, the terms with the constants <span class="math inline">\(b\)</span> and <span class="math inline">\(c\)</span> provide what is known as <em>coupling</em> between the two variables. Let us look at the primitive situation where the two variables are uncoupled, as an illustration of solving two-dimensional ODEs. If we set the coupling constants <span class="math inline">\(b\)</span> and <span class="math inline">\(c\)</span> to 0, we get:</p>
<p><span class="math display">\[
\begin{aligned}
\dot x &amp; = &amp; ax \\
\dot y &amp; = &amp; dy
\end{aligned}
\]</span></p>
<p>Using our knowledge of 1D linear ODE, we can solve the two equations independently to get the following: <span class="math inline">\(x(t) = x_0 e^{at}\)</span> and <span class="math inline">\(y(t) = y_0 e^{dt}\)</span>. The solutions can be written in vector form:</p>
<p><span class="math display">\[
\left(\begin{array}{c}x(t) \\y(t)\end{array}\right) =
x_0 e^{at} \left(\begin{array}{c}1 \\0\end{array}\right)+y_0 e^{dt}\left(\begin{array}{c}0\\1\end{array}\right)
\]</span></p>
<p>This is another way of writing that the dynamics of variable <span class="math inline">\(x\)</span> is exponential growth (or decay) with rate <span class="math inline">\(a\)</span>, and ditto <span class="math inline">\(y\)</span>, with rate <span class="math inline">\(d\)</span>. Given the initial conditions <span class="math inline">\((x_0, y_0)\)</span>, we can divide the behavior of the solutions into a sum of two vectors, each growing or decaying at its own rate.</p>
<p>Linear algebra allows us to find the solution for two-dimensional ODEs where the variables are interdependent using the same idea. The general (homogeneous) ODE with two dependent variables can be written as follows:</p>
<p><span class="math display">\[
\begin{aligned}
\dot x &amp; = &amp; ax + by \\
\dot y &amp; = &amp; cx + dy
\end{aligned}
\]</span></p>
<p>We can write this in matrix form like this:</p>
<p><span class="math display">\[
\left(\begin{array}{c}\dot x \\ \dot y \end{array}\right) = \left(\begin{array}{cc}a &amp; b \\c &amp; d\end{array}\right)\left(\begin{array}{c}x \\ y \end{array}\right)
\]</span></p>
<p>Let us call the matrix <span class="math inline">\(A\)</span>, and represent the vector <span class="math inline">\((x,y)\)</span> as <span class="math inline">\(\vec {x}\)</span>, then the general linear equation can be written like this:</p>
<p><span class="math display">\[
\dot{ \vec{ x}} = A \vec{x}
\]</span> (gen-lin-mult)</p>
<p>This notation is intended to make plain the similarity with the linear 1D ODE: <span class="math inline">\(\dot x = a x\)</span>. This similarity is deep and substantial, in that linear equations in multiple dimensions share the same basic exponential form. In general, all solutions of linear equations can be written as a sum of exponentials multiplying different vectors:</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>General solution of linear 2-variable ODEs
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math display">\[
\left(\begin{array}{c} x(t) \\  y(t) \end{array}\right) =C_1e^{\lambda_1 t} \left(\begin{array}{c}x_1\\y_1\end{array}\right)+C_2 e^{\lambda_2 t}\left(\begin{array}{c}x_2\\y_2\end{array}\right)
\]</span> (gen-sol-2var)</p>
<p>The constants <span class="math inline">\(C_1, C_2\)</span> are determined by the initial conditions, while the constants <span class="math inline">\(\lambda_1, \lambda_2\)</span> are the eigenvalues and the vectors <span class="math inline">\((x_1,y_1)\)</span> and <span class="math inline">\((x_2,y_2)\)</span> are the eigenvectors of the matrix <span class="math inline">\(A\)</span>. We will now consider the application of this general result using computational tools.</p>
</div>
</div>
</section>
<section id="classification-of-linear-systems" class="level2" data-number="12.3">
<h2 data-number="12.3" class="anchored" data-anchor-id="classification-of-linear-systems"><span class="header-section-number">12.3</span> Classification of linear systems</h2>
<p>We have seen that linear algebra allows us to write down the solution of a multivariable dynamical system into a sum of exponential terms. In this section we use computational techniques to find the eigenvalues and eigenvectors of a system, and then produce the <em>phase portraits</em> of the linear systems. There are only a few different types of flow possible for linear systems, and we will classify them.</p>
<section id="real-eigenvalues" class="level3" data-number="12.3.1">
<h3 data-number="12.3.1" class="anchored" data-anchor-id="real-eigenvalues"><span class="header-section-number">12.3.1</span> real eigenvalues</h3>
<p>Let us consider the fixed points of the linear system: since both <span class="math inline">\(\dot x =0\)</span> and <span class="math inline">\(\dot y = 0\)</span> must be zero, the only fixed point is the origin <span class="math inline">\((0,0)\)</span>. We will see that the stability of the fixed point depends on the sign of the real part of the eigenvalue.</p>
<p>Suppose we have a positive real eigenvalue. The solution in the direction of the corresponding eigenvector is then described by <span class="math inline">\(Ce^{\lambda t}\)</span>, <span class="math inline">\(\lambda &gt; 0\)</span>, which is exponential growth. The means that the solution is going to grow in the direction of the eigenvector away from the origin, and thus the origin is an unstable fixed point (in this direction). This type of fixed point is called an <em>unstable node</em>.</p>
<p>On the other hand, if <span class="math inline">\(\lambda &lt; 0\)</span> for both eigenvalues, the solution decays exponentially and thus approaches the origin, so the fixed point is stable. This type of fixed point is called a <em>stable node</em>.</p>
<p>Since there are two different eigenvalues, one may be positive while another is negative. In this case, the fixed point is is called a <em>saddle point</em> for geometric reasons: solutions flow toward it in one direction, like a marble along the forward-backward axis of a saddle on a horse and flow away from it along the sideways direction on a saddle. Then, the fixed point is stable when approached along one eigenvector, but unstable along the other. What happens if the initial condition is not on either eigenvector? I will use a fact of linear algebra that given any two (non-colinear) 2D vectors, any vector in the plane can represented as a sum (with some coefficients) of these two. Thus, the general solution can be written as follows:</p>
<p><span class="math display">\[
\left(\begin{array}{c} x(t) \\  y(t) \end{array}\right) =C_1e^{at} \left(\begin{array}{c}v_1\\v_2\end{array}\right)+C_2 e^{-bt}\left(\begin{array}{c}u_1\\u_2\end{array}\right)
\]</span></p>
<p>where <span class="math inline">\(a,b&gt;0\)</span>. Then we see that the component in the direction of the first eigenvector will grow, while the component along the second eigenvector will decay. Thus, as <span class="math inline">\(t \rightarrow \infty\)</span>, all solutions will approach the vector with the unstable eigenvalue, except those with initial conditions right on the eigenvector corresponding to the stable eigenvalue. This means that the fixed point is essentially unstable, because only trajectories which start exactly along the stable direction approach the fixed point in the long run, while others, may approach the fixed point for a finite time, flow away when the unstable component with the positive eigenvalue takes over, as shown in figure .</p>
<p>![Phase plane flow for a linear system with a saddle point] (images/week6_pp1.png)</p>
</section>
<section id="complex-eigenvalues" class="level3" data-number="12.3.2">
<h3 data-number="12.3.2" class="anchored" data-anchor-id="complex-eigenvalues"><span class="header-section-number">12.3.2</span> complex eigenvalues</h3>
<p>If the argument of the square root is negative, eigenvalues may be complex numbers, which we can write like this: <span class="math inline">\(a+bi\)</span>. Using Euler’s formula, we can write down the time-dependent part of the solutions as the following:</p>
<p><span class="math display">\[
e^{(a + bi)t} = e^{at}e^{bit}= e^{at}(\cos(bt)+i\sin(bt))
\]</span></p>
<p>The behavior of these solutions combines exponential growth or decay from the real part, with the oscillations produced by the imaginary part. This describes either exponentially growing or decaying oscillations, which look like decaying waves in time, or as a spiral in the phase plane:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/lec7_exp_osc.png" class="img-fluid figure-img"></p>
<figcaption>Exponentially decaying oscillations in the time plot of the solution <span class="math inline">\(x(t)\)</span></figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/lec7_pp1.png" class="img-fluid figure-img"></p>
<figcaption>Phase plane portrait of a stable spiral</figcaption>
</figure>
</div>
<p>Thus we see that the stability of the fixed point with complex eigenvalues depends on the sign of the real part. Purely imaginary eigenvalues produce periodic oscillations, which keep the same amplitude, as we saw in the example in the modeling section.</p>
</section>
<section id="classification-of-linear-systems-1" class="level3" data-number="12.3.3">
<h3 data-number="12.3.3" class="anchored" data-anchor-id="classification-of-linear-systems-1"><span class="header-section-number">12.3.3</span> classification of linear systems</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 11%">
<col style="width: 21%">
<col style="width: 22%">
<col style="width: 28%">
<col style="width: 17%">
</colgroup>
<thead>
<tr class="header">
<th>Stability</th>
<th>positive real parts</th>
<th>negative real parts</th>
<th>one positive, one negative</th>
<th>zero real part</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>real:</td>
<td>unstable node</td>
<td>stable node</td>
<td>saddle point</td>
<td>fixed line</td>
</tr>
<tr class="even">
<td>complex:</td>
<td>unstable spiral</td>
<td>stable spiral</td>
<td>N/A</td>
<td>center point</td>
</tr>
</tbody>
</table>
<p>Eigenvalues of linear ODEs define type of phase plane</p>
<p>The table above summarizes all the different types of flows in the phase plane possible for linear systems, in terms of the behavior of solutions relative to the fixed point at the origin. If the eigenvalues are real, the solutions will be exponential in nature. There are three possibilities for nonzero eigenvalues: <em>stable node</em> (both eigenvalues are negative), <em>unstable node</em> (both eigenvalues are positive), and a <em>saddle point</em> (mixed signs). If one of the eigenvalues is zero, this means that there is not flow along one direction, so there is a <em>line of fixed points</em> in the direction of the corresponding eigenvector (if both eigenvalues are zero, there is no flow at all.)</p>
<p>For complex eigenvalues, there are three possibilities: if the real part is positive, the solution will grow and oscillate (oscillations with exponentially increasing amplitude), if the real part is negative, the solution will decay and oscillation (oscillations with exponentially increasing amplitude), and if the real part is zero (pure imaginary&nbsp;eigenvalues) the solution will oscillate with constant amplitude. The first type is called an <em>unstable spiral</em>, the second a <em>stable spiral</em>, and the third a <em>center</em>. It is not possible for complex eigenvalues of two-dimensional systems to have different signs of real parts, because as the formula shows, the real part is the same for both and is equal to the trace divided by two.</p>
</section>
</section>
<section id="dynamics-of-romantic-relationships" class="level2" data-number="12.4">
<h2 data-number="12.4" class="anchored" data-anchor-id="dynamics-of-romantic-relationships"><span class="header-section-number">12.4</span> Dynamics of romantic relationships</h2>
<p>We examine a model, taken from <span class="citation" data-cites="strogatz_nonlinear_2001">(<a href="references.html#ref-strogatz_nonlinear_2001" role="doc-biblioref">Strogatz 2001</a>)</span>, that applies dynamical systems modeling to a pressing concern for many humans: the prediction of dynamics of a romantic relationship. There are several unrealistic assumptions involved in the following model: first, that love or affection can be quantified, second, that any changes in relationship depend only on the emotions of the two people involved, and third, that the rate of change of the two love variables depend linearly on each other.</p>
<p>If we can give those assumptions the benefit of the doubt (which is how all relationships begin), we can write down a system of ODEs to describe a romantically involved couple. Here <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are dynamic variables that quantify the emotional states of the two lovers:</p>
<p><span class="math display">\[
\begin{aligned}
\dot  X &amp;=&amp; aX+ bY \\
\dot  Y &amp;=&amp; cX + dY
\end{aligned}
\]</span></p>
<p>Let us denote positive feelings (love) with positive values of <span class="math inline">\(X,Y\)</span>, while negative values signify negative feelings (hate.) The significance of the parameters can be interpreted as follows: <span class="math inline">\(a,d\)</span> describe the response of the two people to their own feelings, while <span class="math inline">\(b,c\)</span> correspond to the effect the other person’s feeling has on their own. For example, a person whose feeling grow as the other person’s affection increases can be modeled with a positive value of <span class="math inline">\(b\)</span> (or <span class="math inline">\(c\)</span>). On the other hand, a person whose own feelings are dampened by the other one’s excessively positive emotions, can be decribed by a negative value of <span class="math inline">\(b\)</span> or <span class="math inline">\(c\)</span>. Their own feelings can also play a role, either positive or negative, reflected in the sign of the constants <span class="math inline">\(a\)</span> and <span class="math inline">\(d\)</span>.</p>
<p>Using mathematical modeling, we can answer the following basic questions:</p>
<ol type="1">
<li><p>Given a set of values for parameters <span class="math inline">\(a, b, c, d\)</span>, predict the dynamic behavior of the model relationship.</p></li>
<li><p>Find conditions for stability and existence of oscillations in the dynamical system, expressed as a function of the parameters.</p></li>
</ol>
<p>To address the first question, here are some simplified scenarios for our two lovers in the model.</p>
<p><strong>Detached lovers:</strong> Let the emotional state of the two lovers depend only on their own emotions, for example:</p>
<p><span class="math display">\[
\begin{aligned}
\dot  X &amp; = &amp; X \\
\dot  Y &amp; = &amp;  -Y
\end{aligned}
\]</span></p>
<p>To classify the behavior of the model, we find the eigenvalues of the system. In this case, they are the diagonal elements of the matrix, 1 and -1. This mean that the origin is a saddle point, and therefore it is unstable. In the <span class="math inline">\(X\)</span> direction, the emotions are going to grow without bound, either in the love or hate direction, while in the <span class="math inline">\(Y\)</span> direction, the emotions are going to decay to zero (indifference). This should be no surprise, that since the two equations are independent, the lovers have no emotional effect on each other.</p>
<p><strong>Lovers with no self-awareness:</strong> Here is an alternate situation: suppose two lovers were not influenced by their own emotions, but were instead attuned to the emotional state of the other. Then we might have the following model, in which lover <span class="math inline">\(X\)</span> reacts in the opposite way by emotions of lover <span class="math inline">\(Y\)</span>, but lover <span class="math inline">\(Y\)</span> is, contrariwise, spurred by the love or hate of <span class="math inline">\(X\)</span> in the same direction:</p>
<p><span class="math display">\[
\begin{aligned}
\dot  X &amp; = &amp; -Y \\
\dot  Y &amp; = &amp;  X
\end{aligned}
\]</span></p>
<p>We find the eigenvalues of the system by using the expression in equation [eg:2D_eig]: <span class="math inline">\(\lambda =  (0 \pm \sqrt{-4})/2 = \pm i\)</span>. Pure imaginary eigenvalues tell us that the origin is a center point, with the solutions periodic orbits around the origin. Psychologically, we can interpret this scenario as cycles of love and hate, never growing and never decaying. The magnitude of these oscillations depends on the initial state of the system, that is, the feelings the lovers had at the beginning of the relationship.</p>
<p>We can now address the second question, and find under what circumstances different types of dynamic behaviors occur. We consider the general model, and ask what kinds of eigenvalues are possible for different parameter values. First, we write down the general expression for the eigenvalues, from equation [eg:2D_eig]:</p>
<p><span class="math display">\[
\lambda =  \frac{a+d \pm \sqrt{(a+d)^2-4(ad-bc)}}{2}
\]</span></p>
<p>There are two properties we are interested in: stability and existence of oscillations. Recall that stability is determined by the sign of the real part of the eigenvalues. If the square root is imaginary, then the real part is simply the trace (<span class="math inline">\(a+d\)</span>), but if the square root is real, we have to consider the whole expression to determine stability. So let us first state the condition for existence of oscillations (imaginary square root):</p>
<ol type="1">
<li><p>Complex eigenvalues: oscillatory solutions <span class="math inline">\(4(ad-bc) &gt; (a+d)^2\)</span>. If this expression holds, the square root is imaginary, and the stability is determined by the sign of the trace. That is, if <span class="math inline">\(a+d &gt; 0\)</span>, the system is unstable, and will grow into unbounded love or hate, but if <span class="math inline">\(a+d &lt; 0\)</span>, then the system is stable, and will spiral to indifference. The special case <span class="math inline">\(a+d = 0\)</span>, such as we saw above, means that strictly periodic love/hate cycles are the solutions.</p></li>
<li><p>Real eigenvalues: exponential growth and/or decay <span class="math inline">\(4(ad-bc) &lt; (a+d)^2\)</span>. In this case, the square root is real, and no oscillatory solutions exist. In order to determine whether this implies exponential growth, decay, or a combination, we must weigh the relative sizes of <span class="math inline">\((a+d)\)</span> and <span class="math inline">\(\sqrt{(a+d)^2-4(ad-bc)}\)</span>. If <span class="math inline">\(|a+d| &gt; \sqrt{(a+d)^2-4(ad-bc)}\)</span>, then adding or subtracting the square root does not change the sign of <span class="math inline">\((a+d)\)</span>: if it is negative, both eigenvalues are negative, and the origin is a stable node, and if the trace is positive, the origin is an unstable node. However, if the absolute value of the root outweighs the absolute value of the trace <span class="math inline">\(|a+d| &lt; \sqrt{(a+d)^2-4(ad-bc)}\)</span> , then either adding or subtracting the root will change the sign of the eigenvalues. Therefore, one eigenvalue is positive and the other is negative, and the origin is a saddle point. The emotions will run unchecked in some preferred direction, possibly combining love and hate of the two lovers.</p></li>
</ol>
<p>These conditions are not intuitive, and it took some work to express them. The benefit is that now, given any values of the self-involvement parameters <span class="math inline">\(a,d\)</span> and the sensitivity parameters <span class="math inline">\(b,c\)</span> we can predict the long-term dynamics of the model relationship. Whether the results have any bearing on reality, of course, depends on how well the reality is described by these primitive assumptions.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-strogatz_nonlinear_2001" class="csl-entry" role="listitem">
Strogatz, Steven H. 2001. <em>Nonlinear <span>Dynamics</span> <span>And</span> <span>Chaos</span>: <span>With</span> <span>Applications</span> <span>To</span> <span>Physics</span>, <span>Biology</span>, <span>Chemistry</span>, <span>And</span> <span>Engineering</span></em>. 1st ed. Westview Press.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./ch11_graph_ode.html" class="pagination-link" aria-label="Graphical analysis of ordinary differential equations">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Graphical analysis of ordinary differential equations</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./ch13_phase_portraits.html" class="pagination-link" aria-label="Phase portraits in Python">
        <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Phase portraits in Python</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>