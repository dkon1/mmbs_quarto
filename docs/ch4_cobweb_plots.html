<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.38">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Mathematical Methods for Biology, Part 1 - 4&nbsp; Graphical analysis of difference equations</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./ch5_discrete_higher.html" rel="next">
<link href="./ch3_discrete_chaos.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Graphical analysis of difference equations</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Mathematical Methods for Biology, Part 1</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch1_discrete1var.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">One variable in discrete time</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch2_plotting_python.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Plotting in Python</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch3_discrete_chaos.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Nonlinear discrete-time dynamic models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch4_cobweb_plots.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Graphical analysis of difference equations</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch5_discrete_higher.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Discrete models of higher order</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch6_matrix_mult.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Matrix multiplication and population models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch7_linear_pplane.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Linear ODEs with two variables</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch8_phase_portraits.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Phase portraits in Python</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#plot-of-the-updating-function" id="toc-plot-of-the-updating-function" class="nav-link active" data-scroll-target="#plot-of-the-updating-function"> <span class="header-section-number">4.0.1</span> plot of the updating function</a></li>
  <li><a href="#cobweb-plot" id="toc-cobweb-plot" class="nav-link" data-scroll-target="#cobweb-plot"> <span class="header-section-number">4.0.2</span> cobweb plot</a></li>
  <li><a href="#graphical-analysis-of-the-logistic-model" id="toc-graphical-analysis-of-the-logistic-model" class="nav-link" data-scroll-target="#graphical-analysis-of-the-logistic-model"> <span class="header-section-number">4.1</span> Graphical analysis of the logistic model</a>
  <ul class="collapse">
  <li><a href="#chaos-in-discrete-dynamical-systems" id="toc-chaos-in-discrete-dynamical-systems" class="nav-link" data-scroll-target="#chaos-in-discrete-dynamical-systems"> <span class="header-section-number">4.1.1</span> chaos in discrete dynamical systems</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Graphical analysis of difference equations</span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<p>In addition to calculating numeric solutions, computers can be used to perform <em>graphical analysis</em> of discrete time models. A lot of information can be gleaned by plotting the graph of the updating function of an recurrent difference equation <span class="math inline">\(x_{t+1} = f(x_t)\)</span>. Here is a summary of what we can learn from the graph of the function <span class="math inline">\(f(x)\)</span>:</p>
<div class="callout-tip callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Graph of the updating function
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><p>The location of the fixed points of the iterated map. Since the condition for a fixed point is <span class="math inline">\(f(x) = x\)</span>, they can be found at the intersections of the graph of <span class="math inline">\(y=f(x)\)</span> and <span class="math inline">\(y=x\)</span> (the identity straight line).</p></li>
<li><p>The stability of fixed points. We learned that the derivative of <span class="math inline">\(f(x)\)</span> at a fixed point determines its stability. Graphically, this means that the slope of <span class="math inline">\(f(x)\)</span> at the point of intersection with <span class="math inline">\(y=x\)</span> can be used for this purpose; if it is steeper (in absolute value) than the straight line <span class="math inline">\(y=x\)</span>, then the fixed point is unstable, but if its slope is less than one in absolute value, the equilibrium is stable.</p></li>
<li><p>Graphical iteration of the difference equation. The value of the function <span class="math inline">\(f(x)\)</span> gives the value of <span class="math inline">\(x\)</span> at the next time step, and this fact can be used to produce a graph of successive values of the dependent variable: <span class="math inline">\(x_0, x_1, x_2, ...\)</span></p></li>
</ol>
</div>
</div>
<p>Below we will demonstrate how to plot the updating function in Python and how to peform this analysis.</p>
<section id="plot-of-the-updating-function" class="level3" data-number="4.0.1">
<h3 data-number="4.0.1" class="anchored" data-anchor-id="plot-of-the-updating-function"><span class="header-section-number">4.0.1</span> plot of the updating function</h3>
<p>Let us consider a linear discrete-time model:</p>
<p><span class="math display">\[
x_{t+1} = 5x_t - 10
\]</span></p>
<p>Instead of iterating this equation starting from a particular initial value to produce a sequence of values, we will plot the function <span class="math inline">\(f(x) = 0.5 x - 10\)</span> and use it to predict how solutions behave starting from <em>any</em> initial value. To do this, we will plot this function over a range of x values, along the the line <span class="math inline">\(y=x\)</span>.</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np <span class="co"># package for work with arrays and matrices</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt <span class="co"># package with plotting capabilities</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">3</span>,<span class="dv">10</span>,<span class="fl">0.1</span>) <span class="co"># range of x values</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>fx <span class="op">=</span> <span class="fl">0.5</span><span class="op">*</span>x <span class="op">+</span> <span class="dv">1</span> <span class="co"># values of the updating function</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>plt.plot(x, fx, label <span class="op">=</span> <span class="st">'updating function'</span>) <span class="co"># plot the updating function</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>plt.plot(x, x, label <span class="op">=</span> <span class="st">'identity line'</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'x'</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'f(x)'</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Graphical analysis of f(x) = 0.5x +1'</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="ch4_cobweb_plots_files/figure-html/cell-3-output-1.png" width="587" height="449"></p>
</div>
</div>
<p>The plot show thats the updating function intersects the identity line at <span class="math inline">\(x=2\)</span>, which is the (only) fixed point of this dynamic model. But it is stable or unstable? And how will solutions behave?</p>
</section>
<section id="cobweb-plot" class="level3" data-number="4.0.2">
<h3 data-number="4.0.2" class="anchored" data-anchor-id="cobweb-plot"><span class="header-section-number">4.0.2</span> cobweb plot</h3>
<p>Let us exploit the idea in the third point for graphical analysis of an iterated map. Starting with some initial condition <span class="math inline">\(x_0\)</span>, the value of <span class="math inline">\(x_1\)</span> is given by <span class="math inline">\(f(x_0)\)</span>. To show this graphically, starting the point <span class="math inline">\(x_0\)</span> on the axis, draw a vertical line to <span class="math inline">\(y=f(x_0)\)</span>. Next, draw a horizontal line to the graph of <span class="math inline">\(y=x\)</span>. Since the <span class="math inline">\(y\)</span> and <span class="math inline">\(x\)</span> coordinates are equal, we now have the value of <span class="math inline">\(x_1 = f(x_0)\)</span> as the x coordinate. Then, repeat the process by drawing a vertical line to <span class="math inline">\(y=f(x_1)\)</span>, and the a horizontal line <span class="math inline">\(y=x\)</span>, etc. The resulting sequence of x coordinates is a quick way of assessing the dynamics of the iterated map. For instance, the values may converge to a fixed point, or grow to infinity, or bounce around without settling down. The resulting graph of alternating vertical and horizontal line segments is called a cobweb plot:</p>
<div class="callout-tip callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Cobweb plot pseudocode
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>define the updating function <span class="math inline">\(f(x)\)</span></li>
<li>plot the graph of <span class="math inline">\(f(x)\)</span></li>
<li>plot the identity line <span class="math inline">\(y=x\)</span></li>
<li>set n to be the number of steps</li>
<li>initialize an array x of length 2*n</li>
<li>initialize an array y of length 2*n</li>
<li>set <span class="math inline">\(x[0]\)</span> to the initial value</li>
<li>set <span class="math inline">\(y[0]\)</span> to 0</li>
<li>for n steps repeat (with i increasing by 2):
<ul>
<li>set <span class="math inline">\(x[i+1] \gets x[i]\)</span></li>
<li>set <span class="math inline">\(y[i+1] \gets f(x[i])\)</span></li>
<li>set <span class="math inline">\(x[i+2] \gets y[i+1]\)</span></li>
<li>set <span class="math inline">\(y[i+2] \gets y[i+1]\)</span></li>
</ul></li>
<li>plot the sequence of points <span class="math inline">\((x,y)\)</span> on the same plot</li>
</ul>
</div>
</div>
<p>Here is an implementation of the cobweb plot for the same linear model as above.</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">3</span>,<span class="dv">5</span>,<span class="fl">0.1</span>) <span class="co"># range of x values</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>fx <span class="op">=</span> <span class="fl">0.5</span><span class="op">*</span>x <span class="op">+</span> <span class="dv">1</span> <span class="co"># values of the updating function</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>plt.plot(x, fx, label <span class="op">=</span> <span class="st">'updating function'</span>) <span class="co"># plot the updating function</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>plt.plot(x, x, label <span class="op">=</span> <span class="st">'identity line'</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># the cobweb plot script</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="dv">5</span> <span class="co"># number of steps</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.zeros(n<span class="op">*</span><span class="dv">2</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.zeros(n<span class="op">*</span><span class="dv">2</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">0</span>] <span class="op">=</span> <span class="op">-</span><span class="dv">3</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.arange(<span class="dv">0</span>,<span class="dv">2</span><span class="op">*</span>n,<span class="dv">2</span>))</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> np.arange(<span class="dv">0</span>,<span class="dv">2</span><span class="op">*</span>(n<span class="op">-</span><span class="dv">1</span>),<span class="dv">2</span>):</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    x[i<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> x[i] <span class="co"># keep the same x coordinate</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    y[i<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> <span class="fl">0.5</span><span class="op">*</span>x[i] <span class="op">+</span> <span class="dv">1</span> <span class="co"># the updating function</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    x[i<span class="op">+</span><span class="dv">2</span>] <span class="op">=</span> y[i<span class="op">+</span><span class="dv">1</span>] <span class="co"># move to the next x value</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    y[i<span class="op">+</span><span class="dv">2</span>] <span class="op">=</span> y[i<span class="op">+</span><span class="dv">1</span>] <span class="co"># keep the same y coordinate</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">2</span><span class="op">*</span>n<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> x[<span class="dv">2</span><span class="op">*</span>n<span class="op">-</span><span class="dv">2</span>] <span class="co"># finish the last half-iteration</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>y[<span class="dv">2</span><span class="op">*</span>n<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> <span class="fl">0.5</span><span class="op">*</span>x[<span class="dv">2</span><span class="op">*</span>n<span class="op">-</span><span class="dv">2</span>] <span class="op">+</span> <span class="dv">1</span> <span class="co"># finish the last half-iteration</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>plt.plot(x,y, label <span class="op">=</span> <span class="st">'numeric solution'</span>)    </span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'x'</span>)</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'f(x)'</span>)</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Graphical analysis of f(x) = 0.5x + 1'</span>)</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[-3.  0.  0.  0.  0.  0.  0.  0.  0.  0.]
[0 2 4 6 8]</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="ch4_cobweb_plots_files/figure-html/cell-4-output-2.png" width="587" height="449"></p>
</div>
</div>
<p>You can see that the solution, shown in green, start from initial value of -3 and steps upward toward the fixed point at 2. You can experiment by trying a different initial value, say 10 (you will have to change the domain of the plotted function) but you should still observe convergence to the fixed point at 2.</p>
<p>This could be predicted from the analysis performed in the previous section: the slope of the updating function is 0.5 (everywhere, since it’s a straight line) and since that is less than 1 in absolute value, the fixed point is stable, and solutions are expected to converge to it.</p>
<p>We now have at our disposal analytical, numerical, and graphical tools to analyze and predict the behavior of a dynamical system. In the next section we will use all three to analyze a more complex model of population growth.</p>
</section>
<section id="graphical-analysis-of-the-logistic-model" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="graphical-analysis-of-the-logistic-model"><span class="header-section-number">4.1</span> Graphical analysis of the logistic model</h2>
<p>As we saw, we can learn a lot about the behavior of a dynamical system from analyzing the graph of the defining function. Let us consider two quadratic functions for the logistic model: <span class="math inline">\(f(N) = 2N(1-N/2)\)</span> and <span class="math inline">\(f(N) = 4N(1-N/4)\)</span> .</p>
<p>First, plotting the graphs of <span class="math inline">\(y=f(N)\)</span> and <span class="math inline">\(y=N\)</span>, allows us to find the fixed points of the logistic model. Since it is a , we see that there are fixed points at <span class="math inline">\(N = 0\)</span> for both functions, and carrying capacity sizes at <span class="math inline">\(N=2\)</span> and <span class="math inline">\(N=3\)</span>, respectively. The reader should check that this is in agreement with the analytic prediction of <span class="math inline">\(N^* = (r-1)/r\)</span>.</p>
<p>Second, we can obtain information about stability of the two fixed points by considering the slope of the curve <span class="math inline">\(y=f(N)\)</span> at the points where it crosses <span class="math inline">\(y=N\)</span>. On the graph of the first function, the slope is clearly 0, which indicates that the fixed point is stable, in agreement with the analytical prediction. On the graph of the second function, the slope is negative and steeper than -1. This indicates that the fixed point is unstable, again consistent with our analysis above.</p>
<p>Third, we graph a few iterations of the cobweb plot to obtain an idea about the dynamics of the population over time. As expected, for the first function with <span class="math inline">\(r=2\)</span>, the solution quickly approaches the carrying capacity ({numref. In the second function, however, <span class="math inline">\(r = 4\)</span> and the carrying capacity is unstable. In {numref}<code>fig-cobweb2</code> we observe a wild pattern of jumps that never approach any particular value.</p>
<table class="table">
<thead>
<tr class="header">
<th>```{figure} images/ch1_cobweb_1.png</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>name: fig-cobweb1</td>
</tr>
</tbody>
</table>
<p>Cobweb plot of the logistic model with <span class="math inline">\(r=2\)</span>, showing a solution converging to the stable fixed point at the intersection of the graphs of the function and the identity line</p>
<pre><code>


```{figure} images/ch1_cobweb_2.png
---
name: fig-cobweb2
---
Cobweb plot of the logistic model with $r=4$, showing a as solution bouncing around the unstable fixed point</code></pre>
<p>We have seen how graphical tools can be used to analyze and predict the behavior of a dynamical system. In the case of the logistic model, we never found the analytic solution, because it frequently does not exist as a formula. Finding the fixed points and analyzing their stability, in conjunction with looking at the behavior of a cobweb plot, allowed us to describe the dynamics of population growth in the logistic model, without doing any “mathematics”. Together, the analytical and graphical analysis provide complementary tools for biological modelers.</p>
<section id="chaos-in-discrete-dynamical-systems" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="chaos-in-discrete-dynamical-systems"><span class="header-section-number">4.1.1</span> chaos in discrete dynamical systems</h3>
<p>In this chapter we learned to analyze the dynamics of solutions of nonlinear discrete-time dynamical systems without solving them on paper. In the last two sections we focused on the logistic difference equation as a simple nonlinear model with a rich array of dynamic behaviors. In this section we will summarize the analysis and draw conclusions for difference equation models in biology. This behavior was brought to the attention of biologists by John Maynard Smith <span class="citation" data-cites="smith_mathematical_1968">(<a href="#ref-smith_mathematical_1968" role="doc-biblioref"><strong>smith_mathematical_1968?</strong></a>)</span> and Robert May <span class="citation" data-cites="may_bifurcations_1976">(<a href="#ref-may_bifurcations_1976" role="doc-biblioref"><strong>may_bifurcations_1976?</strong></a>)</span>.</p>
<p>Why does the logistic model behave so strangely in the second example above? We can use numerical simulations to plot the long-term solutions for the dependent variable for a range of parameter values, let us say between <span class="math inline">\(2.5 &lt; r &lt; 4\)</span>. Then we plot the values to which the simulation converged (whether it is one, two, or many) on the y-axis, and the value of the parameter <span class="math inline">\(r\)</span> on the x-axis. The resulting <em>bifurcation diagram</em> in shown in {numref}<code>fig-log-bifur</code>. The value of the parameter <span class="math inline">\(r\)</span> is plotted on the horizontal axis, and the set of values that the dependent variable takes in the long run is shown on the vertical axis. There is only one stable fixed point for <span class="math inline">\(r&lt;3\)</span>, then we see a 2-cycle appear for <span class="math inline">\(3&lt;r&lt;3.45\)</span>. For values of <span class="math inline">\(r\)</span> greater than about 3.45, a series of period-doubling bifurcations occur with shorter and shorter intervals of <span class="math inline">\(r\)</span>. This is called a <em>period-doubling cascade</em>, which culminates at the value of <span class="math inline">\(r \approx 3.57\)</span>, where the number of points in the cycle becomes essentially infinite. The sequence of values of <span class="math inline">\(r\)</span> at which period-doubling occurs is approximately:</p>
<ul>
<li><p>period 2; <span class="math inline">\(r_1 = 3\)</span></p></li>
<li><p>period 4; <span class="math inline">\(r_2 \approx 3.449\)</span></p></li>
<li><p>period 8; <span class="math inline">\(r_3 \approx 3.544\)</span></p></li>
<li><p>period 16; <span class="math inline">\(r_4 \approx 3.564\)</span></p></li>
<li><p>period 32; <span class="math inline">\(r_5 \approx 3.569\)</span></p></li>
<li><p>period <span class="math inline">\(\infty\)</span> (chaos); <span class="math inline">\(r_\infty \approx 3.570\)</span></p></li>
</ul>
<table class="table">
<thead>
<tr class="header">
<th>```{figure} images/logistic_bifurc.png</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>name: fig-log-bifur</td>
</tr>
</tbody>
</table>
<p>Bifurcation diagram for the logistic map <span class="math inline">\(N(t+1) = r(1 - N(t)) N(t)\)</span>, with the parameter <span class="math inline">\(r\)</span> on the horizontal axis and the vertical axis showing the values of the stable fixed point (for <span class="math inline">\(r&lt;3\)</span>), then the values of the period two oscillation, the period four oscillation, etc., and for <span class="math inline">\(r\)</span> greater than the critical value shows some of the values the solution chaotically jumps through.</p>
<pre><code>

For $r &gt; r_\infty$, we observe a remarkable behavior found only in nonlinear dynamical systems, called *chaos*. Chaos is characterized by two qualities:

:::{.callout-note icon=false} 

## Characteristics of chaos

1.  **Aperiodic behavior**: the dependent variable never repeats a value exactly, instead bouncing around an infinite set of values for all time

2.  **Sensitive dependence on initial conditions**: no matter how close two initial conditions in a chaotic system, given enough time the two trajectories will diverge and lose any resemblance
:::

What is especially surprising about chaos is that for a given initial condition a chaotic model gives a completely predictable and reproducible sequence of values of the dependent variable. However, given finite machine precision, or any error in initial conditions, a chaotic system is practically unpredictable and irreproducible. But there is a fundamental difference between deterministic chaos and a stochastic system, e.g. the model of coin tosses where knowing the previous result of the coin flip does not allow us to predict the next result, even under ideal conditions.

Notice in figure , that for $r &gt; r_\infty$, chaotic behavior is observed only for some values of $r$. As you can see in figure , there are “bands of periodicity”, where the attractor is a  sequence of $n$ numbers (and periods of 3,5, etc. are observed), alternating with bands of chaos. This illustrates that even the simplest nonlinear discrete dynamical systems can have incredibly complex behavior. When these results were first published by May in the 1970s, they revolutionized both the mathematical understanding of dynamical systems, and the field of theoretical biology. In one-variable dynamic systens, chaos occurs only in discrete-time dynamical models, but for three or more variables continuous time (ODE) dynamical systems also can behavechaotically.

As a mathematical side-note, if one looks at the differences between successive values of $r_n$, they behave like a geometric sequence, getting smaller and smaller by a constant fraction:




$$
\delta_n = \frac{r_{n}-r_{n-1}}{r_{n+1}-r_{n}}
$$




It is a remarkable fact that $\delta_n$ approaches a constant value when $n$ gets large, $4.6692...$, known as the Feigenbaum constant. It can be proven that this constant is the same for other iterated maps with the same shape as the downward parabola of the logistic map (e.g. $f(x) = \sin(x)$). Explaining why this deep mathematical fact is true is far outside the bounds of this course. [@strogatz_nonlinear_2001]

Chaos was a popular topic back in the 1980s and 90s, and even inspired popular books [@gleick_chaos:_1988]. It is in fact remarkable that very simple difference equations can have solutions of apparently great complexity. This is intriguing because it appeals to a fairly universal human desire for simple explanations for complicated phenomena. The popular exposure to what was dubbed “chaos theory” (which is not an actual mathematical topic) spawned some inaccurate cliches, such as “a butterfly flapping its wings in South America can cause a hurricane to form and hit Florida”. The image refers to the phenomenon of sensitive dependence on initial conditions, but of course it is utterly ridiculous to draw a causal arrow between a butterfly (one of an enumerable number of things changing the “initial conditions”) and large-scale atmospheric phenomena. While there is some evidence that weather patters are complex systems that exhibit chaotic behavior, we lack the ability to isolate and control all influences that may perturb it, so pinning it on a butterfly is pretty unfair.

Despite the initial flurry of excitement, so-called chaos theory has failed to make a big impact on our understanding of complex biological systems. Although it is still quite fascinating intellectually, a simple model like the logistic model is not an adequate model for any realistic population, particularly for large values of $r$ where the chaotic behavior occurs. We now appreciate that the essential complexity of biological system requires multiple interacting variables which cannot be reduced to a single equation. However, there has been some successful observation of chaotic behavior in a population of flour beetles, which seemed to agree with predictions of a three-variable difference equation model [@costantino_chaotic_1997].

We have seen how graphical tools can be used to analyze and predict the behavior of a discrete-time dynamical system. We investigated the logistic model by finding the fixed points and analyzing their stability. Together with analysis of the graph of the updating function and making a cobweb plot, this allowed us to describe the dynamics of population growth in the logistic model, without doing any “math”. Together, analytical and graphical analysis provide powerful tools for biological modelers.

**Q3.1:** For the logistic model with an initial population of 0.5 and $r=1.1$, 
compute the first 50 iterations using the same for loop iteration
you used above and plot the solution against time. 

::: {.cell execution_count=4}
``` {.python .cell-code}
numsteps = 50 #set number of iterations
r = 1.8 #set parameter
N = np.zeros(numsteps+1) #initialize solution vector
N[0]=.5 #initial value
t = range(numsteps+1) #initialze time vector
a = -10
for i in range(numsteps):
    N[i+1] = r*N[i]*(1-N[i]) #logistic population model
plt.plot(t,N) #plot solution
plt.xlabel('time')
plt.ylabel('population')
plt.title('Solution of logistic model wtih r='+str(r))
plt.show()
</code></pre>
<div class="cell-output cell-output-display">
<p><img src="ch4_cobweb_plots_files/figure-html/cell-5-output-1.png" width="597" height="449"></p>
</div>
<p>:::</p>
<p><strong>Q3.2:</strong> Change the parameter <span class="math inline">\(r\)</span> to the following values: 0.5, 2.0, and 3.2, and in each case plot the solutions against time in separate figures. Describe each plot with a sentence.</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>numsteps <span class="op">=</span> <span class="dv">50</span> <span class="co">#set number of iterations</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> <span class="fl">.5</span> <span class="co">#set parameter</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> np.zeros(numsteps<span class="op">+</span><span class="dv">1</span>) <span class="co">#initialize solution vector</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>N[<span class="dv">0</span>]<span class="op">=</span><span class="fl">.5</span> <span class="co">#initial value</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> <span class="bu">range</span>(numsteps<span class="op">+</span><span class="dv">1</span>) <span class="co">#initialze time vector</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="op">-</span><span class="dv">10</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(numsteps):</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    N[i<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> r<span class="op">*</span>N[i]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>N[i]) <span class="co">#linear population model</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>plt.plot(t,N, label <span class="op">=</span> <span class="st">'r='</span><span class="op">+</span><span class="bu">str</span>(r)) <span class="co">#plot solution</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> <span class="fl">2.0</span> <span class="co">#set parameter</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> np.zeros(numsteps<span class="op">+</span><span class="dv">1</span>) <span class="co">#initialize solution vector</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>N[<span class="dv">0</span>]<span class="op">=</span><span class="fl">0.75</span> <span class="co">#initial value</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> <span class="bu">range</span>(numsteps<span class="op">+</span><span class="dv">1</span>) <span class="co">#initialze time vector</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="op">-</span><span class="dv">10</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(numsteps):</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    N[i<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> r<span class="op">*</span>N[i]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>N[i]) <span class="co">#linear population model</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>plt.plot(t,N, label <span class="op">=</span> <span class="st">'r='</span><span class="op">+</span><span class="bu">str</span>(r)) <span class="co">#plot solution</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> <span class="fl">3.2</span> <span class="co">#set parameter</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> np.zeros(numsteps<span class="op">+</span><span class="dv">1</span>) <span class="co">#initialize solution vector</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>N[<span class="dv">0</span>]<span class="op">=</span><span class="fl">.5</span> <span class="co">#initial value</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> <span class="bu">range</span>(numsteps<span class="op">+</span><span class="dv">1</span>) <span class="co">#initialze time vector</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="op">-</span><span class="dv">10</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(numsteps):</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>    N[i<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> r<span class="op">*</span>N[i]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>N[i]) <span class="co">#linear population model</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(N)</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>plt.plot(t,N, label <span class="op">=</span> <span class="st">'r='</span><span class="op">+</span><span class="bu">str</span>(r)) <span class="co">#plot solution</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'time'</span>)</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'population'</span>)</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Solutions of logistic model with different parameters'</span>)</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[0.5        0.8        0.512      0.7995392  0.51288406 0.7994688
 0.51301899 0.79945762 0.51304043 0.79945583 0.51304386 0.79945554
 0.51304441 0.7994555  0.51304449 0.79945549 0.51304451 0.79945549
 0.51304451 0.79945549 0.51304451 0.79945549 0.51304451 0.79945549
 0.51304451 0.79945549 0.51304451 0.79945549 0.51304451 0.79945549
 0.51304451 0.79945549 0.51304451 0.79945549 0.51304451 0.79945549
 0.51304451 0.79945549 0.51304451 0.79945549 0.51304451 0.79945549
 0.51304451 0.79945549 0.51304451 0.79945549 0.51304451 0.79945549
 0.51304451 0.79945549 0.51304451]</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="ch4_cobweb_plots_files/figure-html/cell-6-output-2.png" width="589" height="449"></p>
</div>
</div>
<ul>
<li>The solution for r=0.5 decreases to zero</li>
<li>The solution for r=2.0 stays at the fixed point of 0.5</li>
<li>The solution for r=3.2 oscillates between two values indefinitely</li>
</ul>
<p>Increase the parameter <span class="math inline">\(r\)</span> further until you see strange, aperiodic behavior called chaos. Report at least one value of <span class="math inline">\(r\)</span> at which you see chaotic dynamics.</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>numsteps <span class="op">=</span> <span class="dv">100</span> <span class="co">#set number of iterations</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> <span class="fl">3.7</span> <span class="co">#set parameter</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> np.zeros(numsteps<span class="op">+</span><span class="dv">1</span>) <span class="co">#initialize solution vector</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>N[<span class="dv">0</span>]<span class="op">=</span><span class="fl">.7</span> <span class="co">#initial value</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> <span class="bu">range</span>(numsteps<span class="op">+</span><span class="dv">1</span>) <span class="co">#initialze time vector</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="op">-</span><span class="dv">10</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(numsteps):</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    N[i<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> r<span class="op">*</span>N[i]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>N[i]) <span class="co">#linear population model</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>plt.plot(t, N, label <span class="op">=</span> <span class="st">'N0 ='</span> <span class="op">+</span> <span class="bu">str</span>(N[<span class="dv">0</span>]))</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>numsteps <span class="op">=</span> <span class="dv">100</span> <span class="co">#set number of iterations</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> <span class="fl">3.7</span> <span class="co">#set parameter</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> np.zeros(numsteps<span class="op">+</span><span class="dv">1</span>) <span class="co">#initialize solution vector</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>N[<span class="dv">0</span>]<span class="op">=</span><span class="fl">.701</span> <span class="co">#initial value</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> <span class="bu">range</span>(numsteps<span class="op">+</span><span class="dv">1</span>) <span class="co">#initialze time vector</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="op">-</span><span class="dv">10</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(numsteps):</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    N[i<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> r<span class="op">*</span>N[i]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>N[i]) <span class="co">#linear population model</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>plt.plot(t,N, label <span class="op">=</span> <span class="st">'N0 ='</span> <span class="op">+</span> <span class="bu">str</span>(N[<span class="dv">0</span>])) <span class="co">#plot solution</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'time'</span>)</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'population'</span>)</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Logistic model, r='</span><span class="op">+</span><span class="bu">str</span>(r))</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="ch4_cobweb_plots_files/figure-html/cell-7-output-1.png" width="589" height="449"></p>
</div>
</div>
<p>At <span class="math inline">\(r=3.7\)</span> the solution bounces around without any apparent pattern, which is called chaos.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./ch3_discrete_chaos.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Nonlinear discrete-time dynamic models</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./ch5_discrete_higher.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Discrete models of higher order</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>