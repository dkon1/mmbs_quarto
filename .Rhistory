#| eval: false
def lin_reg(xdata, ydata):
if (xdata.shape == ydata.shape):
A = np.column_stack((xdata, np.ones(len(xdata))))
params = np.linalg.solve(A.T@A, A.T@ydata)
return params
else:
print("x and y vector must be the same shape!")
x = np.array([0,2,4])
y = np.array([3,7,8])
a, b = lin_reg(x, y) # SWITCHED INPUT VARIABLES
ypred = a*Ñ… + b # USE X ON THE RIGHT HAND SIDE
r2 = ypred**2/y**2
print("R-squared", r2)
resid = ypred - y
plt.scatter(x, resid)
plt.xlabel('x')
plt.ylabel('residuals')
plt.show()
reticulate::repl_python()
reticulate::repl_python()
